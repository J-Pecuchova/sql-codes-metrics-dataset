ID;TG;Student;Model;Variant;X;AXC;lines_of_code;character_length;token_count;n1_distinct_operators;n2_distinct_operands;N1_total_operators;N2_total_operands;vocabulary;program_length;volume;difficulty;effort;time_to_program;subquery_count;window_function_count;aggregate_function_count;cte_count;max_nesting_depth;cognitive_complexity;sqlshare_complexity;weighted_complexity;ast_node_count;ast_height;ast_branching_factor;leaf_node_ratio
1;A;-1;ChatGPT5.2;0;1;"CREATE OR REPLACE TABLE retail (
    invoice_no   INTEGER,
    stock_code   STRING,
    description  STRING,
    quantity     INTEGER,
    invoice_date TIMESTAMP,
    unit_price   NUMBER(10,2),
    customer_id  INTEGER,
    country      STRING
);

CREATE OR REPLACE FILE FORMAT retail_csv_ff
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO retail
FROM @~/online_retail.csv
FILE_FORMAT = retail_csv_ff
ON_ERROR = CONTINUE;";22;512;78;12;36;34;44;48;78;435,63;7,33;3194,6;177,48;0;0;0;0;2;2;12,17;1,0;32;6;2,21;0,56
2;A;-1;ChatGPT5.2;1;1;"CREATE OR REPLACE TABLE retail (
    invoice_no   INTEGER,
    stock_code   STRING,
    description  STRING,
    quantity     INTEGER,
    invoice_date TIMESTAMP,
    unit_price   NUMBER(10, 2),
    customer_id  INTEGER,
    country      STRING
);

CREATE OR REPLACE FILE FORMAT retail_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO retail
FROM @~/online_retail.csv
FILE_FORMAT = retail_csv_format
ON_ERROR = CONTINUE;";22;521;78;12;36;34;44;48;78;435,63;7,33;3194,6;177,48;0;0;0;0;2;2;12,19;1,0;32;6;2,21;0,56
3;A;-1;ChatGPT5.2;2;1;"CREATE OR REPLACE TABLE retail (
    invoice_no   INTEGER,
    stock_code   STRING,
    description  STRING,
    quantity     INTEGER,
    invoice_date TIMESTAMP,
    unit_price   NUMBER(10, 2),
    customer_id  INTEGER,
    country      STRING
);

CREATE OR REPLACE FILE FORMAT retail_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO retail
FROM @~/online_retail.csv
FILE_FORMAT = retail_csv_format
ON_ERROR = CONTINUE;";22;521;78;12;36;34;44;48;78;435,63;7,33;3194,6;177,48;0;0;0;0;2;2;12,19;1,0;32;6;2,21;0,56
4;A;-1;ChatGPT5.2;3;1;"CREATE OR REPLACE TABLE retail (
  invoice_no INTEGER, stock_code STRING, description STRING, quantity INTEGER,
  invoice_date TIMESTAMP, unit_price NUMBER(10,2), customer_id INTEGER, country STRING
);
CREATE OR REPLACE FILE FORMAT ff_retail TYPE=CSV FIELD_DELIMITER=';' SKIP_HEADER=1 FIELD_OPTIONALLY_ENCLOSED_BY='""' NULL_IF=('', 'NULL');
COPY INTO retail FROM @~/online_retail.csv FILE_FORMAT=ff_retail ON_ERROR=CONTINUE;";6;423;78;12;36;34;44;48;78;435,63;7,33;3194,6;177,48;0;0;0;0;2;2;12,0;1,0;32;6;2,21;0,56
5;B;-1;ChatGPT5.2;0;1;"CREATE OR REPLACE TABLE games (
    id            INTEGER,
    name          STRING,
    platform      STRING,
    year          INTEGER,
    genre         STRING,
    publisher     STRING,
    na_sales      NUMBER(10,2),
    eu_sales      NUMBER(10,2),
    jp_sales      NUMBER(10,2),
    other_sales   NUMBER(10,2),
    global_sales  NUMBER(10,2)
);

CREATE OR REPLACE FILE FORMAT games_csv_ff
    TYPE = CSV
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO games
FROM @~/video_game_sales.csv
FILE_FORMAT = games_csv_ff
ON_ERROR = CONTINUE;";25;617;107;12;38;49;58;50;107;603,89;9,16;5530,38;307,24;0;0;0;0;2;2;15,86;1,0;57;6;1,93;0,49
6;B;-1;ChatGPT5.2;1;1;"CREATE OR REPLACE TABLE games (
    id            INTEGER,
    name          STRING,
    platform      STRING,
    year          INTEGER,
    genre         STRING,
    publisher     STRING,
    na_sales      NUMBER(10,2),
    eu_sales      NUMBER(10,2),
    jp_sales      NUMBER(10,2),
    other_sales   NUMBER(10,2),
    global_sales  NUMBER(10,2)
);

CREATE OR REPLACE FILE FORMAT games_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO games
FROM @~/video_game_sales.csv
FILE_FORMAT = games_csv_format
ON_ERROR = CONTINUE;";25;625;107;12;38;49;58;50;107;603,89;9,16;5530,38;307,24;0;0;0;0;2;2;15,88;1,0;57;6;1,93;0,49
7;B;-1;ChatGPT5.2;2;1;"CREATE OR REPLACE TABLE games (
    id           INTEGER,
    name         STRING,
    platform     STRING,
    year         INTEGER,
    genre        STRING,
    publisher    STRING,
    na_sales     NUMBER(10,2),
    eu_sales     NUMBER(10,2),
    jp_sales     NUMBER(10,2),
    other_sales  NUMBER(10,2),
    global_sales NUMBER(10,2)
);

CREATE OR REPLACE FILE FORMAT games_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO games
FROM @~/video_game_sales.csv
FILE_FORMAT = games_csv_format
ON_ERROR = CONTINUE;";25;614;107;12;38;49;58;50;107;603,89;9,16;5530,38;307,24;0;0;0;0;2;2;15,86;1,0;57;6;1,93;0,49
8;B;-1;ChatGPT5.2;3;1;"CREATE OR REPLACE TABLE games (
  id INTEGER, name STRING, platform STRING, year INTEGER, genre STRING, publisher STRING,
  na_sales NUMBER(10,2), eu_sales NUMBER(10,2), jp_sales NUMBER(10,2),
  other_sales NUMBER(10,2), global_sales NUMBER(10,2)
);
CREATE OR REPLACE FILE FORMAT ff_games TYPE=CSV FIELD_DELIMITER=',' SKIP_HEADER=1 FIELD_OPTIONALLY_ENCLOSED_BY='""' NULL_IF=('', 'NULL');
COPY INTO games FROM @~/video_game_sales.csv FILE_FORMAT=ff_games ON_ERROR=CONTINUE;";7;471;107;12;38;49;58;50;107;603,89;9,16;5530,38;307,24;0;0;0;0;2;2;15,57;1,0;57;6;1,93;0,49
9;C;-1;ChatGPT5.2;0;1;"CREATE OR REPLACE TABLE eshop (
    year            INTEGER,
    month           INTEGER,
    day             INTEGER,
    order_no        INTEGER,
    country         STRING,
    session_id      INTEGER,
    category        STRING,
    clothing_model  STRING,
    colour          STRING,
    location        STRING,
    model           INTEGER,
    price           INTEGER,
    page            STRING
);

CREATE OR REPLACE FILE FORMAT eshop_csv_ff
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO eshop
FROM @~/eshop_clothing.csv
FILE_FORMAT = eshop_csv_ff
ON_ERROR = CONTINUE;";27;668;88;12;37;36;52;49;88;494,09;8,43;4166,42;231,47;0;0;0;0;1;2;13,69;1,0;43;4;2,62;0,63
10;C;-1;ChatGPT5.2;1;1;"CREATE OR REPLACE TABLE eshop (
    year            INTEGER,
    month           INTEGER,
    day             INTEGER,
    order_no        INTEGER,
    country         STRING,
    session_id      INTEGER,
    category        STRING,
    clothing_model  STRING,
    colour          STRING,
    location        STRING,
    model           INTEGER,
    price           INTEGER,
    page            STRING
);

CREATE OR REPLACE FILE FORMAT eshop_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO eshop
FROM @~/eshop_clothing.csv
FILE_FORMAT = eshop_csv_format
ON_ERROR = CONTINUE;";27;676;88;12;37;36;52;49;88;494,09;8,43;4166,42;231,47;0;0;0;0;1;2;13,7;1,0;43;4;2,62;0,63
11;C;-1;ChatGPT5.2;2;1;"CREATE OR REPLACE TABLE eshop (
    year           INTEGER,
    month          INTEGER,
    day            INTEGER,
    order_no       INTEGER,
    country        STRING,
    session_id     INTEGER,
    category       STRING,
    clothing_model STRING,
    colour         STRING,
    location       STRING,
    model          INTEGER,
    price          INTEGER,
    page           STRING
);

CREATE OR REPLACE FILE FORMAT eshop_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO eshop
FROM @~/eshop_clothing.csv
FILE_FORMAT = eshop_csv_format
ON_ERROR = CONTINUE;";27;663;88;12;37;36;52;49;88;494,09;8,43;4166,42;231,47;0;0;0;0;1;2;13,68;1,0;43;4;2,62;0,63
12;C;-1;ChatGPT5.2;3;1;"CREATE OR REPLACE TABLE eshop (
  year INTEGER, month INTEGER, day INTEGER, order_no INTEGER, country STRING,
  session_id INTEGER, category STRING, clothing_model STRING, colour STRING,
  location STRING, model INTEGER, price INTEGER, page STRING
);
CREATE OR REPLACE FILE FORMAT ff_eshop TYPE=CSV FIELD_DELIMITER=';' SKIP_HEADER=1 FIELD_OPTIONALLY_ENCLOSED_BY='""' NULL_IF=('', 'NULL');
COPY INTO eshop FROM @~/eshop_clothing.csv FILE_FORMAT=ff_eshop ON_ERROR=CONTINUE;";7;470;88;12;37;36;52;49;88;494,09;8,43;4166,42;231,47;0;0;0;0;1;2;13,29;1,0;43;4;2,62;0,63
13;D;-1;ChatGPT5.2;0;1;"CREATE OR REPLACE TABLE sales (
    order_id        STRING,
    order_date      DATE,
    status          STRING,
    fulfilment      STRING,
    ship_service    STRING,
    product         STRING,
    category        STRING,
    size            STRING,
    courier_status  STRING,
    quantity        INTEGER,
    amount          NUMBER(10,2),
    ship_state      STRING
);

CREATE OR REPLACE FILE FORMAT sales_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO sales
FROM @~/amazon_report.csv
FILE_FORMAT = sales_csv_format
ON_ERROR = CONTINUE;";26;645;90;12;40;38;52;52;90;513,04;7,8;4001,71;222,32;0;0;0;0;2;2;13,88;1,0;44;6;2,39;0,59
14;D;-1;ChatGPT5.2;1;1;"CREATE OR REPLACE TABLE sales (
    order_id       STRING,
    order_date     DATE,
    status         STRING,
    fulfilment     STRING,
    ship_service   STRING,
    product        STRING,
    category       STRING,
    size           STRING,
    courier_status STRING,
    quantity       INTEGER,
    amount         NUMBER(10,2),
    ship_state     STRING
);

CREATE OR REPLACE FILE FORMAT sales_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO sales
FROM @~/amazon_report.csv
FILE_FORMAT = sales_csv_format
ON_ERROR = CONTINUE;";26;633;90;12;40;38;52;52;90;513,04;7,8;4001,71;222,32;0;0;0;0;2;2;13,86;1,0;44;6;2,39;0,59
15;D;-1;ChatGPT5.2;2;1;"CREATE OR REPLACE TABLE sales (
    order_id        STRING,
    order_date      DATE,
    status          STRING,
    fulfilment      STRING,
    ship_service    STRING,
    product         STRING,
    category        STRING,
    size            STRING,
    courier_status  STRING,
    quantity        INTEGER,
    amount          NUMBER(10,2),
    ship_state      STRING
);

CREATE OR REPLACE FILE FORMAT sales_csv_format
    TYPE = CSV
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
    FIELD_OPTIONALLY_ENCLOSED_BY = '""'
    NULL_IF = ('', 'NULL');

COPY INTO sales
FROM @~/amazon_report.csv
FILE_FORMAT = sales_csv_format
ON_ERROR = CONTINUE;";26;645;90;12;40;38;52;52;90;513,04;7,8;4001,71;222,32;0;0;0;0;2;2;13,88;1,0;44;6;2,39;0,59
16;D;-1;ChatGPT5.2;3;1;"CREATE OR REPLACE TABLE sales (
  order_id STRING, order_date DATE, status STRING, fulfilment STRING,
  ship_service STRING, product STRING, category STRING, size STRING,
  courier_status STRING, quantity INTEGER, amount NUMBER(10,2), ship_state STRING
);
CREATE OR REPLACE FILE FORMAT ff_sales TYPE=CSV FIELD_DELIMITER=';' SKIP_HEADER=1 FIELD_OPTIONALLY_ENCLOSED_BY='""' NULL_IF=('', 'NULL');
COPY INTO sales FROM @~/amazon_report.csv FILE_FORMAT=ff_sales ON_ERROR=CONTINUE;";7;474;90;12;40;38;52;52;90;513,04;7,8;4001,71;222,32;0;0;0;0;2;2;13,54;1,0;44;6;2,39;0,59
17;A;-1;ChatGPT5.2;0;2;"SELECT
    customer_id,
    SUM(quantity * unit_price) AS total_turnover_14_days
FROM retail
WHERE customer_id IS NOT NULL
  AND quantity <> 0
  AND invoice_date >= DATEADD(
        DAY,
        -14,
        (SELECT MAX(invoice_date) FROM retail)
      )
GROUP BY customer_id
ORDER BY total_turnover_14_days DESC;";13;313;50;21;11;33;17;32;50;250,0;16,23;4056,82;225,38;1;0;2;0;3;7;10,02;7,0;48;10;1,47;0,33
18;A;-1;ChatGPT5.2;1;2;"WITH max_date AS (
    SELECT MAX(invoice_date) AS max_invoice_date
    FROM retail
)
SELECT
    r.customer_id,
    SUM(r.quantity * r.unit_price) AS total_turnover_last_14_days
FROM retail r
CROSS JOIN max_date
WHERE r.customer_id IS NOT NULL
  AND r.quantity <> 0
  AND r.invoice_date >= DATEADD(DAY, -14, max_invoice_date)
GROUP BY r.customer_id
ORDER BY total_turnover_last_14_days DESC;";14;391;74;23;16;43;31;39;74;391,12;22,28;8714,64;484,15;1;0;2;1;2;5;13,41;9,0;67;8;1,69;0,42
19;A;-1;ChatGPT5.2;2;2;"WITH max_invoice_date AS (
    SELECT MAX(invoice_date) AS max_date
    FROM retail
),
recent_transactions AS (
    SELECT
        customer_id,
        quantity * unit_price AS amount
    FROM retail
    CROSS JOIN max_invoice_date
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
      AND invoice_date >= DATEADD(DAY, -14, max_date)
)
SELECT
    customer_id,
    SUM(amount) AS total_turnover_last_14_days
FROM recent_transactions
GROUP BY customer_id
ORDER BY total_turnover_last_14_days DESC;";20;505;72;22;17;44;28;39;72;380,55;18,12;6894,65;383,04;2;0;2;1;2;8;13,72;12,0;71;11;1,52;0,35
20;A;-1;ChatGPT5.2;3;2;"SELECT customer_id, SUM(quantity*unit_price) AS turnover_14d
FROM retail
WHERE customer_id IS NOT NULL AND quantity<>0
  AND invoice_date >= DATEADD(DAY,-14,(SELECT MAX(invoice_date) FROM retail))
GROUP BY customer_id
ORDER BY turnover_14d DESC;";6;245;50;21;11;33;17;32;50;250,0;16,23;4056,82;225,38;1;0;2;0;3;7;9,88;7,0;48;10;1,47;0,33
21;B;-1;ChatGPT5.2;0;2;"WITH max_year AS (
    SELECT MAX(year) AS max_year FROM games
)
SELECT
    platform,
    year,
    SUM(global_sales) AS total_global_sales
FROM games, max_year
WHERE year >= max_year - 2
GROUP BY platform, year
ORDER BY platform, year;";11;236;46;15;8;28;18;23;46;208,08;16,88;3511,41;195,08;1;0;2;1;2;3;8,12;9,0;49;8;1,5;0,35
22;B;-1;ChatGPT5.2;1;2;"WITH max_year AS (
    SELECT MAX(year) AS max_year
    FROM games
)
SELECT
    platform,
    year,
    SUM(global_sales) AS total_global_sales
FROM games, max_year
WHERE year >= max_year - 2
GROUP BY platform, year
ORDER BY platform, year;";12;240;46;15;8;28;18;23;46;208,08;16,88;3511,41;195,08;1;0;2;1;2;3;8,13;9,0;49;8;1,5;0,35
23;B;-1;ChatGPT5.2;2;2;"WITH max_year_cte AS (
    SELECT MAX(year) AS max_year
    FROM games
),
filtered_games AS (
    SELECT *
    FROM games, max_year_cte
    WHERE year >= max_year - 2
)
SELECT
    platform,
    year,
    SUM(global_sales) AS total_global_sales
FROM filtered_games
GROUP BY platform, year
ORDER BY platform, year;";16;312;55;16;10;35;20;26;55;258,52;16,0;4136,39;229,8;2;0;2;1;2;6;9,95;12,0;57;9;1,51;0,35
24;B;-1;ChatGPT5.2;3;2;"SELECT platform, year, SUM(global_sales) total_global_sales
FROM games
WHERE year >= (SELECT MAX(year) FROM games) - 2
GROUP BY platform, year
ORDER BY platform, year;";5;167;37;14;6;24;13;20;37;159,91;15,17;2425,32;134,74;1;0;2;0;2;3;6,78;7,0;39;9;1,46;0,33
25;C;-1;ChatGPT5.2;0;2;"WITH daily_sales AS (
    SELECT
        country,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        SUM(price) AS daily_revenue
    FROM eshop
    GROUP BY country, sales_date
)
SELECT
    country,
    sales_date,
    daily_revenue,
    SUM(daily_revenue) OVER (
        PARTITION BY country
        ORDER BY sales_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7_day_revenue
FROM daily_sales
ORDER BY country, sales_date;";19;461;69;19;13;45;24;32;69;345,0;17,54;6050,77;336,15;1;1;2;1;2;6;12,3;11,5;60;8;1,55;0,37
26;C;-1;ChatGPT5.2;1;2;"WITH daily_sales AS (
    SELECT
        country,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        SUM(price) AS daily_revenue
    FROM eshop
    GROUP BY country, sales_date
)
SELECT
    country,
    sales_date,
    daily_revenue,
    SUM(daily_revenue) OVER (
        PARTITION BY country
        ORDER BY sales_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7_day_revenue
FROM daily_sales
ORDER BY country, sales_date;";19;461;69;19;13;45;24;32;69;345,0;17,54;6050,77;336,15;1;1;2;1;2;6;12,3;11,5;60;8;1,55;0,37
27;C;-1;ChatGPT5.2;2;2;"WITH daily_revenue AS (
    SELECT
        country,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        SUM(price) AS daily_price
    FROM eshop
    GROUP BY country, sales_date
)
SELECT
    country,
    sales_date,
    daily_price,
    SUM(daily_price) OVER (
        PARTITION BY country
        ORDER BY sales_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7_day_sum
FROM daily_revenue
ORDER BY country, sales_date;";19;455;69;19;13;45;24;32;69;345,0;17,54;6050,77;336,15;1;1;2;1;2;6;12,29;11,5;60;8;1,55;0,37
28;C;-1;ChatGPT5.2;3;2;"SELECT country, d, daily_price,
       SUM(daily_price) OVER (PARTITION BY country ORDER BY d ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) rolling_7d
FROM (
  SELECT country, DATE_FROM_PARTS(year,month,day) d, SUM(price) daily_price
  FROM eshop GROUP BY country, d
)
ORDER BY country, d;";7;285;62;18;11;41;21;29;62;301,19;17,18;5175,07;287,5;1;1;2;0;2;6;10,91;9,5;55;8;1,54;0,36
29;D;-1;ChatGPT5.2;0;2;"WITH daily_state_sales AS (
    SELECT
        ship_state,
        order_date,
        SUM(amount) AS daily_amount
    FROM sales
    GROUP BY ship_state, order_date
)
SELECT
    ship_state,
    order_date,
    daily_amount,
    SUM(daily_amount) OVER (
        PARTITION BY ship_state
        ORDER BY order_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7_day_amount
FROM daily_state_sales
ORDER BY ship_state, order_date;";19;448;60;19;9;40;20;28;60;288,44;21,11;6089,32;338,3;1;1;2;1;2;6;10,96;11,5;53;8;1,53;0,36
30;D;-1;ChatGPT5.2;1;2;"WITH daily_sales AS (
    SELECT
        ship_state,
        order_date,
        SUM(amount) AS daily_amount
    FROM sales
    GROUP BY ship_state, order_date
)
SELECT
    ship_state,
    order_date,
    daily_amount,
    SUM(daily_amount) OVER (
        PARTITION BY ship_state
        ORDER BY order_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7_day_amount
FROM daily_sales
ORDER BY ship_state, order_date;";19;436;60;19;9;40;20;28;60;288,44;21,11;6089,32;338,3;1;1;2;1;2;6;10,93;11,5;53;8;1,53;0,36
31;D;-1;ChatGPT5.2;2;2;"WITH daily_ship_state_sales AS (
    SELECT
        ship_state,
        order_date,
        SUM(amount) AS daily_amount
    FROM sales
    GROUP BY ship_state, order_date
)
SELECT
    ship_state,
    order_date,
    daily_amount,
    SUM(daily_amount) OVER (
        PARTITION BY ship_state
        ORDER BY order_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7_day_amount
FROM daily_ship_state_sales
ORDER BY ship_state, order_date;";19;458;60;19;9;40;20;28;60;288,44;21,11;6089,32;338,3;1;1;2;1;2;6;10,98;11,5;53;8;1,53;0,36
32;D;-1;ChatGPT5.2;3;2;"SELECT ship_state, order_date, daily_amount,
       SUM(daily_amount) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) rolling_7d
FROM (
  SELECT ship_state, order_date, SUM(amount) daily_amount
  FROM sales GROUP BY ship_state, order_date
)
ORDER BY ship_state, order_date;";7;317;54;18;7;37;17;25;54;250,77;21,86;5481,08;304,5;1;1;2;0;2;6;9,85;9,5;48;8;1,52;0,35
33;A;-1;ChatGPT5.2;0;3;"SELECT
    customer_id,
    invoice_date,
    DATEDIFF(
        DAY,
        invoice_date,
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date
        )
    ) AS days_to_next_order
FROM retail
WHERE customer_id IS NOT NULL
  AND quantity <> 0
QUALIFY days_to_next_order IS NOT NULL
ORDER BY days_to_next_order DESC;";16;368;48;18;10;31;17;28;48;230,75;15,3;3530,52;196,14;0;1;0;0;2;3;9,24;3,5;45;8;1,52;0,36
34;A;-1;ChatGPT5.2;1;3;"SELECT
    customer_id,
    invoice_date,
    DATEDIFF(
        DAY,
        invoice_date,
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date
        )
    ) AS days_to_next_order
FROM retail
WHERE customer_id IS NOT NULL
  AND quantity <> 0
QUALIFY days_to_next_order IS NOT NULL
ORDER BY days_to_next_order DESC;";16;368;48;18;10;31;17;28;48;230,75;15,3;3530,52;196,14;0;1;0;0;2;3;9,24;3,5;45;8;1,52;0,36
35;A;-1;ChatGPT5.2;2;3;"WITH ordered_purchases AS (
    SELECT
        customer_id,
        invoice_date,
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date
        ) AS next_invoice_date
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
)
SELECT
    customer_id,
    invoice_date,
    DATEDIFF(DAY, invoice_date, next_invoice_date) AS days_to_next_order
FROM ordered_purchases
WHERE next_invoice_date IS NOT NULL
ORDER BY days_to_next_order DESC;";19;501;63;18;12;40;23;30;63;309,13;17,25;5332,56;296,25;1;1;0;1;2;6;11,9;8,5;61;10;1,54;0,36
36;A;-1;ChatGPT5.2;3;3;"SELECT customer_id, invoice_date,
       DATEDIFF(DAY, invoice_date,
         LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date)
       ) AS days_to_next_order
FROM retail
WHERE customer_id IS NOT NULL AND quantity<>0
QUALIFY days_to_next_order IS NOT NULL
ORDER BY days_to_next_order DESC;";8;312;48;18;10;31;17;28;48;230,75;15,3;3530,52;196,14;0;1;0;0;2;3;9,12;3,5;45;8;1,52;0,36
37;B;-1;ChatGPT5.2;0;3;"WITH yearly_genre_sales AS (
    SELECT
        genre,
        year,
        SUM(global_sales) AS total_global_sales
    FROM games
    GROUP BY genre, year
)
SELECT
    genre,
    year,
    total_global_sales,
    total_global_sales
      - LAG(total_global_sales) OVER (PARTITION BY genre ORDER BY year)
        AS diff_vs_previous_year
FROM yearly_genre_sales
ORDER BY genre, year;";17;384;55;15;8;35;20;23;55;248,8;18,75;4664,92;259,16;1;1;1;1;2;5;9,61;10,0;54;8;1,51;0,35
38;B;-1;ChatGPT5.2;1;3;"WITH yearly_genre_sales AS (
    SELECT
        genre,
        year,
        SUM(global_sales) AS total_global_sales
    FROM games
    GROUP BY genre, year
)
SELECT
    genre,
    year,
    total_global_sales,
    total_global_sales
      - LAG(total_global_sales)
        OVER (PARTITION BY genre ORDER BY year) AS diff_vs_previous_year
FROM yearly_genre_sales
ORDER BY genre, year;";17;384;55;15;8;35;20;23;55;248,8;18,75;4664,92;259,16;1;1;1;1;2;5;9,61;10,0;54;8;1,51;0,35
39;B;-1;ChatGPT5.2;2;3;"WITH yearly_genre_sales AS (
    SELECT
        genre,
        year,
        SUM(global_sales) AS total_global_sales
    FROM games
    GROUP BY genre, year
)
SELECT
    genre,
    year,
    total_global_sales,
    total_global_sales
      - LAG(total_global_sales)
        OVER (PARTITION BY genre ORDER BY year) AS diff_vs_previous_year
FROM yearly_genre_sales
ORDER BY genre, year;";17;384;55;15;8;35;20;23;55;248,8;18,75;4664,92;259,16;1;1;1;1;2;5;9,61;10,0;54;8;1,51;0,35
40;B;-1;ChatGPT5.2;3;3;"SELECT genre, year, total_global_sales,
       total_global_sales - LAG(total_global_sales) OVER (PARTITION BY genre ORDER BY year) diff_vs_prev_year
FROM (
  SELECT genre, year, SUM(global_sales) total_global_sales
  FROM games
  GROUP BY genre, year
)
ORDER BY genre, year;";8;275;49;14;6;32;17;20;49;211,77;19,83;4200,19;233,34;1;1;1;0;2;5;8,55;8,0;49;8;1,5;0,35
41;C;-1;ChatGPT5.2;0;3;"SELECT
    clothing_model,
    DATE_FROM_PARTS(year, month, day) AS sales_date,
    price,
    price - LAG(price) OVER (
        PARTITION BY clothing_model
        ORDER BY DATE_FROM_PARTS(year, month, day)
    ) AS price_change
FROM eshop
ORDER BY clothing_model, sales_date";10;276;47;12;9;29;18;21;47;206,44;12,0;2477,27;137,63;0;1;0;0;2;2;7,91;3,5;44;9;1,54;0,36
42;C;-1;ChatGPT5.2;1;3;"SELECT
    clothing_model,
    DATE_FROM_PARTS(year, month, day) AS sales_date,
    price,
    price - LAG(price) OVER (
        PARTITION BY clothing_model
        ORDER BY DATE_FROM_PARTS(year, month, day)
    ) AS price_change
FROM eshop
ORDER BY clothing_model, sales_date;";10;277;48;13;9;30;18;22;48;214,05;13,0;2782,69;154,59;0;1;0;0;2;2;8,11;3,5;44;9;1,54;0,36
43;C;-1;ChatGPT5.2;2;3;"WITH model_prices AS (
    SELECT
        clothing_model,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        price
    FROM eshop
)
SELECT
    clothing_model,
    sales_date,
    price,
    price - LAG(price) OVER (
        PARTITION BY clothing_model
        ORDER BY sales_date
    ) AS price_change
FROM model_prices
ORDER BY clothing_model, sales_date;";17;370;54;13;11;33;21;24;54;247,59;12,41;3072,34;170,69;1;1;0;1;2;5;9,26;8,5;53;8;1,53;0,36
44;C;-1;ChatGPT5.2;3;3;"SELECT clothing_model, d, price,
       price - LAG(price) OVER (PARTITION BY clothing_model ORDER BY d) price_change
FROM (
  SELECT clothing_model, DATE_FROM_PARTS(year,month,day) d, price FROM eshop
)
ORDER BY clothing_model, d;";6;231;48;12;9;30;18;21;48;210,83;12,0;2529,97;140,55;1;1;0;0;2;5;8,14;6,5;48;8;1,52;0,35
45;D;-1;ChatGPT5.2;0;3;"SELECT
    ship_state,
    order_id,
    order_date,
    DATEDIFF(
        DAY,
        order_date,
        MAX(order_date) OVER (PARTITION BY ship_state)
    ) AS days_late_vs_latest
FROM sales
ORDER BY days_late_vs_latest DESC;";11;229;33;12;8;21;12;20;33;142,62;9,0;1283,61;71,31;0;1;1;0;2;2;5,74;5,0;26;7;1,56;0,38
46;D;-1;ChatGPT5.2;1;3;"SELECT
    ship_state,
    order_id,
    order_date,
    DATEDIFF(
        DAY,
        order_date,
        MAX(order_date) OVER (PARTITION BY ship_state)
    ) AS days_difference
FROM sales
ORDER BY days_difference DESC;";11;221;33;12;8;21;12;20;33;142,62;9,0;1283,61;71,31;0;1;1;0;2;2;5,72;5,0;26;7;1,56;0,38
47;D;-1;ChatGPT5.2;2;3;"WITH latest_order_per_state AS (
    SELECT
        ship_state,
        MAX(order_date) AS latest_order_date
    FROM sales
    GROUP BY ship_state
)
SELECT
    s.ship_state,
    s.order_id,
    s.order_date,
    DATEDIFF(
        DAY,
        s.order_date,
        l.latest_order_date
    ) AS days_difference
FROM sales s
JOIN latest_order_per_state l
  ON s.ship_state = l.ship_state
ORDER BY days_difference DESC;";20;417;65;15;13;35;30;28;65;312,48;17,31;5408,27;300,46;1;0;1;1;2;3;10,74;7,5;59;8;1,81;0,46
48;D;-1;ChatGPT5.2;3;3;"SELECT ship_state, order_id, order_date,
       DATEDIFF(DAY, order_date, MAX(order_date) OVER (PARTITION BY ship_state)) days_diff
FROM sales
ORDER BY days_diff DESC;";4;167;32;11;8;20;12;19;32;135,93;8,25;1121,45;62,3;0;1;1;0;2;2;5,41;5,0;26;7;1,56;0,38
49;A;-1;ChatGPT5.2;0;4;"SELECT
    customer_id,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS turnover_quartile
FROM (
    SELECT
        customer_id,
        SUM(quantity * unit_price) AS total_amount
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
    GROUP BY customer_id
)
ORDER BY total_amount DESC;";14;328;51;20;9;34;17;29;51;247,76;18,89;4679,86;259,99;1;1;1;0;2;6;9,65;8,0;48;10;1,47;0,33
50;A;-1;ChatGPT5.2;1;4;"WITH customer_turnover AS (
    SELECT
        customer_id,
        SUM(quantity * unit_price) AS total_amount
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS turnover_quartile
FROM customer_turnover
ORDER BY total_amount DESC;";15;372;55;20;11;35;20;31;55;272,48;18,18;4954,2;275,23;1;1;1;1;2;6;10,17;10,0;53;10;1,49;0,34
51;A;-1;ChatGPT5.2;2;4;"WITH customer_turnover AS (
    SELECT
        customer_id,
        SUM(quantity * unit_price) AS total_amount
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS turnover_quartile
FROM customer_turnover
ORDER BY total_amount DESC;";15;372;55;20;11;35;20;31;55;272,48;18,18;4954,2;275,23;1;1;1;1;2;6;10,17;10,0;53;10;1,49;0,34
52;A;-1;ChatGPT5.2;3;4;"SELECT customer_id, total_amount,
       NTILE(4) OVER (ORDER BY total_amount DESC) AS quartile
FROM (
  SELECT customer_id, SUM(quantity*unit_price) AS total_amount
  FROM retail
  WHERE customer_id IS NOT NULL AND quantity<>0
  GROUP BY customer_id
)
ORDER BY total_amount DESC;";9;280;51;20;9;34;17;29;51;247,76;18,89;4679,86;259,99;1;1;1;0;2;6;9,55;8,0;48;10;1,47;0,33
53;B;-1;ChatGPT5.2;0;4;"SELECT
    year,
    name,
    global_sales,
    NTILE(4) OVER (
        PARTITION BY year
        ORDER BY global_sales DESC
    ) AS sales_quartile
FROM games
WHERE year IS NOT NULL
ORDER BY year DESC, sales_quartile;";11;219;37;16;7;24;13;23;37;167,37;14,86;2486,67;138,15;0;1;0;0;1;2;6,47;3,5;34;7;1,5;0,35
54;B;-1;ChatGPT5.2;1;4;"SELECT
    year,
    name,
    global_sales,
    NTILE(4) OVER (
        PARTITION BY year
        ORDER BY global_sales DESC
    ) AS sales_quartile
FROM games
WHERE year IS NOT NULL
ORDER BY year DESC, sales_quartile;";11;219;37;16;7;24;13;23;37;167,37;14,86;2486,67;138,15;0;1;0;0;1;2;6,47;3,5;34;7;1,5;0,35
55;B;-1;ChatGPT5.2;2;4;"WITH games_with_quartiles AS (
    SELECT
        year,
        name,
        global_sales,
        NTILE(4) OVER (
            PARTITION BY year
            ORDER BY global_sales DESC
        ) AS sales_quartile
    FROM games
    WHERE year IS NOT NULL
)
SELECT
    year,
    name,
    global_sales,
    sales_quartile
FROM games_with_quartiles
ORDER BY year DESC, sales_quartile;";19;382;52;16;9;32;20;25;52;241,48;17,78;4292,99;238,5;1;1;0;1;2;5;9,07;8,5;50;10;1,53;0,36
56;B;-1;ChatGPT5.2;3;4;"SELECT year, name, global_sales,
       NTILE(4) OVER (PARTITION BY year ORDER BY global_sales DESC) sales_quartile
FROM games
WHERE year IS NOT NULL
ORDER BY year DESC, sales_quartile;";5;185;36;15;7;23;13;22;36;160,54;13,93;2236,09;124,23;0;1;0;0;1;2;6,2;3,5;34;7;1,5;0,35
57;C;-1;ChatGPT5.2;0;4;"WITH category_revenue AS (
    SELECT
        category,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY category
)
SELECT
    category,
    total_revenue,
    NTILE(4) OVER (ORDER BY total_revenue DESC) AS revenue_quartile
FROM category_revenue
ORDER BY revenue_quartile;";13;287;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,53;10,0;39;8;1,46;0,33
58;C;-1;ChatGPT5.2;1;4;"WITH category_sales AS (
    SELECT
        category,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY category
)
SELECT
    category,
    total_revenue,
    NTILE(4) OVER (ORDER BY total_revenue DESC) AS revenue_quartile
FROM category_sales
ORDER BY revenue_quartile;";13;283;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,53;10,0;39;8;1,46;0,33
59;C;-1;ChatGPT5.2;2;4;"WITH category_revenue AS (
    SELECT
        category,
        SUM(price) AS total_price
    FROM eshop
    GROUP BY category
)
SELECT
    category,
    total_price,
    NTILE(4) OVER (ORDER BY total_price DESC) AS revenue_quartile
FROM category_revenue
ORDER BY revenue_quartile;";13;281;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,52;10,0;39;8;1,46;0,33
60;C;-1;ChatGPT5.2;3;4;"SELECT category, total_price,
       NTILE(4) OVER (ORDER BY total_price DESC) quartile
FROM (
  SELECT category, SUM(price) total_price FROM eshop GROUP BY category
)
ORDER BY quartile;";6;186;37;12;7;25;12;19;37;157,17;10,29;1616,64;89,81;1;1;1;0;2;5;6,49;8,0;34;8;1,43;0,32
61;D;-1;ChatGPT5.2;0;4;"WITH state_revenue AS (
    SELECT
        ship_state,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY ship_state
)
SELECT
    ship_state,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS revenue_quartile
FROM state_revenue;";12;259;40;13;9;26;14;22;40;178,38;10,11;1803,59;100,2;1;1;1;1;2;5;7,0;10,0;35;8;1,48;0,34
62;D;-1;ChatGPT5.2;1;4;"WITH state_revenue AS (
    SELECT
        ship_state,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY ship_state
)
SELECT
    ship_state,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS revenue_quartile
FROM state_revenue;";12;259;40;13;9;26;14;22;40;178,38;10,11;1803,59;100,2;1;1;1;1;2;5;7,0;10,0;35;8;1,48;0,34
63;D;-1;ChatGPT5.2;2;4;"WITH ship_state_revenue AS (
    SELECT
        ship_state,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY ship_state
)
SELECT
    ship_state,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS revenue_quartile
FROM ship_state_revenue
ORDER BY revenue_quartile;";13;295;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,55;10,0;39;8;1,46;0,33
64;D;-1;ChatGPT5.2;3;4;"SELECT ship_state, total_amount,
       NTILE(4) OVER (ORDER BY total_amount DESC) quartile
FROM (
  SELECT ship_state, SUM(amount) total_amount FROM sales GROUP BY ship_state
);";5;178;34;12;7;23;11;19;34;144,43;9,43;1361,76;75,65;1;1;1;0;2;5;6,0;8,0;30;8;1,45;0,33
65;A;-1;ChatGPT5.2;0;5;"SELECT
    customer_id,
    invoice_no,
    invoice_date,
    stock_code,
    description,
    quantity,
    unit_price,
    country
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date
        ) AS rn
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
)
WHERE rn = 1
ORDER BY customer_id;";22;387;55;20;12;37;18;32;55;275,0;15,0;4125,0;229,17;1;1;0;0;2;6;10,59;6,5;54;10;1,61;0,39
66;A;-1;ChatGPT5.2;1;5;"WITH ranked_purchases AS (
    SELECT
        customer_id,
        invoice_no,
        invoice_date,
        stock_code,
        description,
        quantity,
        unit_price,
        country,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date
        ) AS rn
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
)
SELECT
    customer_id,
    invoice_no,
    invoice_date,
    stock_code,
    description,
    quantity,
    unit_price,
    country
FROM ranked_purchases
WHERE rn = 1
ORDER BY customer_id;";30;577;73;19;14;44;29;33;73;368,24;19,68;7246,45;402,58;1;1;0;1;2;6;13,25;8,5;74;10;1,66;0,41
67;A;-1;ChatGPT5.2;2;5;"WITH ranked_purchases AS (
    SELECT
        customer_id,
        invoice_no,
        invoice_date,
        stock_code,
        description,
        quantity,
        unit_price,
        country,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date
        ) AS purchase_rank
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
)
SELECT
    customer_id,
    invoice_no,
    invoice_date,
    stock_code,
    description,
    quantity,
    unit_price,
    country
FROM ranked_purchases
WHERE purchase_rank = 1
ORDER BY customer_id;";30;599;73;19;14;44;29;33;73;368,24;19,68;7246,45;402,58;1;1;0;1;2;6;13,3;8,5;74;10;1,66;0,41
68;A;-1;ChatGPT5.2;3;5;"SELECT customer_id, invoice_no, invoice_date, stock_code, description, quantity, unit_price, country
FROM (
  SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY invoice_date) rn
  FROM retail
  WHERE customer_id IS NOT NULL AND quantity<>0
)
WHERE rn=1
ORDER BY customer_id;";8;286;54;19;12;36;18;31;54;267,53;14,25;3812,25;211,79;1;1;0;0;2;6;10,19;6,5;54;10;1,61;0,39
69;B;-1;ChatGPT5.2;0;5;"SELECT
    publisher,
    year,
    ranking,
    name,
    eu_sales
FROM (
    SELECT
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (
            PARTITION BY publisher, year
            ORDER BY eu_sales DESC
        ) AS ranking
    FROM games
    WHERE year IS NOT NULL
)
WHERE ranking <= 3
ORDER BY publisher, year, ranking;";21;373;58;17;8;37;21;25;58;269,34;22,31;6009,73;333,87;1;1;0;0;2;5;10,59;6,5;58;10;1,58;0,38
70;B;-1;ChatGPT5.2;1;5;"SELECT
    publisher,
    year,
    ranking,
    name,
    eu_sales
FROM (
    SELECT
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (
            PARTITION BY publisher, year
            ORDER BY eu_sales DESC
        ) AS ranking
    FROM games
    WHERE year IS NOT NULL
)
WHERE ranking <= 3
ORDER BY publisher, year, ranking;";21;373;58;17;8;37;21;25;58;269,34;22,31;6009,73;333,87;1;1;0;0;2;5;10,59;6,5;58;10;1,58;0,38
71;B;-1;ChatGPT5.2;2;5;"WITH ranked_eu_sales AS (
    SELECT
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (
            PARTITION BY publisher, year
            ORDER BY eu_sales DESC
        ) AS ranking
    FROM games
    WHERE year IS NOT NULL
)
SELECT
    publisher,
    year,
    ranking,
    name,
    eu_sales
FROM ranked_eu_sales
WHERE ranking <= 3
ORDER BY publisher, year, ranking;";22;413;62;17;10;38;24;27;62;294,8;20,4;6013,98;334,11;1;1;0;1;2;5;11,11;8,5;63;10;1,59;0,38
72;B;-1;ChatGPT5.2;3;5;"SELECT publisher, year, ranking, name, eu_sales
FROM (
  SELECT publisher, year, name, eu_sales,
         ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) ranking
  FROM games
  WHERE year IS NOT NULL
)
WHERE ranking <= 3
ORDER BY publisher, year, ranking;";9;279;57;16;8;36;21;24;57;261,34;21,0;5488,2;304,9;1;1;0;0;2;5;10,2;6,5;58;10;1,58;0,38
73;C;-1;ChatGPT5.2;0;5;"WITH model_revenue AS (
    SELECT
        country,
        clothing_model,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY country, clothing_model
),
ranked_models AS (
    SELECT
        country,
        clothing_model,
        total_revenue,
        ROW_NUMBER() OVER (
            PARTITION BY country
            ORDER BY total_revenue DESC
        ) AS ranking
    FROM model_revenue
)
SELECT
    country,
    ranking,
    clothing_model,
    total_revenue
FROM ranked_models
WHERE ranking <= 3
ORDER BY country, ranking;
";28;544;72;16;11;45;27;27;72;342,35;19,64;6722,55;373,47;2;1;1;1;2;8;12,98;13,0;69;10;1,58;0,38
74;C;-1;ChatGPT5.2;1;5;"WITH model_sales AS (
    SELECT
        country,
        clothing_model,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY country, clothing_model
),
ranked_models AS (
    SELECT
        country,
        clothing_model,
        total_revenue,
        ROW_NUMBER() OVER (
            PARTITION BY country
            ORDER BY total_revenue DESC
        ) AS ranking
    FROM model_sales
)
SELECT
    country,
    ranking,
    clothing_model,
    total_revenue
FROM ranked_models
WHERE ranking <= 3
ORDER BY country, ranking;";27;539;72;16;11;45;27;27;72;342,35;19,64;6722,55;373,47;2;1;1;1;2;8;12,97;13,0;69;10;1,58;0,38
75;C;-1;ChatGPT5.2;2;5;"WITH model_revenue AS (
    SELECT
        country,
        clothing_model,
        SUM(price) AS total_price
    FROM eshop
    GROUP BY country, clothing_model
),
ranked_models AS (
    SELECT
        country,
        clothing_model,
        total_price,
        ROW_NUMBER() OVER (
            PARTITION BY country
            ORDER BY total_price DESC
        ) AS ranking
    FROM model_revenue
)
SELECT
    country,
    ranking,
    clothing_model,
    total_price
FROM ranked_models
WHERE ranking <= 3
ORDER BY country, ranking;";27;535;72;16;11;45;27;27;72;342,35;19,64;6722,55;373,47;2;1;1;1;2;8;12,96;13,0;69;10;1,58;0,38
76;C;-1;ChatGPT5.2;3;5;"SELECT country, ranking, clothing_model, total_price
FROM (
  SELECT country, clothing_model, SUM(price) total_price,
         ROW_NUMBER() OVER (PARTITION BY country ORDER BY SUM(price) DESC) ranking
  FROM eshop GROUP BY country, clothing_model
)
WHERE ranking<=3
ORDER BY country, ranking;";8;292;56;15;8;37;19;23;56;253,32;17,81;4512,25;250,68;1;1;2;0;3;7;10,11;9,5;52;11;1,55;0,37
77;D;-1;ChatGPT5.2;0;5;"WITH product_revenue AS (
    SELECT
        ship_state,
        product,
        SUM(amount) AS total_amount
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
),
ranked_products AS (
    SELECT
        ship_state,
        product,
        total_amount,
        ROW_NUMBER() OVER (
            PARTITION BY ship_state
            ORDER BY total_amount DESC
        ) AS ranking
    FROM product_revenue
)
SELECT
    ship_state,
    ranking,
    product,
    total_amount
FROM ranked_products
WHERE ranking <= 5
ORDER BY ship_state, ranking;";28;567;77;19;11;49;28;30;77;377,83;24,18;9136,63;507,59;2;1;1;1;2;8;14,05;13,0;75;10;1,57;0,37
78;D;-1;ChatGPT5.2;1;5;"WITH product_revenue AS (
    SELECT
        ship_state,
        product,
        SUM(amount) AS total_amount
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
),
ranked_products AS (
    SELECT
        ship_state,
        product,
        total_amount,
        ROW_NUMBER() OVER (
            PARTITION BY ship_state
            ORDER BY total_amount DESC
        ) AS ranking
    FROM product_revenue
)
SELECT
    ship_state,
    ranking,
    product,
    total_amount
FROM ranked_products
WHERE ranking <= 5
ORDER BY ship_state, ranking;";28;567;77;19;11;49;28;30;77;377,83;24,18;9136,63;507,59;2;1;1;1;2;8;14,05;13,0;75;10;1,57;0,37
79;D;-1;ChatGPT5.2;2;5;"WITH product_revenue AS (
    SELECT
        ship_state,
        product,
        SUM(amount) AS total_amount
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
),
ranked_products AS (
    SELECT
        ship_state,
        product,
        total_amount,
        ROW_NUMBER() OVER (
            PARTITION BY ship_state
            ORDER BY total_amount DESC
        ) AS product_rank
    FROM product_revenue
)
SELECT
    ship_state,
    product_rank,
    product,
    total_amount
FROM ranked_products
WHERE product_rank <= 5
ORDER BY ship_state, product_rank;";28;587;77;19;11;49;28;30;77;377,83;24,18;9136,63;507,59;2;1;1;1;2;8;14,09;13,0;75;10;1,57;0,37
80;D;-1;ChatGPT5.2;3;5;"SELECT ship_state, ranking, product, total_amount
FROM (
  SELECT ship_state, product, SUM(amount) total_amount,
         ROW_NUMBER() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) ranking
  FROM sales WHERE amount IS NOT NULL
  GROUP BY ship_state, product
)
WHERE ranking<=5
ORDER BY ship_state, ranking;";9;317;61;18;8;41;20;26;61;286,73;22,5;6451,35;358,41;1;1;2;0;3;7;11,19;9,5;58;11;1,54;0,36
81;A;-1;ChatGPT5.2;0;6;"SELECT
    country,
    invoice_month,
    ranking,
    customer_id,
    monthly_amount
FROM (
    SELECT
        country,
        DATE_TRUNC('MONTH', invoice_date) AS invoice_month,
        customer_id,
        SUM(quantity * unit_price) AS monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('MONTH', invoice_date)
            ORDER BY SUM(quantity * unit_price) DESC
        ) AS ranking
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
    GROUP BY country, invoice_month, customer_id
)
WHERE ranking <= 5
ORDER BY country, invoice_month, ranking, customer_id;";23;626;95;22;14;60;35;36;95;491,14;27,5;13506,43;750,36;1;1;2;0;3;8;17,17;9,5;89;12;1,6;0,38
82;A;-1;ChatGPT5.2;1;6;"WITH monthly_sales AS (
    SELECT
        country,
        DATE_TRUNC('MONTH', invoice_date) AS invoice_month,
        customer_id,
        SUM(quantity * unit_price) AS monthly_amount
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
    GROUP BY country, invoice_month, customer_id
),
ranked_customers AS (
    SELECT
        country,
        invoice_month,
        customer_id,
        monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, invoice_month
            ORDER BY monthly_amount DESC
        ) AS ranking
    FROM monthly_sales
)
SELECT
    country,
    invoice_month,
    ranking,
    customer_id,
    monthly_amount
FROM ranked_customers
WHERE ranking <= 5
ORDER BY country, invoice_month, ranking, customer_id;";32;776;104;22;17;63;41;39;104;549,68;26,53;14582,74;810,15;2;1;1;1;2;9;18,75;13,0;103;10;1,62;0,39
83;A;-1;ChatGPT5.2;2;6;"WITH monthly_turnover AS (
    SELECT
        country,
        DATE_TRUNC('MONTH', invoice_date) AS invoice_month,
        customer_id,
        SUM(quantity * unit_price) AS monthly_amount
    FROM retail
    WHERE customer_id IS NOT NULL
      AND quantity <> 0
    GROUP BY country, invoice_month, customer_id
),
ranked_customers AS (
    SELECT
        country,
        invoice_month,
        customer_id,
        monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, invoice_month
            ORDER BY monthly_amount DESC
        ) AS customer_rank
    FROM monthly_turnover
)
SELECT
    country,
    invoice_month,
    customer_rank,
    customer_id,
    monthly_amount
FROM ranked_customers
WHERE customer_rank <= 5
ORDER BY country, invoice_month, customer_rank, customer_id;";32;806;104;22;17;63;41;39;104;549,68;26,53;14582,74;810,15;2;1;1;1;2;9;18,81;13,0;103;10;1,62;0,39
84;A;-1;ChatGPT5.2;3;6;"SELECT country, invoice_month, ranking, customer_id, monthly_amount
FROM (
  SELECT country, DATE_TRUNC('MONTH',invoice_date) invoice_month, customer_id,
         SUM(quantity*unit_price) monthly_amount,
         ROW_NUMBER() OVER (
           PARTITION BY country, DATE_TRUNC('MONTH',invoice_date)
           ORDER BY SUM(quantity*unit_price) DESC
         ) ranking
  FROM retail
  WHERE customer_id IS NOT NULL AND quantity<>0
  GROUP BY country, invoice_month, customer_id
)
WHERE ranking<=5
ORDER BY country, invoice_month, ranking, customer_id;";14;550;92;21;14;57;35;35;92;471,89;26,25;12387,22;688,18;1;1;2;0;3;8;16,42;9,5;89;12;1,6;0,38
85;B;-1;ChatGPT5.2;0;6;"SELECT
    genre,
    year,
    total_na_sales
FROM (
    SELECT
        genre,
        year,
        SUM(na_sales) AS total_na_sales,
        ROW_NUMBER() OVER (
            PARTITION BY genre
            ORDER BY SUM(na_sales) DESC
        ) AS ranking
    FROM games
    WHERE year IS NOT NULL
    GROUP BY genre, year
)
WHERE ranking <= 3
ORDER BY genre, ranking;";19;367;61;19;8;42;19;27;61;290,05;22,56;6544,21;363,57;1;1;2;0;3;7;11,41;9,5;56;11;1,53;0,36
86;B;-1;ChatGPT5.2;1;6;"SELECT
    genre,
    year,
    total_na_sales
FROM (
    SELECT
        genre,
        year,
        SUM(na_sales) AS total_na_sales,
        ROW_NUMBER() OVER (
            PARTITION BY genre
            ORDER BY SUM(na_sales) DESC
        ) AS ranking
    FROM games
    WHERE year IS NOT NULL
    GROUP BY genre, year
)
WHERE ranking <= 3
ORDER BY genre, ranking;";19;367;61;19;8;42;19;27;61;290,05;22,56;6544,21;363,57;1;1;2;0;3;7;11,41;9,5;56;11;1,53;0,36
87;B;-1;ChatGPT5.2;2;6;"WITH yearly_na_sales AS (
    SELECT
        genre,
        year,
        SUM(na_sales) AS total_na_sales
    FROM games
    WHERE year IS NOT NULL
    GROUP BY genre, year
),
ranked_years AS (
    SELECT
        genre,
        year,
        total_na_sales,
        ROW_NUMBER() OVER (
            PARTITION BY genre
            ORDER BY total_na_sales DESC
        ) AS ranking
    FROM yearly_na_sales
)
SELECT
    genre,
    year,
    total_na_sales
FROM ranked_years
WHERE ranking <= 3
ORDER BY genre, ranking;";27;514;75;19;11;48;27;30;75;368,02;23,32;8581,48;476,75;2;1;1;1;2;8;13,67;13,0;73;10;1,57;0,37
88;B;-1;ChatGPT5.2;3;6;"SELECT genre, year, total_na_sales
FROM (
  SELECT genre, year, SUM(na_sales) total_na_sales,
         ROW_NUMBER() OVER (PARTITION BY genre ORDER BY SUM(na_sales) DESC) ranking
  FROM games
  WHERE year IS NOT NULL
  GROUP BY genre, year
)
WHERE ranking <= 3
ORDER BY genre, ranking;";10;284;59;18;8;40;19;26;59;277,33;21,38;5927,84;329,32;1;1;2;0;3;7;10,85;9,5;56;11;1,53;0,36
89;C;-1;ChatGPT5.2;0;6;"WITH daily_category_sales AS (
    SELECT
        country,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        category,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY country, sales_date, category
),
ranked_categories AS (
    SELECT
        country,
        sales_date,
        category,
        total_revenue,
        RANK() OVER (
            PARTITION BY country, sales_date
            ORDER BY total_revenue DESC
        ) AS ranking
    FROM daily_category_sales
)
SELECT
    country,
    sales_date,
    ranking,
    category,
    total_revenue
FROM ranked_categories
WHERE ranking <= 3
ORDER BY country, sales_date, ranking;";30;664;93;16;16;56;37;32;93;465,0;18,5;8602,5;477,92;2;1;1;1;2;8;16,22;13,0;89;10;1,63;0,39
90;C;-1;ChatGPT5.2;1;6;"WITH daily_category_sales AS (
    SELECT
        country,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        category,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY country, sales_date, category
),
ranked_categories AS (
    SELECT
        country,
        sales_date,
        category,
        total_revenue,
        RANK() OVER (
            PARTITION BY country, sales_date
            ORDER BY total_revenue DESC
        ) AS ranking
    FROM daily_category_sales
)
SELECT
    country,
    sales_date,
    ranking,
    category,
    total_revenue
FROM ranked_categories
WHERE ranking <= 3
ORDER BY country, sales_date, ranking;";30;664;93;16;16;56;37;32;93;465,0;18,5;8602,5;477,92;2;1;1;1;2;8;16,22;13,0;89;10;1,63;0,39
91;C;-1;ChatGPT5.2;2;6;"WITH daily_category_revenue AS (
    SELECT
        country,
        DATE_FROM_PARTS(year, month, day) AS sales_date,
        category,
        SUM(price) AS total_price
    FROM eshop
    GROUP BY country, sales_date, category
),
ranked_categories AS (
    SELECT
        country,
        sales_date,
        category,
        total_price,
        RANK() OVER (
            PARTITION BY country, sales_date
            ORDER BY total_price DESC
        ) AS ranking
    FROM daily_category_revenue
)
SELECT
    country,
    sales_date,
    ranking,
    category,
    total_price
FROM ranked_categories
WHERE ranking <= 3
ORDER BY country, sales_date, ranking;";30;660;93;16;16;56;37;32;93;465,0;18,5;8602,5;477,92;2;1;1;1;2;8;16,21;13,0;89;10;1,63;0,39
92;C;-1;ChatGPT5.2;3;6;"SELECT country, d, ranking, category, total_price
FROM (
  SELECT country, DATE_FROM_PARTS(year,month,day) d, category, SUM(price) total_price,
         RANK() OVER (PARTITION BY country, DATE_FROM_PARTS(year,month,day) ORDER BY SUM(price) DESC) ranking
  FROM eshop GROUP BY country, d, category
)
WHERE ranking<=3
ORDER BY country, d, ranking;";8;345;81;15;13;50;31;28;81;389,4;17,88;6964,19;386,9;1;1;2;0;3;7;13,78;9,5;75;11;1,61;0,39
93;D;-1;ChatGPT5.2;0;6;"WITH daily_state_revenue AS (
    SELECT
        order_date,
        ship_state,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY order_date, ship_state
),
ranked_states AS (
    SELECT
        order_date,
        ship_state,
        total_amount,
        RANK() OVER (
            PARTITION BY order_date
            ORDER BY total_amount DESC
        ) AS ranking
    FROM daily_state_revenue
)
SELECT
    order_date,
    ranking,
    ship_state,
    total_amount
FROM ranked_states
WHERE ranking <= 3
ORDER BY order_date, ranking;";27;548;72;16;11;45;27;27;72;342,35;19,64;6722,55;373,47;2;1;1;1;2;8;12,99;13,0;69;10;1,58;0,38
94;D;-1;ChatGPT5.2;1;6;"WITH daily_state_sales AS (
    SELECT
        order_date,
        ship_state,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY order_date, ship_state
),
ranked_states AS (
    SELECT
        order_date,
        ship_state,
        total_amount,
        RANK() OVER (
            PARTITION BY order_date
            ORDER BY total_amount DESC
        ) AS ranking
    FROM daily_state_sales
)
SELECT
    order_date,
    ranking,
    ship_state,
    total_amount
FROM ranked_states
WHERE ranking <= 3
ORDER BY order_date, ranking;";27;544;72;16;11;45;27;27;72;342,35;19,64;6722,55;373,47;2;1;1;1;2;8;12,98;13,0;69;10;1,58;0,38
95;D;-1;ChatGPT5.2;2;6;"WITH daily_state_revenue AS (
    SELECT
        order_date,
        ship_state,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY order_date, ship_state
),
ranked_states AS (
    SELECT
        order_date,
        ship_state,
        total_amount,
        RANK() OVER (
            PARTITION BY order_date
            ORDER BY total_amount DESC
        ) AS state_rank
    FROM daily_state_revenue
)
SELECT
    order_date,
    state_rank,
    ship_state,
    total_amount
FROM ranked_states
WHERE state_rank <= 3
ORDER BY order_date, state_rank;";27;560;72;16;11;45;27;27;72;342,35;19,64;6722,55;373,47;2;1;1;1;2;8;13,01;13,0;69;10;1,58;0,38
96;D;-1;ChatGPT5.2;3;6;"SELECT order_date, ranking, ship_state, total_amount
FROM (
  SELECT order_date, ship_state, SUM(amount) total_amount,
         RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) ranking
  FROM sales GROUP BY order_date, ship_state
)
WHERE ranking<=3
ORDER BY order_date, ranking;";8;293;56;15;8;37;19;23;56;253,32;17,81;4512,25;250,68;1;1;2;0;3;7;10,12;9,5;52;11;1,55;0,37
97;A;-1;ChatGPT5.2;0;7;"CREATE OR REPLACE TABLE cities_pop (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT cities_json_ff
    TYPE = JSON;

COPY INTO cities_pop
FROM @~/cities_population.json
FILE_FORMAT = cities_json_ff
ON_ERROR = CONTINUE;";11;222;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,15;1,0;7;4;1,5;0,43
98;A;-1;ChatGPT5.2;1;7;"CREATE OR REPLACE TABLE cities_pop (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT cities_json_format
    TYPE = JSON;

COPY INTO cities_pop
FROM @~/cities_population.json
FILE_FORMAT = cities_json_format
ON_ERROR = CONTINUE;";11;230;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,17;1,0;7;4;1,5;0,43
99;A;-1;ChatGPT5.2;2;7;"CREATE OR REPLACE TABLE cities_pop (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT cities_json_format
    TYPE = JSON;

COPY INTO cities_pop
FROM @~/cities_population.json
FILE_FORMAT = cities_json_format
ON_ERROR = CONTINUE;";11;230;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,17;1,0;7;4;1,5;0,43
100;A;-1;ChatGPT5.2;3;7;"CREATE OR REPLACE TABLE cities_pop (data VARIANT);
CREATE OR REPLACE FILE FORMAT ff_json TYPE=JSON;
COPY INTO cities_pop FROM @~/cities_population.json FILE_FORMAT=ff_json ON_ERROR=CONTINUE;";3;190;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,09;1,0;7;4;1,5;0,43
101;B;-1;ChatGPT5.2;0;7;"CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT house_parquet_ff
    TYPE = PARQUET;

COPY INTO house_price
FROM @~/house_price.json
FILE_FORMAT = house_parquet_ff
ON_ERROR = CONTINUE;";11;225;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,16;1,0;7;4;1,5;0,43
102;B;-1;ChatGPT5.2;1;7;"CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT house_parquet_format
    TYPE = PARQUET;

COPY INTO house_price
FROM @~/house_price.json
FILE_FORMAT = house_parquet_format
ON_ERROR = CONTINUE;";11;233;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,18;1,0;7;4;1,5;0,43
103;B;-1;ChatGPT5.2;2;7;"CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT house_parquet_format
    TYPE = PARQUET;

COPY INTO house_price
FROM @~/house_price.json
FILE_FORMAT = house_parquet_format
ON_ERROR = CONTINUE;";11;233;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,18;1,0;7;4;1,5;0,43
104;B;-1;ChatGPT5.2;3;7;"CREATE OR REPLACE TABLE house_price (data VARIANT);
CREATE OR REPLACE FILE FORMAT ff_house TYPE=PARQUET;
COPY INTO house_price FROM @~/house_price.json FILE_FORMAT=ff_house ON_ERROR=CONTINUE;";3;191;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,09;1,0;7;4;1,5;0,43
105;C;-1;ChatGPT5.2;0;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT forbes_json_ff
    TYPE = JSON;

COPY INTO forbes
FROM @~/forbes.json
FILE_FORMAT = forbes_json_ff
ON_ERROR = CONTINUE;";11;203;36;11;14;17;19;25;36;167,18;7,46;1247,87;69,33;0;0;0;0;1;2;6,12;1,0;7;4;1,5;0,43
106;C;-1;ChatGPT5.2;1;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT forbes_json_format
    TYPE = JSON;

COPY INTO forbes
FROM @~/forbes.json
FILE_FORMAT = forbes_json_format
ON_ERROR = CONTINUE;";11;211;36;11;14;17;19;25;36;167,18;7,46;1247,87;69,33;0;0;0;0;1;2;6,13;1,0;7;4;1,5;0,43
107;C;-1;ChatGPT5.2;2;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT forbes_json_format
    TYPE = JSON;

COPY INTO forbes
FROM @~/forbes.json
FILE_FORMAT = forbes_json_format
ON_ERROR = CONTINUE;";11;211;36;11;14;17;19;25;36;167,18;7,46;1247,87;69,33;0;0;0;0;1;2;6,13;1,0;7;4;1,5;0,43
108;C;-1;ChatGPT5.2;3;7;"CREATE OR REPLACE TABLE forbes (data VARIANT);
CREATE OR REPLACE FILE FORMAT ff_forbes TYPE=JSON;
COPY INTO forbes FROM @~/forbes.json FILE_FORMAT=ff_forbes ON_ERROR=CONTINUE;";3;175;36;11;14;17;19;25;36;167,18;7,46;1247,87;69,33;0;0;0;0;1;2;6,06;1,0;7;4;1,5;0,43
109;D;-1;ChatGPT5.2;0;7;"CREATE OR REPLACE TABLE weather (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT weather_parquet_format
    TYPE = PARQUET;

COPY INTO weather
FROM @~/weather.json
FILE_FORMAT = weather_parquet_format
ON_ERROR = CONTINUE;";11;225;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,16;1,0;7;4;1,5;0,43
110;D;-1;ChatGPT5.2;1;7;"CREATE OR REPLACE TABLE weather (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT weather_parquet_format
    TYPE = PARQUET;

COPY INTO weather
FROM @~/weather.json
FILE_FORMAT = weather_parquet_format
ON_ERROR = CONTINUE;";11;225;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,16;1,0;7;4;1,5;0,43
111;D;-1;ChatGPT5.2;2;7;"CREATE OR REPLACE TABLE weather (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT weather_parquet_format
    TYPE = PARQUET;

COPY INTO weather
FROM @~/weather.json
FILE_FORMAT = weather_parquet_format
ON_ERROR = CONTINUE;";11;225;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,16;1,0;7;4;1,5;0,43
112;D;-1;ChatGPT5.2;3;7;"CREATE OR REPLACE TABLE weather (data VARIANT);
CREATE OR REPLACE FILE FORMAT ff_weather TYPE=PARQUET;
COPY INTO weather FROM @~/weather.json FILE_FORMAT=ff_weather ON_ERROR=CONTINUE;";3;183;36;11;15;17;19;26;36;169,22;6,97;1178,87;65,49;0;0;0;0;1;2;6,08;1,0;7;4;1,5;0,43
113;A;-1;ChatGPT5.2;0;8;"SELECT
    city.value:name::STRING AS city_name,
    city.value:rank::INTEGER AS rank
FROM cities_pop,
     LATERAL FLATTEN(input => data:cities) city
WHERE data:country::STRING = 'India'
ORDER BY rank;";7;202;38;14;14;19;19;28;38;182,68;9,5;1735,46;96,41;0;0;0;0;1;0;5,65;1,0;60;8;1,97;0,5
114;A;-1;ChatGPT5.2;1;8;"SELECT
    city.value:name::STRING AS city_name,
    city.value:rank::INTEGER AS rank
FROM cities_pop,
     LATERAL FLATTEN(input => data:cities) city
WHERE data:country::STRING = 'India'
ORDER BY rank;";7;202;38;14;14;19;19;28;38;182,68;9,5;1735,46;96,41;0;0;0;0;1;0;5,65;1,0;60;8;1,97;0,5
115;A;-1;ChatGPT5.2;2;8;"WITH flattened_cities AS (
    SELECT
        data:country::STRING AS country,
        city.value:name::STRING AS city_name,
        city.value:rank::INTEGER AS city_rank
    FROM cities_pop,
         LATERAL FLATTEN(input => data:cities) city
)
SELECT
    city_name,
    city_rank
FROM flattened_cities
WHERE country = 'India'
ORDER BY city_rank;";14;347;53;13;18;25;28;31;53;262,57;10,11;2654,9;147,49;1;0;0;1;2;3;7,98;6,0;76;11;1,88;0,47
116;A;-1;ChatGPT5.2;3;8;"SELECT c.value:name::STRING city, c.value:rank::INT rank
FROM cities_pop, LATERAL FLATTEN(input=>data:cities) c
WHERE data:country::STRING='India'
ORDER BY rank;";4;161;36;13;14;17;19;27;36;171,18;8,82;1510,02;83,89;0;0;0;0;1;0;5,17;1,0;60;8;1,97;0,5
117;B;-1;ChatGPT5.2;0;8;"SELECT
    AVG(data:price::NUMBER) AS avg_price,
    MEDIAN(data:price::NUMBER) AS median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;142;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,15;4,0;44;7;1,59;0,39
118;B;-1;ChatGPT5.2;1;8;"SELECT
    AVG(data:price::NUMBER) AS avg_price,
    MEDIAN(data:price::NUMBER) AS median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;142;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,15;4,0;44;7;1,59;0,39
119;B;-1;ChatGPT5.2;2;8;"SELECT
    AVG(data:price::NUMBER)    AS avg_price,
    MEDIAN(data:price::NUMBER) AS median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;145;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,16;4,0;44;7;1,59;0,39
120;B;-1;ChatGPT5.2;3;8;"SELECT AVG(data:price::NUMBER) avg_price, MEDIAN(data:price::NUMBER) median_price
FROM house_price
WHERE data:price IS NOT NULL;";3;128;24;12;6;14;10;18;24;100,08;10,0;1000,78;55,6;0;0;2;0;1;0;3,73;4,0;44;7;1,59;0,39
121;C;-1;ChatGPT5.2;0;8;"SELECT
    data:name::STRING AS name,
    data:current_worth::NUMBER AS current_worth
FROM forbes
WHERE data:country::STRING = 'United States'
ORDER BY current_worth DESC;";6;171;25;9;11;10;15;20;25;108,05;6,14;663,02;36,83;0;0;0;0;0;0;3,25;1,0;43;7;1,68;0,42
122;C;-1;ChatGPT5.2;1;8;"SELECT
    data:name::STRING AS name,
    data:current_worth::NUMBER AS current_worth
FROM forbes
WHERE data:country::STRING = 'United States'
ORDER BY current_worth DESC;";6;171;25;9;11;10;15;20;25;108,05;6,14;663,02;36,83;0;0;0;0;0;0;3,25;1,0;43;7;1,68;0,42
123;C;-1;ChatGPT5.2;2;8;"SELECT
    data:name::STRING AS name,
    data:current_worth::NUMBER AS current_worth
FROM forbes
WHERE data:country::STRING = 'United States'
ORDER BY current_worth DESC;";6;171;25;9;11;10;15;20;25;108,05;6,14;663,02;36,83;0;0;0;0;0;0;3,25;1,0;43;7;1,68;0,42
124;C;-1;ChatGPT5.2;3;8;"SELECT data:name::STRING name, data:current_worth::NUMBER current_worth
FROM forbes
WHERE data:country::STRING='United States'
ORDER BY current_worth DESC;";4;155;23;8;11;8;15;19;23;97,7;5,45;532,92;29,61;0;0;0;0;0;0;2,82;1,0;43;7;1,68;0,42
125;D;-1;ChatGPT5.2;0;8;"SELECT
    AVG(data:MaxTemp::NUMBER)    AS avg_max_temp,
    MEDIAN(data:MaxTemp::NUMBER) AS median_max_temp,
    AVG(data:MinTemp::NUMBER)    AS avg_min_temp,
    MEDIAN(data:MinTemp::NUMBER) AS median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL
  AND data:MinTemp IS NOT NULL;";8;287;49;14;9;30;19;23;49;221,65;14,78;3275,56;181,98;0;0;4;0;1;1;7,86;7,0;84;8;1,63;0,39
126;D;-1;ChatGPT5.2;1;8;"SELECT
    AVG(data:MaxTemp::NUMBER)    AS avg_max_temp,
    MEDIAN(data:MaxTemp::NUMBER) AS median_max_temp,
    AVG(data:MinTemp::NUMBER)    AS avg_min_temp,
    MEDIAN(data:MinTemp::NUMBER) AS median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL
  AND data:MinTemp IS NOT NULL;";8;287;49;14;9;30;19;23;49;221,65;14,78;3275,56;181,98;0;0;4;0;1;1;7,86;7,0;84;8;1,63;0,39
127;D;-1;ChatGPT5.2;2;8;"SELECT
    AVG(data:MaxTemp::NUMBER)    AS avg_max_temp,
    MEDIAN(data:MaxTemp::NUMBER) AS median_max_temp,
    AVG(data:MinTemp::NUMBER)    AS avg_min_temp,
    MEDIAN(data:MinTemp::NUMBER) AS median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL
  AND data:MinTemp IS NOT NULL;";8;287;49;14;9;30;19;23;49;221,65;14,78;3275,56;181,98;0;0;4;0;1;1;7,86;7,0;84;8;1,63;0,39
128;D;-1;ChatGPT5.2;3;8;"SELECT
  AVG(data:MaxTemp::NUMBER) avg_max, MEDIAN(data:MaxTemp::NUMBER) med_max,
  AVG(data:MinTemp::NUMBER) avg_min, MEDIAN(data:MinTemp::NUMBER) med_min
FROM weather
WHERE data:MaxTemp IS NOT NULL AND data:MinTemp IS NOT NULL;";5;229;45;13;9;26;19;22;45;200,67;13,72;2753,7;152,98;0;0;4;0;1;1;6,95;7,0;84;8;1,63;0,39
129;A;-1;ChatGPT5.2;0;9;"SELECT
    data:country::STRING AS country,
    COUNT(*) AS city_count
FROM cities_pop,
     LATERAL FLATTEN(input => data:cities)
GROUP BY country
ORDER BY city_count;";7;168;31;14;10;19;12;24;31;142,13;8,4;1193,92;66,33;0;0;1;0;1;0;5,28;2,5;44;8;1,87;0,48
130;A;-1;ChatGPT5.2;1;9;"SELECT
    data:country::STRING AS country,
    COUNT(city.value) AS city_count
FROM cities_pop,
     LATERAL FLATTEN(input => data:cities) city
GROUP BY country
ORDER BY city_count;";7;182;34;14;12;19;15;26;34;159,81;8,75;1398,38;77,69;0;0;1;0;1;0;5,54;2,5;46;8;1,88;0,48
131;A;-1;ChatGPT5.2;2;9;"WITH flattened_cities AS (
    SELECT
        data:country::STRING AS country,
        city.value:name::STRING AS city_name
    FROM cities_pop,
         LATERAL FLATTEN(input => data:cities) city
)
SELECT
    country,
    COUNT(city_name) AS city_count
FROM flattened_cities
GROUP BY country
ORDER BY city_count;";13;313;49;14;15;26;23;29;49;238,04;10,73;2554,97;141,94;1;0;1;1;2;3;7,81;7,5;66;11;1,81;0,45
132;A;-1;ChatGPT5.2;3;9;"SELECT data:country::STRING country, COUNT(*) city_count
FROM cities_pop, LATERAL FLATTEN(input=>data:cities)
GROUP BY country
ORDER BY city_count;";4;147;29;13;10;17;12;23;29;131,18;7,8;1023,23;56,85;0;0;1;0;1;0;4,83;2,5;44;8;1,87;0,48
133;B;-1;ChatGPT5.2;0;9;"SELECT
    data:furnishingstatus::STRING AS furnishing_status,
    COUNT(*) AS house_count,
    AVG(data:price::NUMBER) AS avg_price
FROM house_price
WHERE data:price IS NOT NULL
GROUP BY furnishing_status
ORDER BY furnishing_status;";8;233;36;17;9;23;13;26;36;169,22;12,28;2077,59;115,42;0;0;2;0;1;0;5,98;4,0;50;7;1,63;0,4
134;B;-1;ChatGPT5.2;1;9;"SELECT
    data:furnishingstatus::STRING AS furnishingstatus,
    COUNT(*) AS house_count,
    AVG(data:price::NUMBER) AS avg_price
FROM house_price
WHERE data:price IS NOT NULL
GROUP BY furnishingstatus
ORDER BY furnishingstatus;";8;230;36;17;9;23;13;26;36;169,22;12,28;2077,59;115,42;0;0;2;0;1;0;5,97;4,0;50;7;1,63;0,4
135;B;-1;ChatGPT5.2;2;9;"SELECT
    data:furnishingstatus::STRING AS furnishingstatus,
    COUNT(*) AS house_count,
    AVG(data:price::NUMBER) AS avg_price
FROM house_price
WHERE data:price IS NOT NULL
GROUP BY furnishingstatus
ORDER BY furnishingstatus;";8;230;36;17;9;23;13;26;36;169,22;12,28;2077,59;115,42;0;0;2;0;1;0;5,97;4,0;50;7;1,63;0,4
136;B;-1;ChatGPT5.2;3;9;"SELECT data:furnishingstatus::STRING furnishingstatus,
       COUNT(*) house_count,
       AVG(data:price::NUMBER) avg_price
FROM house_price
WHERE data:price IS NOT NULL
GROUP BY furnishingstatus
ORDER BY furnishingstatus;";7;223;33;16;9;20;13;25;33;153,25;11,56;1770,86;98,38;0;0;2;0;1;0;5,36;4,0;50;7;1,63;0,4
137;C;-1;ChatGPT5.2;0;9;"SELECT
    data:name::STRING AS name,
    data:current_worth::NUMBER AS current_worth,
    ARRAY_SIZE(data:industries) AS industry_count
FROM forbes
ORDER BY current_worth DESC;";6;177;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,59;1,0;41;6;1,67;0,41
138;C;-1;ChatGPT5.2;1;9;"SELECT
    data:name::STRING AS name,
    data:current_worth::NUMBER AS current_worth,
    ARRAY_SIZE(data:industries) AS industry_count
FROM forbes
ORDER BY current_worth DESC;";6;177;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,59;1,0;41;6;1,67;0,41
139;C;-1;ChatGPT5.2;2;9;"SELECT
    data:name::STRING AS name,
    data:current_worth::NUMBER AS current_worth,
    ARRAY_SIZE(data:industries) AS industry_count
FROM forbes
ORDER BY current_worth DESC;";6;177;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,59;1,0;41;6;1,67;0,41
140;C;-1;ChatGPT5.2;3;9;"SELECT data:name::STRING name, data:current_worth::NUMBER current_worth,
       ARRAY_SIZE(data:industries) industry_count
FROM forbes
ORDER BY current_worth DESC;";4;163;23;8;12;9;14;20;23;99,4;4,67;463,89;25,77;0;0;0;0;1;0;2,97;1,0;41;6;1,67;0,41
141;D;-1;ChatGPT5.2;0;9;"SELECT
    data:WindGustDir::STRING AS wind_direction,
    AVG(data:Rainfall::NUMBER) AS avg_rainfall
FROM weather
WHERE data:Rainfall IS NOT NULL
GROUP BY wind_direction
ORDER BY avg_rainfall;
";8;194;29;15;8;17;12;23;29;131,18;11,25;1475,81;81,99;0;0;1;0;1;0;4,62;2,5;46;7;1,61;0,39
142;D;-1;ChatGPT5.2;1;9;"SELECT
    data:WindGustDir::STRING AS wind_direction,
    AVG(data:Rainfall::NUMBER) AS avg_rainfall
FROM weather
WHERE data:Rainfall IS NOT NULL
GROUP BY wind_direction
ORDER BY avg_rainfall;";7;193;29;15;8;17;12;23;29;131,18;11,25;1475,81;81,99;0;0;1;0;1;0;4,62;2,5;46;7;1,61;0,39
143;D;-1;ChatGPT5.2;2;9;"SELECT
    data:WindGustDir::STRING AS wind_gust_dir,
    AVG(data:Rainfall::NUMBER) AS avg_rainfall
FROM weather
WHERE data:Rainfall IS NOT NULL
GROUP BY wind_gust_dir
ORDER BY avg_rainfall;";7;191;29;15;8;17;12;23;29;131,18;11,25;1475,81;81,99;0;0;1;0;1;0;4,61;2,5;46;7;1,61;0,39
144;D;-1;ChatGPT5.2;3;9;"SELECT data:WindGustDir::STRING wind_dir, AVG(data:Rainfall::NUMBER) avg_rainfall
FROM weather
WHERE data:Rainfall IS NOT NULL
GROUP BY wind_dir
ORDER BY avg_rainfall;";5;167;27;14;8;15;12;22;27;120,4;10,5;1264,25;70,24;0;0;1;0;1;0;4,16;2,5;46;7;1,61;0,39
145;A;-1;ChatGPT5.2;0;10;"SELECT
    city.value:name::STRING AS city_name,
    SUM(district.value:area_km2:area_km2::NUMBER) AS total_area_km2
FROM cities_pop,
     LATERAL FLATTEN(input => data:cities) city,
     LATERAL FLATTEN(input => city.value:districts) district
GROUP BY city_name
ORDER BY total_area_km2 DESC;";8;292;51;14;16;26;25;30;51;250,25;10,94;2737,12;152,06;0;0;1;0;1;0;8,02;2,5;78;8;2,03;0,51
146;A;-1;ChatGPT5.2;1;10;"SELECT
    city.value:name::STRING AS city_name,
    SUM(district.value:area_km2:area_km2::NUMBER) AS total_area_km2
FROM cities_pop,
     LATERAL FLATTEN(input => data:cities) city,
     LATERAL FLATTEN(input => city.value:districts) district
GROUP BY city_name
ORDER BY total_area_km2 DESC;";8;292;51;14;16;26;25;30;51;250,25;10,94;2737,12;152,06;0;0;1;0;1;0;8,02;2,5;78;8;2,03;0,51
147;A;-1;ChatGPT5.2;2;10;"WITH flattened_districts AS (
    SELECT
        city.value:name::STRING AS city_name,
        district.value:area_km2:area_km2::NUMBER AS area_km2
    FROM cities_pop,
         LATERAL FLATTEN(input => data:cities) city,
         LATERAL FLATTEN(input => city.value:districts) district
)
SELECT
    city_name,
    SUM(area_km2) AS total_area_km2
FROM flattened_districts
GROUP BY city_name
ORDER BY total_area_km2 DESC;";14;420;64;14;19;33;31;33;64;322,84;11,42;3687,19;204,84;1;0;1;1;2;3;10,28;7,5;92;11;1,94;0,49
148;A;-1;ChatGPT5.2;3;10;"SELECT c.value:name::STRING city,
       SUM(d.value:area_km2:area_km2::NUMBER) total_area_km2
FROM cities_pop,
     LATERAL FLATTEN(input=>data:cities) c,
     LATERAL FLATTEN(input=>c.value:districts) d
GROUP BY city
ORDER BY total_area_km2 DESC;";7;248;49;13;16;24;25;29;49;238,04;10,16;2417,6;134,31;0;0;1;0;1;0;7,54;2,5;78;8;2,03;0,51
149;B;-1;ChatGPT5.2;0;10;"SELECT
    furnishing_status,
    price,
    ranking
FROM (
    SELECT
        data:furnishingstatus::STRING AS furnishing_status,
        data:price::NUMBER AS price,
        ROW_NUMBER() OVER (
            PARTITION BY data:furnishingstatus::STRING
            ORDER BY data:price::NUMBER DESC
        ) AS ranking
    FROM house_price
    WHERE data:price IS NOT NULL
)
WHERE ranking <= 3
ORDER BY furnishing_status, ranking;





";23;434;58;17;11;33;25;28;58;278,83;19,32;5386,42;299,25;1;1;0;0;2;5;9,51;6,5;85;12;1,65;0,4
150;B;-1;ChatGPT5.2;1;10;"SELECT
    furnishingstatus,
    price,
    ranking
FROM (
    SELECT
        data:furnishingstatus::STRING AS furnishingstatus,
        data:price::NUMBER AS price,
        ROW_NUMBER() OVER (
            PARTITION BY data:furnishingstatus::STRING
            ORDER BY data:price::NUMBER DESC
        ) AS ranking
    FROM house_price
    WHERE data:price IS NOT NULL
)
WHERE ranking <= 3
ORDER BY furnishingstatus, ranking;";17;425;58;17;11;33;25;28;58;278,83;19,32;5386,42;299,25;1;1;0;0;2;5;9,49;6,5;85;12;1,65;0,4
151;B;-1;ChatGPT5.2;2;10;"WITH ranked_houses AS (
    SELECT
        data:furnishingstatus::STRING AS furnishingstatus,
        data:price::NUMBER AS price,
        ROW_NUMBER() OVER (
            PARTITION BY data:furnishingstatus::STRING
            ORDER BY data:price::NUMBER DESC
        ) AS ranking
    FROM house_price
    WHERE data:price IS NOT NULL
)
SELECT
    furnishingstatus,
    price,
    ranking
FROM ranked_houses
WHERE ranking <= 3
ORDER BY furnishingstatus, ranking;";18;461;62;17;13;34;28;30;62;304,23;18,31;5569,7;309,43;1;1;0;1;2;5;10,0;8,5;90;12;1,65;0,4
152;B;-1;ChatGPT5.2;3;10;"SELECT furnishingstatus, price, ranking
FROM (
  SELECT data:furnishingstatus::STRING furnishingstatus,
         data:price::NUMBER price,
         ROW_NUMBER() OVER (
           PARTITION BY data:furnishingstatus::STRING
           ORDER BY data:price::NUMBER DESC
         ) ranking
  FROM house_price
  WHERE data:price IS NOT NULL
)
WHERE ranking <= 3
ORDER BY furnishingstatus, ranking;";13;391;55;16;11;30;25;27;55;261,52;18,18;4754,89;264,16;1;1;0;0;2;5;8,82;6,5;85;12;1,65;0,4
153;C;-1;ChatGPT5.2;0;10;"SELECT
    industry.value::STRING AS industry,
    COUNT(*) AS billionaire_count
FROM forbes,
     LATERAL FLATTEN(input => data:industries) industry
GROUP BY industry
ORDER BY billionaire_count DESC;";7;200;35;15;11;20;15;26;35;164,52;10,23;1682,54;93,47;0;0;1;0;1;0;5,86;2,5;41;8;1,9;0,49
154;C;-1;ChatGPT5.2;1;10;"SELECT
    industry.value::STRING AS industry,
    COUNT(*) AS billionaire_count
FROM forbes,
     LATERAL FLATTEN(input => data:industries) industry
GROUP BY industry
ORDER BY billionaire_count DESC;";7;200;35;15;11;20;15;26;35;164,52;10,23;1682,54;93,47;0;0;1;0;1;0;5,86;2,5;41;8;1,9;0,49
155;C;-1;ChatGPT5.2;2;10;"SELECT
    industry.value::STRING AS industry,
    COUNT(*) AS billionaire_count
FROM forbes,
     LATERAL FLATTEN(input => data:industries) industry
GROUP BY industry
ORDER BY billionaire_count DESC;";7;200;35;15;11;20;15;26;35;164,52;10,23;1682,54;93,47;0;0;1;0;1;0;5,86;2,5;41;8;1,9;0,49
156;C;-1;ChatGPT5.2;3;10;"SELECT i.value::STRING industry, COUNT(*) billionaire_count
FROM forbes, LATERAL FLATTEN(input=>data:industries) i
GROUP BY industry
ORDER BY billionaire_count DESC;";4;165;33;14;12;18;15;26;33;155,11;8,75;1357,25;75,4;0;0;1;0;1;0;5,39;2,5;41;8;1,9;0,49
157;D;-1;ChatGPT5.2;0;10;"WITH ranked_temps AS (
    SELECT
        data:WindGustDir::STRING AS wind_direction,
        data:Temp3pm::NUMBER AS temp_3pm,
        ROW_NUMBER() OVER (
            PARTITION BY data:WindGustDir::STRING
            ORDER BY data:Temp3pm::NUMBER DESC
        ) AS ranking
    FROM weather
    WHERE data:Temp3pm IS NOT NULL
)
SELECT
    wind_direction,
    ranking,
    temp_3pm
FROM ranked_temps
WHERE ranking <= 3
ORDER BY wind_direction, ranking;";18;451;62;17;13;34;28;30;62;304,23;18,31;5569,7;309,43;1;1;0;1;2;5;9,98;8,5;90;12;1,65;0,4
158;D;-1;ChatGPT5.2;1;10;"WITH ranked_temperatures AS (
    SELECT
        data:WindGustDir::STRING AS wind_direction,
        data:Temp3pm::NUMBER AS temp_3pm,
        ROW_NUMBER() OVER (
            PARTITION BY data:WindGustDir::STRING
            ORDER BY data:Temp3pm::NUMBER DESC
        ) AS ranking
    FROM weather
    WHERE data:Temp3pm IS NOT NULL
)
SELECT
    wind_direction,
    ranking,
    temp_3pm
FROM ranked_temperatures
WHERE ranking <= 3
ORDER BY wind_direction, ranking;





";24;471;62;17;13;34;28;30;62;304,23;18,31;5569,7;309,43;1;1;0;1;2;5;10,02;8,5;90;12;1,65;0,4
159;D;-1;ChatGPT5.2;2;10;"WITH ranked_temperatures AS (
    SELECT
        data:WindGustDir::STRING AS wind_gust_dir,
        data:Temp3pm::NUMBER AS temp_3pm,
        ROW_NUMBER() OVER (
            PARTITION BY data:WindGustDir::STRING
            ORDER BY data:Temp3pm::NUMBER DESC
        ) AS temp_rank
    FROM weather
    WHERE data:Temp3pm IS NOT NULL
)
SELECT
    wind_gust_dir,
    temp_rank,
    temp_3pm
FROM ranked_temperatures
WHERE temp_rank <= 3
ORDER BY wind_gust_dir, temp_rank;";18;470;62;17;13;34;28;30;62;304,23;18,31;5569,7;309,43;1;1;0;1;2;5;10,02;8,5;90;12;1,65;0,4
160;D;-1;ChatGPT5.2;3;10;"SELECT wind_dir, ranking, temp_3pm
FROM (
  SELECT data:WindGustDir::STRING wind_dir, data:Temp3pm::NUMBER temp_3pm,
         ROW_NUMBER() OVER (PARTITION BY data:WindGustDir::STRING ORDER BY data:Temp3pm::NUMBER DESC) ranking
  FROM weather WHERE data:Temp3pm IS NOT NULL
)
WHERE ranking<=3
ORDER BY wind_dir, ranking;";8;319;55;16;11;30;25;27;55;261,52;18,18;4754,89;264,16;1;1;0;0;2;5;8,68;6,5;85;12;1,65;0,4
161;A;-1;CortexAI;0;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL,
    customer_id INTEGER,
    country TEXT
);

COPY INTO retail 
FROM '@my_stage/online_retail.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";19;377;53;10;25;23;30;35;53;271,85;6,0;1631,11;90,62;0;0;0;0;1;1;8,37;1,0;32;6;2,21;0,56
162;A;-1;CortexAI;1;1;"CREATE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL,
    customer_id INTEGER,
    country TEXT
);

COPY INTO retail 
FROM '@my_stage/online_retail.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";19;366;51;9;24;22;29;33;51;257,26;5,44;1398,87;77,72;0;0;0;0;1;0;7,92;1,0;32;6;2,21;0,56
163;A;-1;CortexAI;2;1;"CREATE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL,
    customer_id INTEGER,
    country TEXT
);

COPY INTO retail 
FROM '@my_stage/online_retail.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";19;366;51;9;24;22;29;33;51;257,26;5,44;1398,87;77,72;0;0;0;0;1;0;7,92;1,0;32;6;2,21;0,56
164;A;-1;CortexAI;3;1;"CREATE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL,
    customer_id INTEGER,
    country TEXT
);

COPY INTO retail 
FROM '@my_stage/online_retail.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";19;366;51;9;24;22;29;33;51;257,26;5,44;1398,87;77,72;0;0;0;0;1;0;7,92;1,0;32;6;2,21;0,56
165;B;-1;CortexAI;0;1;"CREATE TABLE games (
    id INTEGER,
    name TEXT,
    platform TEXT,
    year INTEGER,
    genre TEXT,
    publisher TEXT,
    na_sales DECIMAL,
    eu_sales DECIMAL,
    jp_sales DECIMAL,
    other_sales DECIMAL,
    global_sales DECIMAL
);

COPY INTO games 
FROM '@my_stage/video_game_sales.csv'
FILE_FORMAT = (
    TYPE = 'CSV'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";21;377;57;9;24;24;33;33;57;287,53;6,19;1779,09;98,84;0;0;0;0;1;0;8,59;1,0;57;6;1,93;0,49
166;B;-1;CortexAI;1;1;"CREATE TABLE games (
    id INTEGER,
    name TEXT,
    platform TEXT,
    year INTEGER,
    genre TEXT,
    publisher TEXT,
    na_sales DECIMAL,
    eu_sales DECIMAL,
    jp_sales DECIMAL,
    other_sales DECIMAL,
    global_sales DECIMAL
);

COPY INTO games 
FROM '@my_stage/video_game_sales.csv'
FILE_FORMAT = (
    TYPE = 'CSV'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";21;377;57;9;24;24;33;33;57;287,53;6,19;1779,09;98,84;0;0;0;0;1;0;8,59;1,0;57;6;1,93;0,49
167;B;-1;CortexAI;2;1;"CREATE TABLE games (
    id INTEGER,
    name TEXT,
    platform TEXT,
    year INTEGER,
    genre TEXT,
    publisher TEXT,
    na_sales DECIMAL,
    eu_sales DECIMAL,
    jp_sales DECIMAL,
    other_sales DECIMAL,
    global_sales DECIMAL
);

COPY INTO games 
FROM '@my_stage/video_game_sales.csv'
FILE_FORMAT = (
    TYPE = 'CSV'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";21;377;57;9;24;24;33;33;57;287,53;6,19;1779,09;98,84;0;0;0;0;1;0;8,59;1,0;57;6;1,93;0,49
168;B;-1;CortexAI;3;1;"CREATE TABLE games (
    id INTEGER,
    name TEXT,
    platform TEXT,
    year INTEGER,
    genre TEXT,
    publisher TEXT,
    na_sales DECIMAL,
    eu_sales DECIMAL,
    jp_sales DECIMAL,
    other_sales DECIMAL,
    global_sales DECIMAL
);

COPY INTO games 
FROM '@my_stage/video_game_sales.csv'
FILE_FORMAT = (
    TYPE = 'CSV'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";21;377;57;9;24;24;33;33;57;287,53;6,19;1779,09;98,84;0;0;0;0;1;0;8,59;1,0;57;6;1,93;0,49
169;C;-1;CortexAI;0;1;"CREATE TABLE eshop (
    year INTEGER,
    month INTEGER,
    day INTEGER,
    order_no INTEGER,
    country TEXT,
    session_id INTEGER,
    category TEXT,
    clothing_model TEXT,
    colour TEXT,
    location TEXT,
    model INTEGER,
    price INTEGER,
    page TEXT
);

COPY INTO eshop 
FROM '@my_stage/eshop_clothing.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";24;432;66;9;27;27;39;36;66;341,22;6,5;2217,9;123,22;0;0;0;0;1;0;9,85;1,0;43;4;2,62;0,63
170;C;-1;CortexAI;1;1;"CREATE TABLE eshop (
    year INTEGER,
    month INTEGER,
    day INTEGER,
    order_no INTEGER,
    country TEXT,
    session_id INTEGER,
    category TEXT,
    clothing_model TEXT,
    colour TEXT,
    location TEXT,
    model INTEGER,
    price INTEGER,
    page TEXT
);

COPY INTO eshop 
FROM '@my_stage/eshop_clothing.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";24;432;66;9;27;27;39;36;66;341,22;6,5;2217,9;123,22;0;0;0;0;1;0;9,85;1,0;43;4;2,62;0,63
171;C;-1;CortexAI;2;1;"CREATE TABLE eshop (
    year INTEGER,
    month INTEGER,
    day INTEGER,
    order_no INTEGER,
    country TEXT,
    session_id INTEGER,
    category TEXT,
    clothing_model TEXT,
    colour TEXT,
    location TEXT,
    model INTEGER,
    price INTEGER,
    page TEXT
);

COPY INTO eshop 
FROM '@my_stage/eshop_clothing.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";24;432;66;9;27;27;39;36;66;341,22;6,5;2217,9;123,22;0;0;0;0;1;0;9,85;1,0;43;4;2,62;0,63
172;C;-1;CortexAI;3;1;"CREATE TABLE eshop (
    year INTEGER,
    month INTEGER,
    day INTEGER,
    order_no INTEGER,
    country TEXT,
    session_id INTEGER,
    category TEXT,
    clothing_model TEXT,
    colour TEXT,
    location TEXT,
    model INTEGER,
    price INTEGER,
    page TEXT
);

COPY INTO eshop 
FROM '@my_stage/eshop_clothing.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";24;432;66;9;27;27;39;36;66;341,22;6,5;2217,9;123,22;0;0;0;0;1;0;9,85;1,0;43;4;2,62;0,63
173;D;-1;CortexAI;0;1;"CREATE TABLE sales (
    order_id TEXT,
    order_date DATE,
    status TEXT,
    fulfilment TEXT,
    ship_service TEXT,
    product TEXT,
    category TEXT,
    size TEXT,
    courier_status TEXT,
    quantity INTEGER,
    amount DECIMAL,
    ship_state TEXT
);

COPY INTO sales 
FROM '@my_stage/amazon_report.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";23;421;63;9;28;26;37;37;63;328,2;5,95;1951,59;108,42;0;0;0;0;1;0;9,47;1,0;44;6;2,39;0,59
174;D;-1;CortexAI;1;1;"CREATE TABLE sales (
    order_id TEXT,
    order_date DATE,
    status TEXT,
    fulfilment TEXT,
    ship_service TEXT,
    product TEXT,
    category TEXT,
    size TEXT,
    courier_status TEXT,
    quantity INTEGER,
    amount DECIMAL,
    ship_state TEXT
);

COPY INTO sales 
FROM '@my_stage/amazon_report.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";23;421;63;9;28;26;37;37;63;328,2;5,95;1951,59;108,42;0;0;0;0;1;0;9,47;1,0;44;6;2,39;0,59
175;D;-1;CortexAI;2;1;"CREATE TABLE sales (
    order_id TEXT,
    order_date DATE,
    status TEXT,
    fulfilment TEXT,
    ship_service TEXT,
    product TEXT,
    category TEXT,
    size TEXT,
    courier_status TEXT,
    quantity INTEGER,
    amount DECIMAL,
    ship_state TEXT
);

COPY INTO sales 
FROM '@my_stage/amazon_report.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";23;421;63;9;28;26;37;37;63;328,2;5,95;1951,59;108,42;0;0;0;0;1;0;9,47;1,0;44;6;2,39;0,59
176;D;-1;CortexAI;3;1;"CREATE TABLE sales (
    order_id TEXT,
    order_date DATE,
    status TEXT,
    fulfilment TEXT,
    ship_service TEXT,
    product TEXT,
    category TEXT,
    size TEXT,
    courier_status TEXT,
    quantity INTEGER,
    amount DECIMAL,
    ship_state TEXT
);

COPY INTO sales 
FROM '@my_stage/amazon_report.csv'
FILE_FORMAT = (
    TYPE = 'CSV' 
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";23;421;63;9;28;26;37;37;63;328,2;5,95;1951,59;108,42;0;0;0;0;1;0;9,47;1,0;44;6;2,39;0,59
177;A;-1;CortexAI;0;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price as amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date 
        RANGE BETWEEN INTERVAL '14 DAYS' PRECEDING AND CURRENT ROW
    ) as rolling_14day_sum
FROM retail
ORDER BY customer_id, invoice_date;";11;324;44;19;9;29;15;28;44;211,52;15,83;3349,12;186,06;0;1;1;0;1;3;7,99;5,0;41;7;1,54;0,37
178;A;-1;CortexAI;1;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price as amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date 
        RANGE BETWEEN INTERVAL '14 DAYS' PRECEDING AND CURRENT ROW
    ) as rolling_14day_sum
FROM retail
ORDER BY customer_id, invoice_date;";11;324;44;19;9;29;15;28;44;211,52;15,83;3349,12;186,06;0;1;1;0;1;3;7,99;5,0;41;7;1,54;0,37
179;A;-1;CortexAI;2;2;"WITH daily_sales AS (
    SELECT 
        customer_id,
        invoice_date::DATE as sale_date,
        SUM(quantity * unit_price) as daily_amount
    FROM retail
    GROUP BY customer_id, sale_date
)
SELECT 
    customer_id,
    sale_date,
    daily_amount,
    SUM(daily_amount) OVER (
        PARTITION BY customer_id 
        ORDER BY sale_date 
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) as rolling_14day_sum
FROM daily_sales
ORDER BY customer_id, sale_date;";19;476;66;20;13;42;24;33;66;332,93;18,46;6146,4;341,47;1;1;2;1;2;6;11,65;11,5;60;9;1,55;0,37
180;A;-1;CortexAI;3;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price as amount,
    SUM(quantity * unit_price) OVER (PARTITION BY customer_id ORDER BY invoice_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) as rolling_14day_sum
FROM retail
ORDER BY customer_id, invoice_date;";7;275;43;19;8;29;14;27;43;204,46;16,62;3399,15;188,84;0;1;1;0;1;3;7,81;5,0;39;7;1,52;0,36
181;B;-1;CortexAI;0;2;"SELECT 
    platform,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(SUM(global_sales)) OVER (PARTITION BY platform ORDER BY year ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) as rolling_3year_sum
FROM games
GROUP BY platform, year
ORDER BY platform, year;";8;262;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,18;8,0;40;7;1,5;0,35
182;B;-1;CortexAI;1;2;"SELECT 
    platform,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(SUM(global_sales)) OVER (PARTITION BY platform ORDER BY year ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) as rolling_3year_sum
FROM games
GROUP BY platform, year
ORDER BY platform, year;";8;262;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,18;8,0;40;7;1,5;0,35
183;B;-1;CortexAI;2;2;"SELECT 
    platform,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(SUM(global_sales)) OVER (
        PARTITION BY platform 
        ORDER BY year 
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) as rolling_3year_sum
FROM games
GROUP BY platform, year
ORDER BY platform, year;";12;294;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,25;8,0;40;7;1,5;0,35
184;B;-1;CortexAI;3;2;"SELECT 
    platform,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(SUM(global_sales)) OVER (PARTITION BY platform ORDER BY year ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) as rolling_3year_sum
FROM games
GROUP BY platform, year
ORDER BY platform, year;";8;262;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,18;8,0;40;7;1,5;0,35
185;C;-1;CortexAI;0;2;"SELECT 
    ship_state,
    order_date,
    SUM(amount) as daily_amount,
    SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM sales
GROUP BY ship_state, order_date
ORDER BY ship_state, order_date;";8;281;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,22;8,0;40;7;1,5;0,35
186;C;-1;CortexAI;1;2;"SELECT 
    country,
    DATE_FROM_PARTS(year, month, day) as order_date,
    SUM(price) as daily_amount,
    SUM(SUM(price)) OVER (PARTITION BY country ORDER BY DATE_FROM_PARTS(year, month, day) ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM eshop
GROUP BY country, order_date
ORDER BY country, order_date;";8;327;66;19;11;45;21;30;66;323,85;18,14;5873,55;326,31;0;1;3;0;2;3;11,67;8,0;52;8;1,55;0,37
187;C;-1;CortexAI;2;2;"WITH daily_sales AS (
    SELECT 
        country,
        DATE_FROM_PARTS(year, month, day) as sale_date,
        SUM(price) as daily_amount
    FROM eshop
    GROUP BY country, sale_date
)
SELECT 
    country,
    sale_date,
    daily_amount,
    SUM(daily_amount) OVER (
        PARTITION BY country 
        ORDER BY sale_date 
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) as rolling_7day_sum
FROM daily_sales
ORDER BY country, sale_date;";19;452;69;19;13;45;24;32;69;345,0;17,54;6050,77;336,15;1;1;2;1;2;6;12,28;11,5;60;8;1,55;0,37
188;C;-1;CortexAI;3;2;"SELECT 
    country,
    DATE_FROM_PARTS(year, month, day) as order_date,
    SUM(price) as daily_amount,
    SUM(SUM(price)) OVER (PARTITION BY country ORDER BY DATE_FROM_PARTS(year, month, day) ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM eshop
GROUP BY country, order_date
ORDER BY country, order_date;";8;327;66;19;11;45;21;30;66;323,85;18,14;5873,55;326,31;0;1;3;0;2;3;11,67;8,0;52;8;1,55;0,37
189;D;-1;CortexAI;0;2;"SELECT 
    ship_state,
    order_date,
    SUM(amount) as daily_amount,
    SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM sales
GROUP BY ship_state, order_date
ORDER BY ship_state, order_date;";8;281;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,22;8,0;40;7;1,5;0,35
190;D;-1;CortexAI;1;2;"SELECT 
    ship_state,
    order_date,
    SUM(amount) as daily_amount,
    SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM sales
GROUP BY ship_state, order_date
ORDER BY ship_state, order_date;";8;281;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,22;8,0;40;7;1,5;0,35
191;D;-1;CortexAI;2;2;"SELECT 
    ship_state,
    order_date,
    SUM(amount) as daily_amount,
    SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM sales
GROUP BY ship_state, order_date
ORDER BY ship_state, order_date;";8;281;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,22;8,0;40;7;1,5;0,35
192;D;-1;CortexAI;3;2;"SELECT 
    ship_state,
    order_date,
    SUM(amount) as daily_amount,
    SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_sum
FROM sales
GROUP BY ship_state, order_date
ORDER BY ship_state, order_date;";8;281;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,22;8,0;40;7;1,5;0,35
193;A;-1;CortexAI;0;3;"SELECT 
    customer_id,
    invoice_date,
    DATEDIFF('day', invoice_date, 
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        )
    ) as days_to_next_order
FROM retail
WHERE quantity > 0
ORDER BY days_to_next_order DESC;";12;286;38;14;9;24;14;23;38;171,9;10,89;1871,75;103,99;0;1;0;0;2;2;6,6;3,5;33;8;1,52;0,36
194;A;-1;CortexAI;1;3;"SELECT 
    customer_id,
    invoice_date,
    DATEDIFF('day', invoice_date, 
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        )
    ) as days_to_next_order
FROM retail
WHERE quantity > 0
ORDER BY days_to_next_order DESC;";12;286;38;14;9;24;14;23;38;171,9;10,89;1871,75;103,99;0;1;0;0;2;2;6,6;3,5;33;8;1,52;0,36
195;A;-1;CortexAI;2;3;"SELECT 
    customer_id,
    invoice_date,
    DATEDIFF('day', invoice_date, 
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        )
    ) as days_to_next_order
FROM retail
WHERE quantity > 0
ORDER BY days_to_next_order DESC NULLS LAST;";12;297;40;14;11;24;16;25;40;185,75;10,18;1891,32;105,07;0;1;0;0;2;2;6,78;3,5;33;8;1,52;0,36
196;A;-1;CortexAI;3;3;"SELECT 
    customer_id,
    invoice_date,
    DATEDIFF('day', invoice_date, LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date)) as days_to_next_order
FROM retail
WHERE quantity > 0
ORDER BY days_to_next_order DESC NULLS LAST;";7;248;40;14;11;24;16;25;40;185,75;10,18;1891,32;105,07;0;1;0;0;2;2;6,69;3,5;33;8;1,52;0,36
197;B;-1;CortexAI;0;3;"SELECT 
    genre,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(global_sales) - LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) as sales_difference
FROM games
GROUP BY genre, year
ORDER BY genre, year;";8;228;48;15;6;34;14;21;48;210,83;17,5;3689,55;204,97;0;1;3;0;2;2;8,5;8,0;42;8;1,46;0,33
198;B;-1;CortexAI;1;3;"SELECT 
    genre,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(global_sales) - LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) as sales_diff_prev_year
FROM games
GROUP BY genre, year
ORDER BY genre, year;";8;232;48;15;6;34;14;21;48;210,83;17,5;3689,55;204,97;0;1;3;0;2;2;8,5;8,0;42;8;1,46;0,33
199;B;-1;CortexAI;2;3;"WITH yearly_sales AS (
    SELECT 
        genre,
        year,
        SUM(global_sales) as total_sales
    FROM games
    GROUP BY genre, year
)
SELECT 
    genre,
    year,
    total_sales,
    total_sales - LAG(total_sales) OVER (
        PARTITION BY genre 
        ORDER BY year
    ) as sales_difference
FROM yearly_sales
ORDER BY genre, year;";18;350;55;15;8;35;20;23;55;248,8;18,75;4664,92;259,16;1;1;1;1;2;5;9,54;10,0;54;8;1,51;0,35
200;B;-1;CortexAI;3;3;"SELECT 
    genre,
    year,
    SUM(global_sales) as yearly_sales,
    SUM(global_sales) - LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) as sales_diff
FROM games
GROUP BY genre, year
ORDER BY genre, year;";8;222;48;15;6;34;14;21;48;210,83;17,5;3689,55;204,97;0;1;3;0;2;2;8,48;8,0;42;8;1,46;0,33
201;C;-1;CortexAI;0;3;"SELECT 
    clothing_model,
    DATE_FROM_PARTS(year, month, day) as date,
    price,
    LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) as previous_price,
    price - LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) as price_change
FROM eshop
ORDER BY clothing_model, date;";8;356;71;13;10;46;25;23;71;321,17;16,25;5219,06;289,95;0;2;0;0;2;4;12,03;6,0;61;9;1,54;0,36
202;C;-1;CortexAI;1;3;"SELECT 
    clothing_model,
    DATE_FROM_PARTS(year, month, day) as order_date,
    price,
    LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) as prev_price,
    price - LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) as price_change
FROM eshop
ORDER BY clothing_model, order_date;";8;364;71;13;10;46;25;23;71;321,17;16,25;5219,06;289,95;0;2;0;0;2;4;12,05;6,0;61;9;1,54;0,36
203;C;-1;CortexAI;2;3;"SELECT 
    clothing_model,
    DATE_FROM_PARTS(year, month, day) as sale_date,
    price,
    LAG(price) OVER (
        PARTITION BY clothing_model 
        ORDER BY DATE_FROM_PARTS(year, month, day)
    ) as prev_price,
    price - LAG(price) OVER (
        PARTITION BY clothing_model 
        ORDER BY DATE_FROM_PARTS(year, month, day)
    ) as price_change
FROM eshop
ORDER BY clothing_model, sale_date;";14;408;71;13;10;46;25;23;71;321,17;16,25;5219,06;289,95;0;2;0;0;2;4;12,14;6,0;61;9;1,54;0,36
204;C;-1;CortexAI;3;3;"SELECT 
    clothing_model,
    DATE_FROM_PARTS(year, month, day) as order_date,
    price,
    LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) as prev_price,
    price - LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) as price_change
FROM eshop
ORDER BY clothing_model, order_date;";8;364;71;13;10;46;25;23;71;321,17;16,25;5219,06;289,95;0;2;0;0;2;4;12,05;6,0;61;9;1,54;0,36
205;D;-1;CortexAI;0;3;"SELECT 
    ship_state,
    order_date,
    DATEDIFF('day', order_date, LEAD(order_date) OVER (PARTITION BY ship_state ORDER BY order_date)) as days_diff
FROM sales
WHERE ship_state IS NOT NULL
ORDER BY days_diff DESC;";7;218;39;16;7;26;13;23;39;176,42;14,86;2621,08;145,62;0;1;0;0;2;2;6,87;3,5;34;8;1,5;0,35
206;D;-1;CortexAI;1;3;"SELECT 
    s1.ship_state,
    s1.order_date as current_date,
    s2.order_date as compare_date,
    DATEDIFF('day', s1.order_date, s2.order_date) as days_difference
FROM sales s1
JOIN sales s2 ON s1.ship_state = s2.ship_state
WHERE s2.order_date > s1.order_date
ORDER BY days_difference DESC;";9;293;58;15;11;29;29;26;58;272,63;19,77;5390,55;299,47;0;0;0;0;1;0;9,17;1,0;53;5;2,0;0,51
207;D;-1;CortexAI;2;3;"SELECT 
    s1.ship_state,
    s1.order_date as current_date,
    s2.order_date as compare_date,
    DATEDIFF('day', s1.order_date, s2.order_date) as days_difference
FROM sales s1
JOIN sales s2 ON s1.ship_state = s2.ship_state
WHERE s2.order_date > s1.order_date
ORDER BY days_difference DESC;";9;293;58;15;11;29;29;26;58;272,63;19,77;5390,55;299,47;0;0;0;0;1;0;9,17;1,0;53;5;2,0;0,51
208;D;-1;CortexAI;3;3;"SELECT 
    s1.ship_state,
    s1.order_date as current_date,
    s2.order_date as compare_date,
    DATEDIFF('day', s1.order_date, s2.order_date) as days_difference
FROM sales s1
JOIN sales s2 ON s1.ship_state = s2.ship_state AND s1.order_date < s2.order_date
ORDER BY days_difference DESC;";8;291;58;15;11;29;29;26;58;272,63;19,77;5390,55;299,47;0;0;0;0;1;1;9,31;1,0;53;6;2,0;0,51
209;A;-1;CortexAI;0;4;"SELECT 
    customer_id,
    SUM(quantity * unit_price) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(quantity * unit_price) DESC) as quartile
FROM retail
GROUP BY customer_id
ORDER BY total_amount DESC;";7;206;40;14;8;27;13;22;40;178,38;11,38;2029,04;112,72;0;1;2;0;2;2;6,89;6,5;34;9;1,43;0,32
210;A;-1;CortexAI;1;4;"SELECT 
    customer_id,
    SUM(quantity * unit_price) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(quantity * unit_price) DESC) as quartile
FROM retail
GROUP BY customer_id
ORDER BY total_amount DESC;";7;206;40;14;8;27;13;22;40;178,38;11,38;2029,04;112,72;0;1;2;0;2;2;6,89;6,5;34;9;1,43;0,32
211;A;-1;CortexAI;2;4;"WITH customer_totals AS (
    SELECT 
        customer_id,
        SUM(quantity * unit_price) as total_amount,
        NTILE(4) OVER (ORDER BY SUM(quantity * unit_price)) as quartile
    FROM retail
    GROUP BY customer_id
)
SELECT *
FROM customer_totals
ORDER BY total_amount DESC;";11;283;48;14;10;33;15;24;48;220,08;10,5;2310,82;128,38;1;1;2;1;3;7;8,53;11,5;43;12;1,45;0,33
212;A;-1;CortexAI;3;4;"SELECT 
    customer_id,
    SUM(quantity * unit_price) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(quantity * unit_price) DESC) as quartile
FROM retail
GROUP BY customer_id
ORDER BY total_amount DESC;";7;206;40;14;8;27;13;22;40;178,38;11,38;2029,04;112,72;0;1;2;0;2;2;6,89;6,5;34;9;1,43;0,32
213;B;-1;CortexAI;0;4;"SELECT 
    name,
    year,
    global_sales,
    NTILE(4) OVER (PARTITION BY year ORDER BY global_sales) as quartile
FROM games
ORDER BY year DESC;";7;148;29;12;7;19;10;19;29;123,19;8,57;1055,91;58,66;0;1;0;0;1;2;4,94;3,5;25;7;1,5;0,36
214;B;-1;CortexAI;1;4;"SELECT 
    name,
    year,
    global_sales,
    NTILE(4) OVER (PARTITION BY year ORDER BY global_sales) as sales_quartile
FROM games
ORDER BY year DESC;";7;154;29;12;7;19;10;19;29;123,19;8,57;1055,91;58,66;0;1;0;0;1;2;4,95;3,5;25;7;1,5;0,36
215;B;-1;CortexAI;2;4;"SELECT 
    name,
    year,
    global_sales,
    NTILE(4) OVER (
        PARTITION BY year 
        ORDER BY global_sales
    ) as sales_quartile
FROM games
ORDER BY year DESC;";10;177;29;12;7;19;10;19;29;123,19;8,57;1055,91;58,66;0;1;0;0;1;2;4,99;3,5;25;7;1,5;0,36
216;B;-1;CortexAI;3;4;"SELECT 
    name,
    year,
    global_sales,
    NTILE(4) OVER (PARTITION BY year ORDER BY global_sales) as quartile
FROM games
ORDER BY year DESC;";7;148;29;12;7;19;10;19;29;123,19;8,57;1055,91;58,66;0;1;0;0;1;2;4,94;3,5;25;7;1,5;0,36
217;C;-1;CortexAI;0;4;"SELECT 
    category,
    SUM(amount) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(amount)) as quartile
FROM sales
GROUP BY category
ORDER BY quartile;";7;155;34;13;6;25;9;19;34;144,43;9,75;1408,19;78,23;0;1;2;0;2;2;6,07;6,5;28;8;1,42;0,32
218;C;-1;CortexAI;1;4;"SELECT 
    category,
    SUM(price) as total_revenue,
    NTILE(4) OVER (ORDER BY SUM(price)) as quartile
FROM eshop
GROUP BY category
ORDER BY quartile;";7;154;34;13;6;25;9;19;34;144,43;9,75;1408,19;78,23;0;1;2;0;2;2;6,07;6,5;28;8;1,42;0,32
219;C;-1;CortexAI;2;4;"WITH category_sales AS (
    SELECT 
        category,
        SUM(price) as total_sales
    FROM eshop
    GROUP BY category
)
SELECT 
    category,
    total_sales,
    NTILE(4) OVER (ORDER BY total_sales) as quartile
FROM category_sales
ORDER BY quartile;";13;258;42;13;8;28;14;21;42;184,48;11,38;2098,43;116,58;1;1;1;1;2;5;7,4;10,0;39;8;1,46;0,33
220;C;-1;CortexAI;3;4;"SELECT 
    category,
    SUM(price) as total_revenue,
    NTILE(4) OVER (ORDER BY SUM(price)) as quartile
FROM eshop
GROUP BY category
ORDER BY quartile;";7;154;34;13;6;25;9;19;34;144,43;9,75;1408,19;78,23;0;1;2;0;2;2;6,07;6,5;28;8;1,42;0,32
221;D;-1;CortexAI;0;4;"SELECT 
    ship_state,
    SUM(amount) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(amount) DESC) as quartile
FROM sales
GROUP BY ship_state;";6;146;32;13;7;23;9;20;32;138,3;8,36;1155,81;64,21;0;1;2;0;2;2;5,65;6,5;24;8;1,44;0,33
222;D;-1;CortexAI;1;4;"SELECT 
    ship_state,
    SUM(amount) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(amount) DESC) as quartile
FROM sales
GROUP BY ship_state;";6;146;32;13;7;23;9;20;32;138,3;8,36;1155,81;64,21;0;1;2;0;2;2;5,65;6,5;24;8;1,44;0,33
223;D;-1;CortexAI;2;4;"WITH state_totals AS (
    SELECT 
        ship_state,
        SUM(amount) as total_amount
    FROM sales
    GROUP BY ship_state
)
SELECT 
    ship_state,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) as quartile
FROM state_totals
ORDER BY quartile, total_amount DESC;";13;288;46;13;9;29;17;22;46;205,13;12,28;2518,59;139,92;1;1;1;1;2;5;7,9;10,0;42;8;1,46;0,33
224;D;-1;CortexAI;3;4;"SELECT 
    ship_state,
    SUM(amount) as total_amount,
    NTILE(4) OVER (ORDER BY SUM(amount) DESC) as quartile
FROM sales
GROUP BY ship_state;";6;146;32;13;7;23;9;20;32;138,3;8,36;1155,81;64,21;0;1;2;0;2;2;5,65;6,5;24;8;1,44;0,33
225;A;-1;CortexAI;0;5;"SELECT *
FROM retail r1
WHERE invoice_date = (
    SELECT MIN(invoice_date)
    FROM retail r2
    WHERE r1.customer_id = r2.customer_id
)
ORDER BY customer_id;";8;160;30;12;5;19;11;17;30;122,62;13,2;1618,64;89,92;1;0;1;0;2;3;5,54;5,5;33;9;1,52;0,36
226;A;-1;CortexAI;1;5;"SELECT 
    customer_id,
    invoice_date,
    invoice_no,
    quantity * unit_price as amount
FROM (
    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        ) as rn
    FROM retail
)
WHERE rn = 1
ORDER BY customer_id;";15;284;42;15;9;29;13;24;42;192,57;10,83;2086,16;115,9;1;1;0;0;2;5;7,72;6,5;40;10;1,56;0,38
227;A;-1;CortexAI;2;5;"WITH first_purchases AS (
    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        ) as purchase_order
    FROM retail
)
SELECT *
FROM first_purchases
WHERE purchase_order = 1
ORDER BY customer_id;";12;262;36;15;7;26;10;22;36;160,54;10,71;1720,07;95,56;1;1;0;1;2;5;6,83;8,5;33;10;1,52;0,36
228;A;-1;CortexAI;3;5;"SELECT DISTINCT
    customer_id,
    FIRST_VALUE(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date) as first_purchase_date,
    FIRST_VALUE(invoice_no) OVER (PARTITION BY customer_id ORDER BY invoice_date) as first_invoice_no
FROM retail
ORDER BY customer_id;";6;276;41;12;7;28;13;19;41;174,17;11,14;1940,7;107,82;0;2;0;0;1;4;7,31;6,0;35;7;1,48;0,34
229;B;-1;CortexAI;0;5;"SELECT *
FROM (
    SELECT 
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) as rank
    FROM games
) 
WHERE rank <= 3
ORDER BY publisher, year, rank;";12;246;45;16;7;33;12;23;45;203,56;13,71;2791,68;155,09;1;1;0;0;2;5;8,66;6,5;43;10;1,56;0,37
230;B;-1;CortexAI;1;5;"SELECT *
FROM (
    SELECT 
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) as rank
    FROM games
) 
WHERE rank <= 3
ORDER BY publisher, year, rank;";12;246;45;16;7;33;12;23;45;203,56;13,71;2791,68;155,09;1;1;0;0;2;5;8,66;6,5;43;10;1,56;0,37
231;B;-1;CortexAI;2;5;"WITH ranked_games AS (
    SELECT 
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (
            PARTITION BY publisher, year 
            ORDER BY eu_sales DESC
        ) as rank
    FROM games
)
SELECT *
FROM ranked_games
WHERE rank <= 3
ORDER BY publisher, year, rank;";16;314;49;16;9;34;15;25;49;227,55;13,33;3033,99;168,55;1;1;0;1;2;5;9,24;8,5;48;10;1,57;0,38
232;B;-1;CortexAI;3;5;"SELECT *
FROM (
    SELECT 
        publisher,
        year,
        name,
        eu_sales,
        ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) as rank
    FROM games
) 
WHERE rank <= 3
ORDER BY publisher, year, rank;";12;246;45;16;7;33;12;23;45;203,56;13,71;2791,68;155,09;1;1;0;0;2;5;8,66;6,5;43;10;1,56;0,37
233;C;-1;CortexAI;0;5;"SELECT 
    ship_state,
    product,
    SUM(amount) as total_amount,
    ROW_NUMBER() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) as rank
FROM sales
GROUP BY ship_state, product
QUALIFY rank <= 3
ORDER BY ship_state, rank;";9;236;47;16;8;34;13;24;47;215,49;13,0;2801,41;155,63;0;1;2;0;2;2;8,8;6,5;41;8;1,54;0,37
234;C;-1;CortexAI;1;5;"SELECT 
    country,
    clothing_model,
    SUM(price) as total_revenue,
    ROW_NUMBER() OVER (PARTITION BY country ORDER BY SUM(price) DESC) as rank
FROM eshop
GROUP BY country, clothing_model
QUALIFY rank <= 3
ORDER BY country, rank;";9;237;47;16;8;34;13;24;47;215,49;13,0;2801,41;155,63;0;1;2;0;2;2;8,8;6,5;41;8;1,54;0,37
235;C;-1;CortexAI;2;5;"WITH model_sales AS (
    SELECT 
        country,
        clothing_model,
        SUM(price) as total_sales,
        RANK() OVER (
            PARTITION BY country 
            ORDER BY SUM(price) DESC
        ) as sales_rank
    FROM eshop
    GROUP BY country, clothing_model
)
SELECT *
FROM model_sales
WHERE sales_rank <= 3
ORDER BY country, sales_rank;";16;358;56;17;10;38;18;27;56;266,27;15,3;4073,99;226,33;1;1;2;1;3;7;10,37;11,5;50;11;1,53;0,36
236;C;-1;CortexAI;3;5;"SELECT *
FROM (
    SELECT 
        country,
        clothing_model,
        SUM(price) as total_revenue,
        RANK() OVER (PARTITION BY country ORDER BY SUM(price) DESC) as rank
    FROM eshop
    GROUP BY country, clothing_model
) 
WHERE rank <= 3
ORDER BY country, rank;";12;276;52;17;7;40;12;24;52;238,42;14,57;3474,09;193,01;1;1;2;0;3;7;10,12;9,5;45;11;1,52;0,36
237;D;-1;CortexAI;0;5;"SELECT *
FROM (
    SELECT 
        ship_state,
        product,
        SUM(amount) as total_amount,
        RANK() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) as rank
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
)
WHERE rank <= 5
ORDER BY ship_state, rank;";13;303;57;20;7;44;13;27;57;271,03;18,57;5033,39;279,63;1;1;2;0;3;7;11,21;9,5;51;11;1,52;0,35
238;D;-1;CortexAI;1;5;"SELECT *
FROM (
    SELECT 
        ship_state,
        product,
        SUM(amount) as total_amount,
        RANK() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) as rank
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
) ranked
WHERE rank <= 5
ORDER BY ship_state, rank;";13;310;58;20;8;44;14;28;58;278,83;17,5;4879,47;271,08;1;1;2;0;3;7;11,3;9,5;53;11;1,53;0,36
239;D;-1;CortexAI;2;5;"WITH ranked_products AS (
    SELECT 
        ship_state,
        product,
        SUM(amount) as total_amount,
        RANK() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) as rank
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
)
SELECT *
FROM ranked_products
WHERE rank <= 5
ORDER BY ship_state, rank;";14;343;61;20;9;45;16;29;61;296,34;17,78;5268,21;292,68;1;1;2;1;3;7;11,73;11,5;56;11;1,53;0,36
240;D;-1;CortexAI;3;5;"SELECT *
FROM (
    SELECT 
        ship_state,
        product,
        SUM(amount) as total_amount,
        ROW_NUMBER() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) as rank
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
) 
WHERE rank <= 5
ORDER BY ship_state, rank;";13;310;57;21;7;44;13;28;57;274,02;19,5;5343,37;296,85;1;1;2;0;3;7;11,22;9,5;51;11;1,52;0,35
241;A;-1;CortexAI;0;6;"SELECT *
FROM (
    SELECT 
        country,
        DATE_TRUNC('MONTH', invoice_date) as month,
        customer_id,
        SUM(quantity * unit_price) as monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('MONTH', invoice_date)
            ORDER BY SUM(quantity * unit_price) DESC
        ) as rank
    FROM retail
    GROUP BY country, month, customer_id
) 
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";16;458;78;18;12;54;24;30;78;382,74;18,0;6889,27;382,74;1;1;2;0;3;7;14,09;9,5;69;12;1,58;0,38
242;A;-1;CortexAI;1;6;"SELECT 
    country,
    DATE_TRUNC('MONTH', invoice_date) as month,
    customer_id,
    monthly_amount,
    customer_rank
FROM (
    SELECT 
        country,
        invoice_date,
        customer_id,
        SUM(quantity * unit_price) as monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('MONTH', invoice_date)
            ORDER BY SUM(quantity * unit_price) DESC
        ) as customer_rank
    FROM retail
    GROUP BY country, DATE_TRUNC('MONTH', invoice_date), customer_id
)
WHERE customer_rank <= 5
ORDER BY country, month, customer_rank, customer_id;";21;597;91;17;13;57;34;30;91;446,53;22,23;9926,64;551,48;1;1;2;0;3;7;15,68;9,5;80;12;1,61;0,39
243;A;-1;CortexAI;2;6;"WITH monthly_sales AS (
    SELECT 
        customer_id,
        country,
        DATE_TRUNC('month', invoice_date) as month,
        SUM(quantity * unit_price) as monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('month', invoice_date)
            ORDER BY SUM(quantity * unit_price) DESC
        ) as rank
    FROM retail
    GROUP BY customer_id, country, month
)
SELECT *
FROM monthly_sales
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";17;493;82;18;14;55;27;32;82;410,0;17,36;7116,43;395,36;1;1;2;1;3;7;14,6;11,5;74;12;1,59;0,38
244;A;-1;CortexAI;3;6;"SELECT *
FROM (
    SELECT 
        country,
        DATE_TRUNC('MONTH', invoice_date) as month,
        customer_id,
        SUM(quantity * unit_price) as monthly_amount,
        ROW_NUMBER() OVER (PARTITION BY country, DATE_TRUNC('MONTH', invoice_date) 
                          ORDER BY SUM(quantity * unit_price) DESC) as rank
    FROM retail
    GROUP BY country, month, customer_id
) 
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";14;451;78;18;12;54;24;30;78;382,74;18,0;6889,27;382,74;1;1;2;0;3;7;14,07;9,5;69;12;1,58;0,38
245;B;-1;CortexAI;0;6;"SELECT *
FROM (
    SELECT 
        genre,
        year,
        SUM(na_sales) as total_na_sales,
        ROW_NUMBER() OVER (PARTITION BY genre ORDER BY SUM(na_sales) DESC) as rank
    FROM games
    GROUP BY genre, year
)
WHERE rank <= 3
ORDER BY genre, rank;";12;260;52;18;7;40;12;25;52;241,48;15,43;3725,7;206,98;1;1;2;0;3;7;10,09;9,5;45;11;1,52;0,36
246;B;-1;CortexAI;1;6;"SELECT *
FROM (
    SELECT 
        genre,
        year,
        SUM(na_sales) as total_na_sales,
        ROW_NUMBER() OVER (PARTITION BY genre ORDER BY SUM(na_sales) DESC) as rank
    FROM games
    GROUP BY genre, year
)
WHERE rank <= 3
ORDER BY genre, rank;";12;260;52;18;7;40;12;25;52;241,48;15,43;3725,7;206,98;1;1;2;0;3;7;10,09;9,5;45;11;1,52;0,36
247;B;-1;CortexAI;2;6;"WITH yearly_sales AS (
    SELECT 
        genre,
        year,
        SUM(na_sales) as total_na_sales,
        RANK() OVER (
            PARTITION BY genre 
            ORDER BY SUM(na_sales) DESC
        ) as rank
    FROM games
    GROUP BY genre, year
)
SELECT *
FROM yearly_sales
WHERE rank <= 3
ORDER BY genre, rank;";16;323;56;17;9;41;15;26;56;263,22;14,17;3729,02;207,17;1;1;2;1;3;7;10,66;11,5;50;11;1,53;0,36
248;B;-1;CortexAI;3;6;"SELECT *
FROM (
    SELECT 
        genre,
        year,
        SUM(na_sales) as total_na_sales,
        ROW_NUMBER() OVER (PARTITION BY genre ORDER BY SUM(na_sales) DESC) as rank
    FROM games
    GROUP BY genre, year
)
WHERE rank <= 3
ORDER BY genre, rank;";12;260;52;18;7;40;12;25;52;241,48;15,43;3725,7;206,98;1;1;2;0;3;7;10,09;9,5;45;11;1,52;0,36
249;C;-1;CortexAI;0;6;"SELECT 
    ship_state,
    order_date,
    category,
    SUM(amount) as total_amount,
    DENSE_RANK() OVER (PARTITION BY ship_state, order_date ORDER BY SUM(amount) DESC) as category_rank
FROM sales
GROUP BY ship_state, order_date, category
QUALIFY category_rank <= 3
ORDER BY ship_state, order_date;";10;302;53;15;10;34;19;25;53;246,12;14,25;3507,27;194,85;0;1;2;0;2;2;9,41;6,5;47;8;1,59;0,38
250;C;-1;CortexAI;1;6;"SELECT 
    country,
    DATE_FROM_PARTS(year, month, day) as order_date,
    category,
    SUM(price) as daily_revenue,
    DENSE_RANK() OVER (PARTITION BY country, DATE_FROM_PARTS(year, month, day) ORDER BY SUM(price) DESC) as rank
FROM eshop
GROUP BY country, order_date, category
QUALIFY rank <= 3
ORDER BY country, order_date;";10;331;69;16;13;45;24;29;69;335,2;14,77;4950,66;275,04;0;1;2;0;2;2;12,07;6,5;59;8;1,61;0,39
251;C;-1;CortexAI;2;6;"WITH daily_category_sales AS (
    SELECT 
        DATE_FROM_PARTS(year, month, day) as sale_date,
        country,
        category,
        SUM(price) as total_sales,
        DENSE_RANK() OVER (
            PARTITION BY DATE_FROM_PARTS(year, month, day), country 
            ORDER BY SUM(price) DESC
        ) as sales_rank
    FROM eshop
    GROUP BY sale_date, country, category
)
SELECT *
FROM daily_category_sales
WHERE sales_rank <= 3
ORDER BY country, sale_date;";17;471;78;17;15;50;28;32;78;390,0;15,87;6188,0;343,78;1;1;2;1;3;7;13,79;11,5;68;11;1,6;0,38
252;C;-1;CortexAI;3;6;"SELECT *
FROM (
    SELECT 
        country,
        DATE_FROM_PARTS(year, month, day) as order_date,
        category,
        SUM(price) as daily_revenue,
        DENSE_RANK() OVER (PARTITION BY country, DATE_FROM_PARTS(year, month, day) ORDER BY SUM(price) DESC) as rank
    FROM eshop
    GROUP BY country, order_date, category
)
WHERE rank <= 3
ORDER BY country, order_date;";13;379;74;18;12;51;23;30;74;363,11;17,25;6263,65;347,98;1;1;2;0;3;7;13,41;9,5;63;11;1,59;0,38
253;D;-1;CortexAI;0;6;"WITH daily_rankings AS (
    SELECT 
        order_date,
        ship_state,
        SUM(amount) as total_amount,
        DENSE_RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) as rank
    FROM sales
    GROUP BY order_date, ship_state
)
SELECT *
FROM daily_rankings
WHERE rank <= 3
ORDER BY order_date;";13;318;54;18;9;39;15;27;54;256,76;15,0;3851,46;213,97;1;1;2;1;3;7;10,25;11,5;47;11;1,53;0,36
254;D;-1;CortexAI;1;6;"SELECT *
FROM (
    SELECT 
        order_date,
        ship_state,
        SUM(amount) as total_amount,
        DENSE_RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) as rank
    FROM sales
    GROUP BY order_date, ship_state
) ranked
WHERE rank <= 3
ORDER BY order_date;";12;287;51;18;8;38;13;26;51;239,72;14,62;3505,94;194,77;1;1;2;0;3;7;9,82;9,5;44;11;1,54;0,36
255;D;-1;CortexAI;2;6;"WITH daily_state_ranks AS (
    SELECT 
        order_date,
        ship_state,
        SUM(amount) as total_amount,
        DENSE_RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) as rank
    FROM sales
    GROUP BY order_date, ship_state
)
SELECT *
FROM daily_state_ranks
WHERE rank <= 3
ORDER BY order_date, rank;";13;330;56;18;9;41;15;27;56;266,27;15,0;3994,11;221,89;1;1;2;1;3;7;10,67;11,5;50;11;1,53;0,36
256;D;-1;CortexAI;3;6;"SELECT *
FROM (
    SELECT 
        order_date,
        ship_state,
        SUM(amount) as total_amount,
        DENSE_RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) as rank
    FROM sales
    GROUP BY order_date, ship_state
)
WHERE rank <= 3
ORDER BY order_date;";12;280;50;18;7;38;12;25;50;232,19;15,43;3582,4;199,02;1;1;2;0;3;7;9,73;9,5;42;11;1,52;0,36
257;A;-1;CortexAI;0;7;"CREATE OR REPLACE TABLE cities_pop (
    data VARIANT
);

COPY INTO cities_pop 
FROM '@my_stage/cities_population.json'
FILE_FORMAT = (TYPE = 'JSON');";7;150;23;9;9;13;10;18;23;95,91;5,0;479,54;26,64;0;0;0;0;1;1;4,11;1,0;7;4;1,5;0,43
258;A;-1;CortexAI;1;7;"CREATE TABLE cities_pop (
    data VARIANT
);

COPY INTO cities_pop 
FROM '@my_stage/cities_population.json'
FILE_FORMAT = (TYPE = 'JSON');";7;139;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,66;1,0;7;4;1,5;0,43
259;A;-1;CortexAI;2;7;"CREATE TABLE cities_pop (
    data VARIANT
);

COPY INTO cities_pop 
FROM '@my_stage/cities_population.json'
FILE_FORMAT = (TYPE = 'JSON');";7;139;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,66;1,0;7;4;1,5;0,43
260;A;-1;CortexAI;3;7;"CREATE TABLE cities_pop (
    data VARIANT
);

COPY INTO cities_pop 
FROM '@my_stage/cities_population.json'
FILE_FORMAT = (TYPE = 'JSON');";7;139;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,66;1,0;7;4;1,5;0,43
261;B;-1;CortexAI;0;7;"CREATE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
FROM '@my_stage/house_price.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;137;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,65;1,0;7;4;1,5;0,43
262;B;-1;CortexAI;1;7;"CREATE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
FROM '@my_stage/house_price.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;137;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,65;1,0;7;4;1,5;0,43
263;B;-1;CortexAI;2;7;"CREATE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
FROM '@my_stage/house_price.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;137;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,65;1,0;7;4;1,5;0,43
264;B;-1;CortexAI;3;7;"CREATE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
FROM '@my_stage/house_price.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;137;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,65;1,0;7;4;1,5;0,43
265;C;-1;CortexAI;0;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

COPY INTO forbes 
FROM '@my_stage/forbes.json'
FILE_FORMAT = (TYPE = 'JSON');";7;131;23;9;9;13;10;18;23;95,91;5,0;479,54;26,64;0;0;0;0;1;1;4,07;1,0;7;4;1,5;0,43
266;C;-1;CortexAI;1;7;"CREATE TABLE forbes (
    data VARIANT
);

COPY INTO forbes 
FROM '@my_stage/forbes.json'
FILE_FORMAT = (TYPE = 'JSON');";7;120;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,62;1,0;7;4;1,5;0,43
267;C;-1;CortexAI;2;7;"CREATE TABLE forbes (
    data VARIANT
);

COPY INTO forbes 
FROM '@my_stage/forbes.json'
FILE_FORMAT = (TYPE = 'JSON');";7;120;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,62;1,0;7;4;1,5;0,43
268;C;-1;CortexAI;3;7;"CREATE TABLE forbes (
    data VARIANT
);

COPY INTO forbes 
FROM '@my_stage/forbes.json'
FILE_FORMAT = (TYPE = 'JSON');";7;120;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,62;1,0;7;4;1,5;0,43
269;D;-1;CortexAI;0;7;"CREATE TABLE weather (
    data VARIANT
);

COPY INTO weather
FROM '@my_stage/weather.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;125;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,63;1,0;7;4;1,5;0,43
270;D;-1;CortexAI;1;7;"CREATE TABLE weather (
    data VARIANT
);

COPY INTO weather
FROM '@my_stage/weather.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;125;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,63;1,0;7;4;1,5;0,43
271;D;-1;CortexAI;2;7;"CREATE TABLE weather (
    data VARIANT
);

COPY INTO weather
FROM '@my_stage/weather.json'
FILE_FORMAT = (TYPE = 'PARQUET');";7;125;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,63;1,0;7;4;1,5;0,43
272;D;-1;CortexAI;3;7;"CREATE TABLE weather (data VARIANT);

COPY INTO weather FROM '@my_stage/weather.json'
FILE_FORMAT = (TYPE = 'PARQUET');";4;119;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,62;1,0;7;4;1,5;0,43
273;A;-1;CortexAI;0;8;"SELECT 
    data:city::STRING as city,
    data:rank::INTEGER as rank
FROM cities_pop,
LATERAL FLATTEN(input => data:data)
WHERE data:country::STRING = 'India'
ORDER BY rank;";7;174;33;13;13;17;16;26;33;155,11;8,0;1240,92;68,94;0;0;0;0;1;0;4,96;1,0;58;8;1,9;0,48
274;A;-1;CortexAI;1;8;"SELECT 
    data:city::STRING as city,
    data:rank::INTEGER as rank
FROM cities_pop,
LATERAL FLATTEN(input => data:data)
WHERE data:country::STRING = 'India'
ORDER BY rank;";7;174;33;13;13;17;16;26;33;155,11;8,0;1240,92;68,94;0;0;0;0;1;0;4,96;1,0;58;8;1,9;0,48
275;A;-1;CortexAI;2;8;"SELECT 
    data:city::STRING as city,
    data:rank::INTEGER as rank
FROM cities_pop,
LATERAL FLATTEN(input => data:data)
WHERE data:country::STRING = 'India'
ORDER BY rank;";7;174;33;13;13;17;16;26;33;155,11;8,0;1240,92;68,94;0;0;0;0;1;0;4,96;1,0;58;8;1,9;0,48
276;A;-1;CortexAI;3;8;"SELECT 
    data:city::STRING as city,
    data:rank::INTEGER as rank
FROM cities_pop
WHERE data:country::STRING = 'India'
ORDER BY rank;";6;137;24;10;9;12;12;19;24;101,95;6,67;679,67;37,76;0;0;0;0;0;0;3,34;1,0;39;7;1,73;0,44
277;B;-1;CortexAI;0;8;"SELECT 
    AVG(data:price::FLOAT) as avg_price,
    MEDIAN(data:price::FLOAT) as median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;141;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,15;4,0;36;7;1,67;0,42
278;B;-1;CortexAI;1;8;"SELECT 
    AVG(data:price::FLOAT) as avg_price,
    MEDIAN(data:price::FLOAT) as median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;141;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,15;4,0;36;7;1,67;0,42
279;B;-1;CortexAI;2;8;"SELECT 
    AVG(data:price::FLOAT) as avg_price,
    MEDIAN(data:price::FLOAT) as median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;141;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,15;4,0;36;7;1,67;0,42
280;B;-1;CortexAI;3;8;"SELECT 
    AVG(data:price::FLOAT) as avg_price,
    MEDIAN(data:price::FLOAT) as median_price
FROM house_price
WHERE data:price IS NOT NULL;";5;141;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,15;4,0;36;7;1,67;0,42
281;C;-1;CortexAI;0;8;"SELECT *
FROM forbes
WHERE LOWER(country) = 'united states'
ORDER BY current_worth DESC;";4;88;16;10;6;10;6;16;16;64,0;5,0;320,0;17,78;0;0;0;0;1;0;2,85;1,0;15;6;1,4;0,33
282;C;-1;CortexAI;1;8;"SELECT 
    data:name::STRING as name,
    data:current_worth::NUMBER as worth,
    data:country::STRING as country
FROM forbes
WHERE data:country::STRING = 'United States'
ORDER BY worth DESC;";7;193;31;9;12;12;19;21;31;136,16;7,12;970,15;53,9;0;0;0;0;0;0;3,86;1,0;53;7;1,73;0,43
283;C;-1;CortexAI;2;8;"SELECT 
    data:name::STRING as name,
    data:current_worth::NUMBER as current_worth,
    data:country::STRING as country
FROM forbes
WHERE data:country::STRING = 'United States'
ORDER BY data:current_worth::NUMBER DESC;";7;222;33;9;12;12;21;21;33;144,95;7,88;1141,45;63,41;0;0;0;0;0;0;3,91;1,0;63;7;1,72;0,43
284;C;-1;CortexAI;3;8;"SELECT 
    data:name::STRING as name,
    data:current_worth::NUMBER as worth,
    data:country::STRING as country
FROM forbes
WHERE data:country::STRING = 'United States'
ORDER BY worth DESC;";7;193;31;9;12;12;19;21;31;136,16;7,12;970,15;53,9;0;0;0;0;0;0;3,86;1,0;53;7;1,73;0,43
285;D;-1;CortexAI;0;8;"SELECT 
    AVG(CAST(data:MaxTemp AS FLOAT)) as avg_max_temp,
    MEDIAN(CAST(data:MaxTemp AS FLOAT)) as median_max_temp,
    AVG(CAST(data:MinTemp AS FLOAT)) as avg_min_temp,
    MEDIAN(CAST(data:MinTemp AS FLOAT)) as median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL 
AND data:MinTemp IS NOT NULL;";8;309;61;14;9;42;19;23;61;275,94;14,78;4077,74;226,54;0;0;4;0;2;1;10,63;7,0;68;8;1,72;0,43
286;D;-1;CortexAI;1;8;"SELECT 
    AVG(CAST(data:MaxTemp::FLOAT as FLOAT)) as avg_max_temp,
    MEDIAN(CAST(data:MaxTemp::FLOAT as FLOAT)) as median_max_temp,
    AVG(CAST(data:MinTemp::FLOAT as FLOAT)) as avg_min_temp,
    MEDIAN(CAST(data:MinTemp::FLOAT as FLOAT)) as median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL 
AND data:MinTemp IS NOT NULL;";8;337;69;14;10;42;27;24;69;316,36;18,9;5979,25;332,18;0;0;4;0;2;1;11,0;7,0;76;8;1,74;0,43
287;D;-1;CortexAI;2;8;"SELECT 
    AVG(CAST(data:MaxTemp::FLOAT as FLOAT)) as avg_max_temp,
    MEDIAN(CAST(data:MaxTemp::FLOAT as FLOAT)) as median_max_temp,
    AVG(CAST(data:MinTemp::FLOAT as FLOAT)) as avg_min_temp,
    MEDIAN(CAST(data:MinTemp::FLOAT as FLOAT)) as median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL 
AND data:MinTemp IS NOT NULL;";8;337;69;14;10;42;27;24;69;316,36;18,9;5979,25;332,18;0;0;4;0;2;1;11,0;7,0;76;8;1,74;0,43
288;D;-1;CortexAI;3;8;"SELECT 
    AVG(CAST(data:MaxTemp::FLOAT as FLOAT)) as avg_max_temp,
    MEDIAN(CAST(data:MaxTemp::FLOAT as FLOAT)) as median_max_temp,
    AVG(CAST(data:MinTemp::FLOAT as FLOAT)) as avg_min_temp,
    MEDIAN(CAST(data:MinTemp::FLOAT as FLOAT)) as median_min_temp
FROM weather
WHERE data:MaxTemp IS NOT NULL AND data:MinTemp IS NOT NULL;";7;336;69;14;10;42;27;24;69;316,36;18,9;5979,25;332,18;0;0;4;0;2;1;11,0;7,0;76;8;1,74;0,43
289;A;-1;CortexAI;0;9;"SELECT 
    data:country::STRING as country,
    COUNT(*) as city_count
FROM cities_pop,
LATERAL FLATTEN(input => data:data)
GROUP BY country
ORDER BY city_count;";7;162;31;14;10;19;12;24;31;142,13;8,4;1193,92;66,33;0;0;1;0;1;0;5,26;2,5;44;8;1,87;0,48
290;A;-1;CortexAI;1;9;"SELECT 
    data:country::STRING as country,
    COUNT(*) as city_count
FROM cities_pop,
LATERAL FLATTEN(input => data:data)
GROUP BY country
ORDER BY city_count;";7;162;31;14;10;19;12;24;31;142,13;8,4;1193,92;66,33;0;0;1;0;1;0;5,26;2,5;44;8;1,87;0,48
291;A;-1;CortexAI;2;9;"SELECT 
    data:country::STRING as country,
    COUNT(*) as city_count
FROM cities_pop,
LATERAL FLATTEN(input => data:data)
GROUP BY country
ORDER BY city_count;";7;162;31;14;10;19;12;24;31;142,13;8,4;1193,92;66,33;0;0;1;0;1;0;5,26;2,5;44;8;1,87;0,48
292;A;-1;CortexAI;3;9;"SELECT 
    data:country::STRING as country,
    COUNT(*) as city_count
FROM cities_pop
GROUP BY country
ORDER BY city_count;";6;125;22;12;6;14;8;18;22;91,74;8,0;733,91;40,77;0;0;1;0;1;0;3,65;2,5;25;6;1,6;0,4
293;B;-1;CortexAI;0;9;"SELECT 
    data:furnishing_status::STRING as furnishing_status,
    COUNT(*) as count,
    AVG(data:price::FLOAT) as avg_price
FROM house_price
GROUP BY data:furnishing_status;";6;177;28;12;8;18;10;20;28;121,01;7,5;907,6;50,42;0;0;2;0;1;0;4,47;4,0;36;7;1,75;0,44
294;B;-1;CortexAI;1;9;"SELECT 
    data:furnishing_status::STRING as furnishing_status,
    COUNT(*) as count_houses,
    AVG(data:price::FLOAT) as avg_price
FROM house_price
GROUP BY data:furnishing_status;";6;184;28;12;9;17;11;21;28;122,98;7,33;901,89;50,1;0;0;2;0;1;0;4,37;4,0;36;7;1,75;0,44
295;B;-1;CortexAI;2;9;"SELECT 
    data:furnishing_status::STRING as furnishing_status,
    COUNT(*) as count_houses,
    AVG(data:price::FLOAT) as avg_price
FROM house_price
GROUP BY data:furnishing_status;";6;184;28;12;9;17;11;21;28;122,98;7,33;901,89;50,1;0;0;2;0;1;0;4,37;4,0;36;7;1,75;0,44
296;B;-1;CortexAI;3;9;"SELECT 
    data:furnishing_status::STRING as furnishing_status,
    COUNT(*) as count,
    AVG(data:price::FLOAT) as avg_price
FROM house_price
GROUP BY data:furnishing_status;";6;177;28;12;8;18;10;20;28;121,01;7,5;907,6;50,42;0;0;2;0;1;0;4,47;4,0;36;7;1,75;0,44
297;C;-1;CortexAI;0;9;"SELECT 
    name:data::STRING as name,
    current_worth:data::NUMBER as worth,
    ARRAY_SIZE(industries:data) as industry_count
FROM forbes
ORDER BY worth DESC;";6;162;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,56;1,0;41;6;1,67;0,41
298;C;-1;CortexAI;1;9;"SELECT 
    data:name::STRING as name,
    data:current_worth::NUMBER as worth,
    ARRAY_SIZE(data:industries) as industry_count
FROM forbes
ORDER BY worth DESC;";6;162;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,56;1,0;41;6;1,67;0,41
299;C;-1;CortexAI;2;9;"SELECT 
    data:name::STRING as name,
    data:current_worth::NUMBER as current_worth,
    ARRAY_SIZE(data:industries) as industry_count
FROM forbes
ORDER BY data:current_worth::NUMBER DESC;";6;191;28;9;12;12;16;21;28;122,98;6,0;737,91;40,99;0;0;0;0;1;0;3,62;1,0;51;7;1,67;0,41
300;C;-1;CortexAI;3;9;"SELECT 
    data:name::STRING as name,
    data:current_worth::NUMBER as worth,
    ARRAY_SIZE(data:industries) as industry_count
FROM forbes
ORDER BY worth DESC;";6;162;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,56;1,0;41;6;1,67;0,41
301;D;-1;CortexAI;0;9;"SELECT 
    data:WindGustDir::STRING as wind_direction,
    AVG(CAST(data:Rainfall AS FLOAT)) as avg_rainfall
FROM weather
WHERE data:WindGustDir IS NOT NULL
GROUP BY wind_direction
ORDER BY avg_rainfall;";7;204;32;15;9;20;12;24;32;146,72;10,0;1467,19;81,51;0;0;1;0;2;0;5,32;2,5;42;7;1,64;0,4
302;D;-1;CortexAI;1;9;"SELECT 
    data:WindGustDir::STRING as wind_direction,
    AVG(CAST(data:Rainfall::FLOAT as FLOAT)) as avg_rainfall
FROM weather
WHERE data:WindGustDir IS NOT NULL
GROUP BY data:WindGustDir
ORDER BY avg_rainfall;";7;213;34;15;9;20;14;24;34;155,89;11,67;1818,7;101,04;0;0;1;0;2;0;5,34;2,5;48;8;1,68;0,42
303;D;-1;CortexAI;2;9;"SELECT 
    data:WindGustDir::STRING as wind_direction,
    AVG(CAST(data:Rainfall::FLOAT as FLOAT)) as avg_rainfall
FROM weather
WHERE data:WindGustDir IS NOT NULL
AND data:Rainfall IS NOT NULL
GROUP BY wind_direction
ORDER BY avg_rainfall;";8;241;39;16;9;24;15;25;39;181,11;13,33;2414,81;134,16;0;0;1;0;2;1;6,57;2,5;54;8;1,66;0,41
304;D;-1;CortexAI;3;9;"SELECT 
    data:WindGustDir::STRING as wind_direction,
    AVG(CAST(data:Rainfall::FLOAT as FLOAT)) as avg_rainfall
FROM weather
WHERE data:WindGustDir IS NOT NULL
GROUP BY data:WindGustDir
ORDER BY avg_rainfall;";7;213;34;15;9;20;14;24;34;155,89;11,67;1818,7;101,04;0;0;1;0;2;0;5,34;2,5;48;8;1,68;0,42
305;A;-1;CortexAI;0;10;"SELECT 
    data:city::STRING as city,
    SUM(f.value:area_km2::FLOAT) as total_area
FROM cities_pop,
LATERAL FLATTEN(input => data:data) d,
LATERAL FLATTEN(input => d.value:districts) f
GROUP BY city
ORDER BY total_area DESC;";8;227;49;14;16;25;24;30;49;240,44;10,5;2524,6;140,26;0;0;1;0;1;0;7,61;2,5;72;8;2,03;0,51
306;A;-1;CortexAI;1;10;"SELECT 
    data:city::STRING as city,
    SUM(districts.value:area_km2::FLOAT) as total_area
FROM cities_pop,
LATERAL FLATTEN(input => data:data) cities,
LATERAL FLATTEN(input => cities.value:districts) districts
GROUP BY city
ORDER BY total_area DESC;";8;253;49;14;16;25;24;30;49;240,44;10,5;2524,6;140,26;0;0;1;0;1;0;7,67;2,5;72;8;2,03;0,51
307;A;-1;CortexAI;2;10;"SELECT 
    data:city::STRING as city,
    SUM(d.value:area_km2::FLOAT) as total_area
FROM cities_pop,
LATERAL FLATTEN(input => data:data) cities,
LATERAL FLATTEN(input => cities.value:districts) d
GROUP BY city
ORDER BY total_area DESC;";8;237;49;14;16;25;24;30;49;240,44;10,5;2524,6;140,26;0;0;1;0;1;0;7,63;2,5;72;8;2,03;0,51
308;A;-1;CortexAI;3;10;"SELECT 
    data:city::STRING as city,
    SUM(f.value:area_km2::FLOAT) as total_area
FROM cities_pop,
LATERAL FLATTEN(input => data:districts) f
GROUP BY city
ORDER BY total_area DESC;";7;185;37;14;14;19;18;28;37;177,87;9,0;1600,85;88,94;0;0;1;0;1;0;5,63;2,5;52;8;1,89;0,48
309;B;-1;CortexAI;0;10;"SELECT *
FROM (
    SELECT 
        data:furnishing_status::STRING as furnishing_status,
        data:price::FLOAT as price,
        ROW_NUMBER() OVER (PARTITION BY data:furnishing_status ORDER BY data:price::FLOAT DESC) as rank
    FROM house_price
    WHERE data:price IS NOT NULL
)
WHERE rank <= 3
ORDER BY furnishing_status, price DESC;";11;340;53;19;10;34;19;29;53;257,47;18,05;4647,39;258,19;1;1;0;0;2;5;9,12;6,5;70;12;1,68;0,41
310;B;-1;CortexAI;1;10;"SELECT 
    data:furnishing_status::STRING as furnishing_status,
    data:price::FLOAT as price
FROM (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY data:furnishing_status ORDER BY data:price::FLOAT DESC) as rank
    FROM house_price
)
WHERE rank <= 3
ORDER BY data:furnishing_status, price DESC;";10;304;48;16;10;30;18;26;48;225,62;14,4;3248,94;180,5;1;1;0;0;2;5;8,02;6,5;64;12;1,7;0,42
311;B;-1;CortexAI;2;10;"WITH ranked_houses AS (
    SELECT 
        data:furnishing_status::STRING as furnishing_status,
        data:price::FLOAT as price,
        ROW_NUMBER() OVER (
            PARTITION BY data:furnishing_status 
            ORDER BY data:price::FLOAT DESC
        ) as rank
    FROM house_price
    WHERE data:price IS NOT NULL
)
SELECT *
FROM ranked_houses
WHERE rank <= 3
ORDER BY furnishing_status, price DESC;";15;411;57;19;12;35;22;31;57;282,39;17,42;4918,28;273,24;1;1;0;1;2;5;9,7;8,5;75;12;1,68;0,41
312;B;-1;CortexAI;3;10;"SELECT *
FROM (
    SELECT 
        data:furnishing_status::STRING as furnishing_status,
        data:price::FLOAT as price,
        ROW_NUMBER() OVER (PARTITION BY data:furnishing_status ORDER BY data:price::FLOAT DESC) as rank
    FROM house_price
    WHERE data:price IS NOT NULL
)
WHERE rank <= 3
ORDER BY furnishing_status, price DESC;";11;340;53;19;10;34;19;29;53;257,47;18,05;4647,39;258,19;1;1;0;0;2;5;9,12;6,5;70;12;1,68;0,41
313;C;-1;CortexAI;0;10;"SELECT 
    value:data:industry::STRING as industry,
    COUNT(*) as billionaire_count
FROM forbes,
LATERAL FLATTEN(input => forbes.data)
GROUP BY industry
ORDER BY billionaire_count DESC;";7;188;34;15;11;20;14;26;34;159,81;9,55;1525,51;84,75;0;0;1;0;1;0;5,76;2,5;42;7;1,95;0,5
314;C;-1;CortexAI;1;10;"SELECT 
    value::STRING as industry,
    COUNT(*) as billionaire_count
FROM forbes,
LATERAL FLATTEN(input => data:industries)
GROUP BY industry
ORDER BY billionaire_count DESC;";7;178;32;14;11;19;13;25;32;148,6;8,27;1229,36;68,3;0;0;1;0;1;0;5,46;2,5;40;8;1,86;0,47
315;C;-1;CortexAI;2;10;"SELECT 
    f.industry,
    COUNT(*) as billionaire_count
FROM forbes,
LATERAL FLATTEN(input => data:industries) f
GROUP BY f.industry
ORDER BY billionaire_count DESC;";7;167;33;15;9;20;13;24;33;151,3;10,83;1639,12;91,06;0;0;1;0;1;0;5,71;2,5;38;8;1,95;0,5
316;C;-1;CortexAI;3;10;"SELECT 
    f.industry,
    COUNT(*) as billionaire_count
FROM forbes,
LATERAL FLATTEN(input => data:industries) f
GROUP BY f.industry
ORDER BY billionaire_count DESC;";7;167;33;15;9;20;13;24;33;151,3;10,83;1639,12;91,06;0;0;1;0;1;0;5,71;2,5;38;8;1,95;0,5
317;D;-1;CortexAI;0;10;"WITH ranked_temps AS (
    SELECT 
        data:WindGustDir::STRING as wind_direction,
        data:Temp3pm::FLOAT as temp_3pm,
        RANK() OVER (PARTITION BY data:WindGustDir ORDER BY data:Temp3pm DESC) as rank
    FROM weather
    WHERE data:WindGustDir IS NOT NULL
    AND data:Temp3pm IS NOT NULL
)
SELECT *
FROM ranked_temps
WHERE rank <= 3
ORDER BY wind_direction, rank;";13;379;59;19;12;40;19;31;59;292,3;15,04;4396,64;244,26;1;1;0;1;2;6;10,7;8,5;83;11;1,67;0,41
318;D;-1;CortexAI;1;10;"SELECT *
FROM (
    SELECT 
        data:WindGustDir::STRING as wind_direction,
        data:Temp3pm::FLOAT as afternoon_temp,
        RANK() OVER (PARTITION BY data:WindGustDir ORDER BY data:Temp3pm DESC) as temp_rank
    FROM weather
    WHERE data:WindGustDir IS NOT NULL 
    AND data:Temp3pm IS NOT NULL
) ranked
WHERE temp_rank <= 3
ORDER BY wind_direction, temp_rank;";12;374;56;19;12;36;20;31;56;277,43;15,83;4392,72;244,04;1;1;0;0;2;6;9,97;6,5;80;11;1,68;0,41
319;D;-1;CortexAI;2;10;"WITH ranked_temps AS (
    SELECT 
        data:WindGustDir::STRING as wind_direction,
        data:Temp3pm::FLOAT as afternoon_temp,
        RANK() OVER (PARTITION BY data:WindGustDir ORDER BY data:Temp3pm DESC) as temp_rank
    FROM weather
    WHERE data:WindGustDir IS NOT NULL
    AND data:Temp3pm IS NOT NULL
)
SELECT *
FROM ranked_temps
WHERE temp_rank <= 3
ORDER BY wind_direction, temp_rank;";13;400;59;19;13;37;22;32;59;295,0;16,08;4742,69;263,48;1;1;0;1;2;6;10,38;8,5;83;11;1,67;0,41
320;D;-1;CortexAI;3;10;"SELECT *
FROM (
    SELECT 
        data:WindGustDir::STRING as wind_direction,
        data:Temp3pm::FLOAT as afternoon_temp,
        ROW_NUMBER() OVER (PARTITION BY data:WindGustDir ORDER BY data:Temp3pm DESC) as rn
    FROM weather
    WHERE data:WindGustDir IS NOT NULL AND data:Temp3pm IS NOT NULL
)
WHERE rn <= 3
ORDER BY wind_direction;";11;343;53;19;11;35;18;30;53;260,07;15,55;4042,83;224,6;1;1;0;0;2;6;9,55;6,5;75;11;1,68;0,41
321;A;-1;Claude_4.5_Sonnet;0;1;"CREATE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL(10,2),
    customer_id INTEGER,
    country TEXT
);


COPY retail(invoice_no, stock_code, description, quantity, invoice_date, unit_price, customer_id, country)
FROM '/path/to/online_retail.csv'
DELIMITER ';'
CSV HEADER
ON_ERROR CONTINUE;";17;400;62;7;23;26;36;30;62;304,23;5,48;1666,64;92,59;0;0;0;0;2;0;8,68;1,0;32;6;2,21;0,56
322;A;-1;Claude_4.5_Sonnet;1;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL(10,2),
    customer_id INTEGER,
    country TEXT
);

COPY INTO retail
FROM @your_stage/online_retail.csv
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ';' SKIP_HEADER = 1)
ON_ERROR = 'CONTINUE';";15;367;62;12;29;28;34;41;62;332,17;7,03;2336,63;129,81;0;0;0;0;2;1;9,51;1,0;32;6;2,21;0,56
323;A;-1;Claude_4.5_Sonnet;2;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INTEGER,
    stock_code TEXT,
    description TEXT,
    quantity INTEGER,
    invoice_date TIMESTAMP,
    unit_price DECIMAL(10,2),
    customer_id INTEGER,
    country TEXT
);

COPY INTO retail
FROM @your_stage/online_retail.csv
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ';' SKIP_HEADER = 1)
ON_ERROR = 'CONTINUE';";15;367;62;12;29;28;34;41;62;332,17;7,03;2336,63;129,81;0;0;0;0;2;1;9,51;1,0;32;6;2,21;0,56
324;A;-1;Claude_4.5_Sonnet;3;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date TIMESTAMP,
    unit_price DECIMAL(10, 2),
    customer_id INT,
    country STRING
);
COPY INTO retail
FROM @your_stage/online_retail.csv 
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ';' HEADER = TRUE)
ON_ERROR = 'CONTINUE';";14;360;62;13;28;29;33;41;62;332,17;7,66;2544,65;141,37;0;0;0;0;2;1;9,7;1,0;32;6;2,21;0,56
325;B;-1;Claude_4.5_Sonnet;0;1;"CREATE OR REPLACE TABLE games (
    id INT,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales DECIMAL(10, 2),
    eu_sales DECIMAL(10, 2),
    jp_sales DECIMAL(10, 2),
    other_sales DECIMAL(10, 2),
    global_sales DECIMAL(10, 2)
);
COPY INTO games
FROM @your_stage/video_game_sales.csv 
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ',' HEADER = TRUE)
ON_ERROR = 'CONTINUE';";17;432;91;13;30;44;47;43;91;493,79;10,18;5028,43;279,36;0;0;0;0;2;1;13,32;1,0;57;6;1,93;0,49
326;B;-1;Claude_4.5_Sonnet;1;1;"CREATE OR REPLACE TABLE games (
    id INT,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales DECIMAL(10, 2),
    eu_sales DECIMAL(10, 2),
    jp_sales DECIMAL(10, 2),
    other_sales DECIMAL(10, 2),
    global_sales DECIMAL(10, 2)
);

COPY INTO games
FROM @your_stage/video_game_sales.csv 
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ',' HEADER = TRUE)
ON_ERROR = 'CONTINUE';";18;433;91;13;30;44;47;43;91;493,79;10,18;5028,43;279,36;0;0;0;0;2;1;13,33;1,0;57;6;1,93;0,49
327;B;-1;Claude_4.5_Sonnet;2;1;"CREATE OR REPLACE TABLE games (
    id INTEGER,
    name STRING,
    platform STRING,
    year INTEGER,
    genre STRING,
    publisher STRING,
    na_sales FLOAT,
    eu_sales FLOAT,
    jp_sales FLOAT,
    other_sales FLOAT,
    global_sales FLOAT
);

COPY INTO games
FROM @~/video_game_sales.csv
FILE_FORMAT = (
    TYPE = CSV
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1
    ERROR_ON_COLUMN_COUNT_MISMATCH = FALSE
)
ON_ERROR = 'CONTINUE';";23;443;69;13;29;30;39;42;69;372,07;8,74;3252,4;180,69;0;0;0;0;1;1;10,86;1,0;37;4;2,57;0,62
328;B;-1;Claude_4.5_Sonnet;3;1;"CREATE OR REPLACE TABLE games(id INT,name STRING,platform STRING,year INT,genre STRING,publisher STRING,na_sales FLOAT,eu_sales FLOAT,jp_sales FLOAT,other_sales FLOAT,global_sales FLOAT);
COPY INTO games FROM @~/video_game_sales.csv FILE_FORMAT=(TYPE=CSV FIELD_DELIMITER=',' SKIP_HEADER=1 ERROR_ON_COLUMN_COUNT_MISMATCH=FALSE) ON_ERROR='CONTINUE';";2;347;69;13;29;30;39;42;69;372,07;8,74;3252,4;180,69;0;0;0;0;1;1;10,66;1,0;37;4;2,57;0,62
329;C;-1;Claude_4.5_Sonnet;0;1;"CREATE OR REPLACE TABLE eshop ( year INTEGER, month INTEGER, day INTEGER, order_no INTEGER, country STRING, session_id INTEGER, category STRING, clothing_model STRING, colour STRING, location STRING, model INTEGER, price INTEGER, page STRING ); COPY INTO eshop FROM @my_stage/eshop_clothing.csv FILE_FORMAT = ( TYPE = 'CSV' FIELD_DELIMITER = ';' SKIP_HEADER = 1 ) ON_ERROR = 'CONTINUE';";1;386;72;12;30;30;42;42;72;388,25;8,4;3261,27;181,18;0;0;0;0;1;1;10,75;1,0;43;4;2,62;0,63
330;C;-1;Claude_4.5_Sonnet;1;1;"CREATE OR REPLACE TABLE eshop (
    year INTEGER,
    month INTEGER,
    day INTEGER,
    order_no INTEGER,
    country STRING,
    session_id INTEGER,
    category STRING,
    clothing_model STRING,
    colour STRING,
    location STRING,
    model INTEGER,
    price INTEGER,
    page STRING
);

COPY INTO eshop
FROM @~/eshop_clothing.csv
FILE_FORMAT = (
    TYPE = 'CSV'
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";24;444;72;12;30;30;42;42;72;388,25;8,4;3261,27;181,18;0;0;0;0;1;1;10,87;1,0;43;4;2,62;0,63
331;C;-1;Claude_4.5_Sonnet;2;1;"CREATE OR REPLACE TABLE eshop (
    year INTEGER,
    month INTEGER,
    day INTEGER,
    order_no INTEGER,
    country STRING,
    session_id INTEGER,
    category STRING,
    clothing_model STRING,
    colour STRING,
    location STRING,
    model INTEGER,
    price INTEGER,
    page STRING
);

COPY INTO eshop
FROM @~/eshop_clothing.csv
FILE_FORMAT = (
    TYPE = 'CSV'
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";24;444;72;12;30;30;42;42;72;388,25;8,4;3261,27;181,18;0;0;0;0;1;1;10,87;1,0;43;4;2,62;0,63
332;C;-1;Claude_4.5_Sonnet;3;1;"CREATE OR REPLACE TABLE eshop(year INT,month INT,day INT,order_no INT,country STRING,session_id INT,category STRING,clothing_model STRING,colour STRING,location STRING,model INT,price INT,page STRING);
COPY INTO eshop FROM @~/eshop_clothing.csv FILE_FORMAT=(TYPE=CSV FIELD_DELIMITER=';' SKIP_HEADER=1 ERROR_ON_COLUMN_COUNT_MISMATCH=FALSE) ON_ERROR='CONTINUE';";2;359;75;13;30;32;43;43;75;406,97;9,32;3791,6;210,64;0;0;0;0;1;1;11,41;1,0;43;4;2,62;0,63
333;D;-1;Claude_4.5_Sonnet;0;1;"CREATE OR REPLACE TABLE sales (
    order_id STRING,
    order_date DATE,
    status STRING,
    fulfilment STRING,
    ship_service STRING,
    product STRING,
    category STRING,
    size STRING,
    courier_status STRING,
    quantity INTEGER,
    amount NUMBER(10, 2),
    ship_state STRING
);

COPY INTO sales
FROM @~/amazon_report.csv
FILE_FORMAT = (
    TYPE = 'CSV'
    FIELD_DELIMITER = ';'
    SKIP_HEADER = 1
)
ON_ERROR = 'CONTINUE';";23;445;74;12;33;32;42;45;74;406,4;7,64;3103,4;172,41;0;0;0;0;2;1;11,11;1,0;44;6;2,39;0,59
334;D;-1;Claude_4.5_Sonnet;1;1;"CREATE OR REPLACE TABLE sales (
    order_id STRING,
    order_date DATE,
    status STRING,
    fulfilment STRING,
    ship_service STRING,
    product STRING,
    category STRING,
    size STRING,
    courier_status STRING,
    quantity INTEGER,
    amount NUMBER(15,2),
    ship_state STRING
);

COPY INTO sales FROM @~/amazon_report.csv
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ';' SKIP_HEADER = 1)
ON_ERROR = 'CONTINUE';";18;430;74;12;33;32;42;45;74;406,4;7,64;3103,4;172,41;0;0;0;0;2;1;11,08;1,0;44;6;2,39;0,59
335;D;-1;Claude_4.5_Sonnet;2;1;"CREATE OR REPLACE TABLE sales (
    order_id STRING, order_date DATE, status STRING, fulfilment STRING, ship_service STRING,
    product STRING, category STRING, size STRING, courier_status STRING, quantity INTEGER,
    amount NUMBER(15,2), ship_state STRING
);

COPY INTO sales FROM @~/amazon_report.csv
FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ';' SKIP_HEADER = 1)
ON_ERROR = 'CONTINUE';";9;394;74;12;33;32;42;45;74;406,4;7,64;3103,4;172,41;0;0;0;0;2;1;11,01;1,0;44;6;2,39;0,59
336;D;-1;Claude_4.5_Sonnet;3;1;"CREATE TABLE sales (order_id STRING, order_date DATE, status STRING, fulfilment STRING, ship_service STRING, product STRING, category STRING, size STRING, courier_status STRING, quantity INTEGER, amount NUMBER(15,2), ship_state STRING);
COPY INTO sales FROM @~/amazon_report.csv FILE_FORMAT=(TYPE=CSV FIELD_DELIMITER=';' SKIP_HEADER=1) ON_ERROR=CONTINUE;";2;354;72;11;31;31;41;42;72;388,25;7,27;2824,18;156,9;0;0;0;0;2;0;10,66;1,0;44;6;2,39;0,59
337;A;-1;Claude_4.5_Sonnet;0;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price AS amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date 
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS rolling_14day_revenue
FROM retail
WHERE customer_id IS NOT NULL
ORDER BY customer_id, invoice_date;";12;341;48;23;8;33;15;31;48;237,8;21,56;5127,59;284,87;0;1;1;0;1;3;8,97;5,0;45;7;1,52;0,36
338;A;-1;Claude_4.5_Sonnet;1;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price AS amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date 
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS rolling_14day_revenue
FROM retail
WHERE customer_id IS NOT NULL
ORDER BY customer_id, invoice_date;";12;341;48;23;8;33;15;31;48;237,8;21,56;5127,59;284,87;0;1;1;0;1;3;8,97;5,0;45;7;1,52;0,36
339;A;-1;Claude_4.5_Sonnet;2;2;"WITH customer_transactions AS (
    SELECT 
        customer_id,
        invoice_date,
        quantity * unit_price AS amount
    FROM retail
    WHERE customer_id IS NOT NULL
)
SELECT 
    customer_id,
    invoice_date,
    amount,
    SUM(amount) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date 
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS rolling_14day_revenue
FROM customer_transactions
ORDER BY customer_id, invoice_date;";19;465;59;23;10;39;20;33;59;297,62;23,0;6845,24;380,29;1;1;1;1;1;6;10,94;10,0;56;9;1,53;0,36
340;A;-1;Claude_4.5_Sonnet;3;2;"SELECT customer_id, SUM(quantity * unit_price) AS total_revenue
FROM retail
WHERE invoice_date >= DATEADD(DAY, -14, CURRENT_TIMESTAMP())
GROUP BY customer_id;";4;158;31;14;10;20;11;24;31;142,13;7,7;1094,43;60,8;0;0;1;0;2;0;5,69;2,5;26;6;1,56;0,38
341;B;-1;Claude_4.5_Sonnet;0;2;"SELECT platform, year, SUM(global_sales) AS total_global_sales
FROM games
WHERE year >= YEAR(CURRENT_TIMESTAMP()) - 2
GROUP BY platform, year
ORDER BY platform, year;";5;166;35;14;7;22;13;21;35;153,73;13,0;1998,5;111,03;0;0;1;0;2;0;6,26;2,5;33;5;1,52;0,36
342;B;-1;Claude_4.5_Sonnet;1;2;"SELECT platform, year, SUM(global_sales) AS total_global_sales
FROM games
WHERE year >= YEAR(CURRENT_TIMESTAMP()) - 2
GROUP BY platform, year
ORDER BY platform, year;";5;166;35;14;7;22;13;21;35;153,73;13,0;1998,5;111,03;0;0;1;0;2;0;6,26;2,5;33;5;1,52;0,36
343;B;-1;Claude_4.5_Sonnet;2;2;"WITH ranked_years AS (
    SELECT DISTINCT year,
           ROW_NUMBER() OVER (ORDER BY year DESC) AS rn
    FROM games
    WHERE year IS NOT NULL
)
SELECT 
    g.platform,
    g.year,
    SUM(g.global_sales) AS total_global_sales
FROM games g
INNER JOIN ranked_years ry ON g.year = ry.year AND ry.rn <= 3
GROUP BY g.platform, g.year
ORDER BY g.platform, g.year;";14;362;85;25;12;51;34;37;85;442,8;35,42;15682,63;871,26;1;1;1;1;2;6;14,82;10,0;77;10;1,81;0,45
344;B;-1;Claude_4.5_Sonnet;3;2;"SELECT platform,year,SUM(global_sales) total_global_sales FROM games WHERE year IN(SELECT year FROM(SELECT DISTINCT year,ROW_NUMBER() OVER(ORDER BY year DESC) rn FROM games WHERE year IS NOT NULL)WHERE rn<=3)GROUP BY platform,year ORDER BY platform,year;";1;254;59;19;8;40;19;27;59;280,54;22,56;6329,65;351,65;2;1;1;0;3;10;11,06;11,0;61;14;1,5;0,34
345;C;-1;Claude_4.5_Sonnet;0;2;"SELECT 
    country,
    DATE_FROM_PARTS(year, month, day) AS order_date,
    SUM(price) AS daily_revenue,
    SUM(daily_revenue) OVER (
        PARTITION BY country 
        ORDER BY order_date 
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7d_total
FROM eshop
GROUP BY country, order_date
ORDER BY country, order_date;";12;340;56;19;11;38;18;30;56;274,79;15,55;4271,67;237,32;0;1;2;0;1;3;10,06;6,5;46;7;1,55;0,37
346;C;-1;Claude_4.5_Sonnet;1;2;"SELECT 
    country,
    DATE_FROM_PARTS(year, month, day) AS order_date,
    SUM(price) AS daily_revenue,
    SUM(SUM(price)) OVER (
        PARTITION BY country 
        ORDER BY DATE_FROM_PARTS(year, month, day) 
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7d_total
FROM eshop
GROUP BY country, order_date
ORDER BY country, order_date;";12;360;66;19;11;45;21;30;66;323,85;18,14;5873,55;326,31;0;1;3;0;2;3;11,74;8,0;52;8;1,55;0,37
347;C;-1;Claude_4.5_Sonnet;2;2;"WITH daily_revenue_cte AS (
    SELECT 
        country,
        DATE_FROM_PARTS(year, month, day) AS order_date,
        SUM(price) AS daily_price_sum
    FROM eshop
    GROUP BY country, order_date
)
SELECT 
    country,
    order_date,
    daily_price_sum,
    SUM(daily_price_sum) OVER (
        PARTITION BY country 
        ORDER BY order_date 
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7d_revenue
FROM daily_revenue_cte
ORDER BY country, order_date;";19;480;69;19;13;45;24;32;69;345,0;17,54;6050,77;336,15;1;1;2;1;2;6;12,34;11,5;60;8;1,55;0,37
348;C;-1;Claude_4.5_Sonnet;3;2;"SELECT country,order_date,daily_revenue,SUM(daily_revenue) OVER(PARTITION BY country ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) rolling_7d FROM(SELECT country,DATE_FROM_PARTS(year,month,day) order_date,SUM(price) daily_revenue FROM eshop GROUP BY 1,2)ORDER BY country,order_date;";1;298;62;18;13;41;21;31;62;307,16;14,54;4465,64;248,09;1;1;2;0;2;6;10,78;9,5;53;8;1,58;0,38
349;D;-1;Claude_4.5_Sonnet;0;2;"WITH daily_sales AS (
    SELECT 
        ship_state,
        order_date,
        SUM(amount) AS daily_amount
    FROM sales
    GROUP BY ship_state, order_date
)
SELECT 
    ship_state,
    order_date,
    daily_amount,
    SUM(daily_amount) OVER (
        PARTITION BY ship_state 
        ORDER BY order_date 
        ROWS BETWEEN 7 PRECEDING AND 1 PRECEDING
    ) AS rolling_7d_previous_sum
FROM daily_sales
ORDER BY ship_state, order_date;";19;443;60;17;10;39;21;27;60;285,29;17,85;5092,48;282,92;1;1;2;1;2;6;10,75;11,5;54;8;1,56;0,37
350;D;-1;Claude_4.5_Sonnet;1;2;"SELECT ship_state, order_date, SUM(amount) AS daily_amount,
       SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 7 PRECEDING AND 1 PRECEDING) AS sum_7d_prev
FROM sales GROUP BY 1, 2 ORDER BY 1, 2;";3;230;50;17;9;35;15;26;50;235,02;14,17;3329,48;184,97;0;1;3;0;2;3;8,6;8,0;37;7;1,64;0,41
351;D;-1;Claude_4.5_Sonnet;2;2;"WITH DailySales AS (
    SELECT ship_state, order_date, SUM(amount) AS daily_amount
    FROM sales GROUP BY ship_state, order_date
)
SELECT ship_state, order_date, daily_amount,
       SUM(daily_amount) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 7 PRECEDING AND 1 PRECEDING) AS rolling_7d_prev
FROM DailySales
ORDER BY ship_state, order_date;";8;362;60;17;10;39;21;27;60;285,29;17,85;5092,48;282,92;1;1;2;1;2;6;10,58;11,5;54;8;1,56;0,37
352;D;-1;Claude_4.5_Sonnet;3;2;"SELECT ship_state, order_date, SUM(amount) amt, SUM(SUM(amount)) OVER (PARTITION BY ship_state ORDER BY order_date ROWS BETWEEN 7 PRECEDING AND 1 PRECEDING) FROM sales GROUP BY 1,2;";1;181;42;16;8;30;12;24;42;192,57;12,0;2310,82;128,38;0;1;3;0;2;3;7,42;8,0;30;6;1,61;0,4
353;A;-1;Claude_4.5_Sonnet;0;3;"SELECT 
    customer_id,
    invoice_date,
    LEAD(invoice_date) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date
    ) AS next_order_date,
    LEAD(invoice_date) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date
    ) - invoice_date AS days_to_next_order
FROM retail
WHERE customer_id IS NOT NULL
    AND quantity > 0
ORDER BY days_to_next_order DESC NULLS LAST;";15;407;56;19;10;37;19;29;56;272,05;18,05;4910,45;272,8;0;2;0;0;1;5;10,22;6,0;50;8;1,48;0,34
354;A;-1;Claude_4.5_Sonnet;1;3;"SELECT 
    customer_id,
    invoice_date,
    LEAD(invoice_date) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date
    ) AS next_order_date,
    DATEDIFF(day, invoice_date, LEAD(invoice_date) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date
    )) AS days_to_next_order
FROM retail
WHERE customer_id IS NOT NULL
    AND quantity > 0
ORDER BY days_to_next_order DESC NULLS LAST;";15;421;61;18;12;40;21;30;61;299,32;15,75;4714,3;261,91;0;2;0;0;2;5;11,01;6,0;51;8;1,52;0,35
355;A;-1;Claude_4.5_Sonnet;2;3;"WITH valid_orders AS (
    SELECT 
        customer_id,
        invoice_date
    FROM retail
    WHERE customer_id IS NOT NULL
        AND quantity > 0
),
orders_with_next AS (
    SELECT 
        customer_id,
        invoice_date,
        LEAD(invoice_date) OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        ) AS next_order_date
    FROM valid_orders
)
SELECT 
    customer_id,
    invoice_date,
    next_order_date,
    DATEDIFF(day, invoice_date, next_order_date) AS days_to_next_order
FROM orders_with_next
WHERE next_order_date IS NOT NULL
ORDER BY days_to_next_order DESC;";26;615;76;18;13;48;28;31;76;376,52;19,38;7298,67;405,48;2;1;0;1;2;9;13,95;11,5;74;10;1,55;0,36
356;A;-1;Claude_4.5_Sonnet;3;3;"SELECT customer_id, 
       LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date) - invoice_date AS days_until_next_order
FROM retail
WHERE quantity > 0
ORDER BY days_until_next_order DESC;";5;208;31;15;7;20;11;22;31;138,24;11,79;1629,29;90,52;0;1;0;0;1;2;5,49;3,5;30;8;1,45;0,33
357;B;-1;Claude_4.5_Sonnet;0;3;"SELECT genre, year, 
       SUM(global_sales) - LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) AS sales_difference
FROM games
GROUP BY genre, year
ORDER BY genre, year;";5;184;41;15;5;29;12;20;41;177,2;18,0;3189,58;177,2;0;1;2;0;2;2;7,25;6,5;37;8;1,44;0,32
358;B;-1;Claude_4.5_Sonnet;1;3;"SELECT genre, year, 
       SUM(global_sales) - LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) AS sales_difference
FROM games
GROUP BY genre, year
ORDER BY genre, year;";5;184;41;15;5;29;12;20;41;177,2;18,0;3189,58;177,2;0;1;2;0;2;2;7,25;6,5;37;8;1,44;0,32
359;B;-1;Claude_4.5_Sonnet;2;3;"SELECT 
    genre,
    year,
    total_sales,
    total_sales - LAG(total_sales, 1, 0) OVER (PARTITION BY genre ORDER BY year) AS sales_diff
FROM (
    SELECT 
        genre,
        year,
        SUM(global_sales) AS total_sales
    FROM games
    WHERE year IS NOT NULL
    GROUP BY genre, year
)
ORDER BY genre, year;";15;320;60;19;8;40;20;27;60;285,29;23,75;6775,71;376,43;1;1;1;0;2;5;10,47;8,0;57;9;1,56;0,37
360;B;-1;Claude_4.5_Sonnet;3;3;"SELECT genre,year,total_sales,total_sales-LAG(total_sales) OVER(PARTITION BY genre ORDER BY year) diff FROM(SELECT genre,year,SUM(global_sales) total_sales FROM games GROUP BY genre,year HAVING year IS NOT NULL)ORDER BY genre,year;";1;231;54;18;6;36;18;24;54;247,59;27,0;6684,88;371,38;1;1;1;0;2;5;9,49;8,0;55;9;1,5;0,35
361;C;-1;Claude_4.5_Sonnet;0;3;"SELECT 
    clothing_model,
    DATE_FROM_PARTS(year, month, day) AS order_date,
    price,
    LAG(price) OVER (PARTITION BY clothing_model ORDER BY order_date) AS prev_price,
    (price - prev_price) AS price_change
FROM eshop
ORDER BY clothing_model, order_date;";8;265;47;13;10;30;17;23;47;212,61;11,05;2349,31;130,52;0;1;0;0;1;2;8,01;3,5;44;7;1,54;0,36
362;C;-1;Claude_4.5_Sonnet;1;3;"SELECT 
    clothing_model,
    DATE_FROM_PARTS(year, month, day) AS order_date,
    price,
    LAG(price) OVER (PARTITION BY clothing_model ORDER BY DATE_FROM_PARTS(year, month, day)) AS previous_price,
    (price - previous_price) AS price_diff
FROM eshop
ORDER BY clothing_model, order_date;";8;294;54;13;10;34;20;23;54;244,27;13,0;3175,54;176,42;0;1;0;0;2;2;9,11;3,5;49;8;1,55;0,37
363;C;-1;Claude_4.5_Sonnet;2;3;"WITH model_prices AS (
    SELECT 
        clothing_model,
        DATE_FROM_PARTS(year, month, day) AS order_date,
        price
    FROM eshop
)
SELECT 
    clothing_model,
    order_date,
    price,
    LAG(price) OVER (PARTITION BY clothing_model ORDER BY order_date) AS previous_price,
    (price - previous_price) AS price_difference
FROM model_prices
ORDER BY clothing_model, order_date;";15;394;60;13;12;37;23;25;60;278,63;12,46;3471,28;192,85;1;1;0;1;2;5;10,27;8,5;58;8;1,54;0,36
364;C;-1;Claude_4.5_Sonnet;3;3;"SELECT clothing_model,order_date,price,price-LAG(price) OVER(PARTITION BY clothing_model ORDER BY order_date) price_change FROM(SELECT clothing_model,DATE_FROM_PARTS(year,month,day) order_date,price FROM eshop)ORDER BY clothing_model,order_date;";1;245;48;12;9;30;18;21;48;210,83;12,0;2529,97;140,55;1;1;0;0;2;5;8,17;6,5;48;8;1,52;0,35
365;D;-1;Claude_4.5_Sonnet;0;3;"SELECT 
    ship_state,
    order_id,
    order_date,
    LEAD(order_date) OVER (PARTITION BY ship_state ORDER BY order_date) AS next_order_date,
    DATEDIFF('day', order_date, next_order_date) AS days_difference
FROM sales
ORDER BY days_difference DESC NULLS LAST;";8;266;42;12;11;25;17;23;42;189,99;9,27;1761,72;97,87;0;1;0;0;1;2;6,93;3,5;34;7;1,57;0,38
366;D;-1;Claude_4.5_Sonnet;1;3;"SELECT ship_state, order_id, order_date,
       DATEDIFF('day', order_date, LEAD(order_date) OVER (PARTITION BY ship_state ORDER BY order_date)) AS days_diff
FROM sales ORDER BY days_diff DESC NULLS LAST;";3;204;38;12;10;23;15;22;38;169,46;9,0;1525,13;84,73;0;1;0;0;2;2;6,25;3,5;30;8;1,53;0,37
367;D;-1;Claude_4.5_Sonnet;2;3;"WITH DeliverySequence AS (
    SELECT ship_state, order_id, order_date,
           LEAD(order_date) OVER (PARTITION BY ship_state ORDER BY order_date) AS next_shipment_date
    FROM sales
)
SELECT ship_state, order_id, order_date, next_shipment_date,
       DATEDIFF('day', order_date, next_shipment_date) AS days_later
FROM DeliverySequence
ORDER BY days_later DESC NULLS LAST;";9;378;57;12;13;33;24;25;57;264,7;11,08;2932,06;162,89;1;1;0;1;2;5;9,44;8,5;50;10;1,58;0,38
368;D;-1;Claude_4.5_Sonnet;3;3;"SELECT *, DATEDIFF(day, order_date, LEAD(order_date) OVER(PARTITION BY ship_state ORDER BY order_date)) diff FROM sales ORDER BY diff DESC;";1;139;31;12;7;21;10;19;31;131,69;8,57;1128,74;62,71;0;1;0;0;2;2;5,4;3,5;25;8;1,5;0,36
369;A;-1;Claude_4.5_Sonnet;0;4;"SELECT 
    customer_id,
    SUM(quantity * unit_price) AS total_amount,
    NTILE(4) OVER (ORDER BY SUM(quantity * unit_price) DESC) AS quartile
FROM retail
WHERE customer_id IS NOT NULL
GROUP BY customer_id
ORDER BY total_amount DESC;";8;236;45;18;8;31;14;26;45;211,52;15,75;3331,44;185,08;0;1;2;0;2;2;7,98;6,5;40;9;1,44;0,33
370;A;-1;Claude_4.5_Sonnet;1;4;"SELECT 
    customer_id,
    SUM(quantity * unit_price) AS total_amount,
    NTILE(4) OVER (ORDER BY SUM(quantity * unit_price) DESC) AS quartile
FROM retail
WHERE customer_id IS NOT NULL
GROUP BY customer_id
ORDER BY total_amount DESC;";8;236;45;18;8;31;14;26;45;211,52;15,75;3331,44;185,08;0;1;2;0;2;2;7,98;6,5;40;9;1,44;0,33
371;A;-1;Claude_4.5_Sonnet;2;4;"WITH customer_total_revenue AS (
    SELECT 
        customer_id,
        SUM(quantity * unit_price) AS total_amount
    FROM retail
    WHERE customer_id IS NOT NULL
    GROUP BY customer_id
)
SELECT 
    customer_id,
    total_amount,
    NTILE(4) OVER (ORDER BY total_amount DESC) AS quartile
FROM customer_total_revenue
ORDER BY total_amount DESC;";14;351;51;18;10;33;18;28;51;245,18;16,2;3971,84;220,66;1;1;1;1;2;5;9,05;10,0;48;9;1,47;0,33
372;A;-1;Claude_4.5_Sonnet;3;4;"WITH customer_revenue AS (
    SELECT customer_id, SUM(quantity * unit_price) AS total_amount
    FROM retail
    GROUP BY customer_id
)
SELECT customer_id, total_amount,
       NTILE(4) OVER (ORDER BY total_amount DESC) AS revenue_quartile
FROM customer_revenue
ORDER BY total_amount DESC;";9;290;46;14;10;29;17;24;46;210,91;11,9;2509,81;139,43;1;1;1;1;2;5;7,9;10,0;42;9;1,46;0,33
373;B;-1;Claude_4.5_Sonnet;0;4;"WITH sales_ranked AS (
    SELECT *, NTILE(4) OVER (PARTITION BY year ORDER BY global_sales DESC) AS sales_quartile
    FROM games
)
SELECT year, name, global_sales, sales_quartile
FROM sales_ranked
ORDER BY year DESC;";7;218;41;13;9;26;15;22;41;182,84;10,83;1980,73;110,04;1;1;0;1;2;5;7,0;8,5;36;10;1,52;0,36
374;B;-1;Claude_4.5_Sonnet;1;4;"WITH sales_ranked AS (
    SELECT *, NTILE(4) OVER (PARTITION BY year ORDER BY global_sales DESC) AS sales_quartile
    FROM games
)
SELECT year, name, global_sales, sales_quartile
FROM sales_ranked
ORDER BY year DESC;";7;218;41;13;9;26;15;22;41;182,84;10,83;1980,73;110,04;1;1;0;1;2;5;7,0;8,5;36;10;1,52;0,36
375;B;-1;Claude_4.5_Sonnet;2;4;"SELECT 
    name,
    platform,
    year,
    global_sales,
    NTILE(4) OVER (PARTITION BY year ORDER BY global_sales DESC NULLS LAST) AS quartile
FROM games
WHERE year IS NOT NULL
ORDER BY year DESC, global_sales DESC;";9;220;42;16;10;25;17;26;42;197,42;13,6;2684,89;149,16;0;1;0;0;1;2;6,99;3,5;36;7;1,52;0,36
376;B;-1;Claude_4.5_Sonnet;3;4;"SELECT name,platform,year,global_sales,NTILE(4) OVER(PARTITION BY year ORDER BY global_sales DESC) quartile FROM games WHERE year IS NOT NULL ORDER BY year DESC,global_sales DESC;";1;179;39;15;8;24;15;23;39;176,42;14,06;2480,89;137,83;0;1;0;0;1;2;6,55;3,5;36;7;1,52;0,36
377;C;-1;Claude_4.5_Sonnet;0;4;"WITH category_sales AS (
    SELECT 
        category,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY category
)
SELECT 
    category,
    total_revenue,
    NTILE(4) OVER (ORDER BY total_revenue DESC) AS quartile
FROM category_sales
ORDER BY quartile;";13;269;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,5;10,0;39;8;1,46;0,33
378;C;-1;Claude_4.5_Sonnet;1;4;"SELECT 
    category,
    SUM(price) AS total_revenue,
    NTILE(4) OVER (ORDER BY SUM(price) DESC) AS quartile
FROM eshop
GROUP BY category
ORDER BY quartile;";7;159;35;13;7;25;10;20;35;151,27;9,29;1404,63;78,03;0;1;2;0;2;2;6,16;6,5;28;8;1,42;0,32
379;C;-1;Claude_4.5_Sonnet;2;4;"WITH category_totals AS (
    SELECT 
        category,
        SUM(price) AS total_revenue
    FROM eshop
    GROUP BY category
)
SELECT 
    category,
    total_revenue,
    NTILE(4) OVER (ORDER BY total_revenue DESC) AS revenue_quartile
FROM category_totals
ORDER BY revenue_quartile;";13;287;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,53;10,0;39;8;1,46;0,33
380;C;-1;Claude_4.5_Sonnet;3;4;"SELECT category,SUM(price) revenue,NTILE(4) OVER(ORDER BY SUM(price) DESC) quartile FROM eshop GROUP BY category ORDER BY quartile,SUM(price) DESC;";1;147;39;12;7;27;12;19;39;165,67;10,29;1704,03;94,67;0;1;3;0;2;2;6,69;8,0;32;8;1,41;0,31
381;D;-1;Claude_4.5_Sonnet;0;4;"WITH state_revenue AS (
    SELECT 
        ship_state,
        SUM(amount) AS total_revenue
    FROM sales
    GROUP BY ship_state
)
SELECT 
    ship_state,
    total_revenue,
    NTILE(4) OVER (ORDER BY total_revenue DESC) AS revenue_quartile
FROM state_revenue
ORDER BY revenue_quartile;";13;290;43;13;9;28;15;22;43;191,76;10,83;2077,35;115,41;1;1;1;1;2;5;7,54;10,0;39;8;1,46;0,33
382;D;-1;Claude_4.5_Sonnet;1;4;"SELECT ship_state, SUM(amount) AS total_amount,
       NTILE(4) OVER (ORDER BY SUM(amount) DESC) AS revenue_quartile
FROM sales GROUP BY 1 ORDER BY revenue_quartile;";3;165;35;13;8;25;10;21;35;153,73;8,12;1249,07;69,39;0;1;2;0;2;2;6,09;6,5;27;8;1,44;0,33
383;D;-1;Claude_4.5_Sonnet;2;4;"WITH StateTotals AS (
    SELECT ship_state, SUM(amount) AS total_amount
    FROM sales GROUP BY ship_state
)
SELECT ship_state, total_amount,
       NTILE(4) OVER (ORDER BY total_amount DESC) AS quartile
FROM StateTotals
ORDER BY total_amount DESC;";8;249;44;13;9;28;16;22;44;196,21;11,56;2267,37;125,97;1;1;1;1;2;5;7,54;10,0;39;8;1,46;0,33
384;D;-1;Claude_4.5_Sonnet;3;4;"SELECT ship_state, SUM(amount) total, NTILE(4) OVER(ORDER BY total DESC) FROM sales GROUP BY 1;";1;95;26;12;7;18;8;19;26;110,45;6,86;757,34;42,07;0;1;1;0;1;2;4,39;5,0;20;6;1,46;0,35
385;A;-1;Claude_4.5_Sonnet;0;5;"SELECT 
    customer_id,
    invoice_no,
    invoice_date,
    stock_code,
    description,
    quantity,
    unit_price,
    country
FROM (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        ) AS rn
    FROM retail
    WHERE customer_id IS NOT NULL
) AS ranked
WHERE rn = 1
ORDER BY customer_id;";21;376;53;18;12;36;17;30;53;260,07;12,75;3315,83;184,21;1;1;0;0;2;5;9,77;6,5;51;10;1,61;0,39
386;A;-1;Claude_4.5_Sonnet;1;5;"SELECT 
    customer_id,
    invoice_no,
    invoice_date,
    stock_code,
    description,
    quantity,
    unit_price,
    country
FROM (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        ) AS rn
    FROM retail
    WHERE customer_id IS NOT NULL
) AS ranked
WHERE rn = 1
ORDER BY customer_id;";21;376;53;18;12;36;17;30;53;260,07;12,75;3315,83;184,21;1;1;0;0;2;5;9,77;6,5;51;10;1,61;0,39
387;A;-1;Claude_4.5_Sonnet;2;5;"WITH ranked_purchases AS (
    SELECT 
        customer_id,
        invoice_no,
        invoice_date,
        stock_code,
        description,
        quantity,
        unit_price,
        country,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id 
            ORDER BY invoice_date
        ) AS purchase_rank
    FROM retail
    WHERE customer_id IS NOT NULL
)
SELECT 
    customer_id,
    invoice_no,
    invoice_date,
    stock_code,
    description,
    quantity,
    unit_price,
    country
FROM ranked_purchases
WHERE purchase_rank = 1
ORDER BY customer_id;";29;578;69;17;13;42;27;30;69;338,58;17,65;5977,16;332,06;1;1;0;1;2;5;12,18;8,5;69;10;1,66;0,41
388;A;-1;Claude_4.5_Sonnet;3;5;"SELECT customer_id, MIN(invoice_date) AS first_purchase
FROM retail
GROUP BY customer_id
ORDER BY customer_id;";4;110;18;11;4;12;6;15;18;70,32;8,25;580,17;32,23;0;0;1;0;1;0;3,22;2,5;18;5;1,42;0,33
389;B;-1;Claude_4.5_Sonnet;0;5;"SELECT publisher, name, year, eu_sales,
       ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) AS rank
FROM games
WHERE rank <= 3
ORDER BY publisher, year, rank;";5;185;40;15;7;28;12;22;40;178,38;12,86;2293,42;127,41;0;1;0;0;1;2;7,42;3,5;39;7;1,58;0,38
390;B;-1;Claude_4.5_Sonnet;1;5;"SELECT publisher, name, year, eu_sales,
       ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) AS rank
FROM games
WHERE rank <= 3
ORDER BY publisher, year, rank;";5;185;40;15;7;28;12;22;40;178,38;12,86;2293,42;127,41;0;1;0;0;1;2;7,42;3,5;39;7;1,58;0,38
391;B;-1;Claude_4.5_Sonnet;2;5;"SELECT 
    publisher,
    year,
    name,
    eu_sales,
    ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC NULLS LAST) AS game_rank
FROM games
WHERE year IS NOT NULL
QUALIFY game_rank <= 3
ORDER BY publisher, year, game_rank;";10;250;47;17;11;28;19;28;47;225,95;14,68;3317,29;184,29;0;1;0;0;1;2;8,26;3,5;45;7;1,57;0,38
392;B;-1;Claude_4.5_Sonnet;3;5;"SELECT publisher,year,name,eu_sales,ROW_NUMBER() OVER(PARTITION BY publisher,year ORDER BY eu_sales DESC) game_rank FROM games WHERE year IS NOT NULL QUALIFY game_rank<=3 ORDER BY publisher,year,game_rank;";1;205;44;16;9;27;17;25;44;204,33;15,11;3087,65;171,54;0;1;0;0;1;2;7,81;3,5;45;7;1,57;0,38
393;C;-1;Claude_4.5_Sonnet;0;5;"SELECT * FROM (
    SELECT 
        country,
        clothing_model,
        SUM(price) AS model_revenue,
        RANK() OVER (PARTITION BY country ORDER BY SUM(price) DESC) as rank
    FROM eshop
    GROUP BY country, clothing_model
)
WHERE rank <= 3
ORDER BY country, rank;";11;275;52;17;7;40;12;24;52;238,42;14,57;3474,09;193,01;1;1;2;0;3;7;10,12;9,5;45;11;1,52;0,36
394;C;-1;Claude_4.5_Sonnet;1;5;"SELECT * FROM (
    SELECT 
        country,
        clothing_model,
        SUM(price) AS model_revenue,
        ROW_NUMBER() OVER (PARTITION BY country ORDER BY SUM(price) DESC) as rank
    FROM eshop
    GROUP BY country, clothing_model
)
WHERE rank <= 3
ORDER BY country, rank;";11;281;52;18;7;40;12;25;52;241,48;15,43;3725,7;206,98;1;1;2;0;3;7;10,13;9,5;45;11;1,52;0,36
395;C;-1;Claude_4.5_Sonnet;2;5;"WITH model_revenue_per_country AS (
    SELECT 
        country,
        clothing_model,
        SUM(price) AS total_model_revenue
    FROM eshop
    GROUP BY country, clothing_model
),
ranked_models AS (
    SELECT 
        country,
        clothing_model,
        total_model_revenue,
        ROW_NUMBER() OVER (PARTITION BY country ORDER BY total_model_revenue DESC) AS rank
    FROM model_revenue_per_country
)
SELECT * FROM ranked_models 
WHERE rank <= 3
ORDER BY country, rank;";19;483;66;18;10;46;20;28;66;317,29;18,0;5711,14;317,29;2;1;1;1;2;8;12,5;13,0;62;10;1,56;0,37
396;C;-1;Claude_4.5_Sonnet;3;5;"SELECT country,clothing_model,SUM(price) total_price,ROW_NUMBER() OVER(PARTITION BY country ORDER BY SUM(price) DESC) rnk FROM eshop GROUP BY country,clothing_model QUALIFY rnk<=3 ORDER BY country,rnk;";1;201;45;14;9;29;16;23;45;203,56;12,44;2533,19;140,73;0;1;2;0;2;2;7,97;6,5;41;8;1,54;0,37
397;D;-1;Claude_4.5_Sonnet;0;5;"WITH product_ranking AS (
    SELECT 
        ship_state,
        product,
        SUM(amount) AS product_revenue,
        ROW_NUMBER() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) AS rank
    FROM sales
    WHERE amount IS NOT NULL
    GROUP BY ship_state, product
)
SELECT * FROM product_ranking 
WHERE rank <= 5
ORDER BY ship_state, rank;";13;353;61;21;9;45;16;30;61;299,32;18,67;5587,31;310,41;1;1;2;1;3;7;11,75;11,5;56;11;1,53;0,36
398;D;-1;Claude_4.5_Sonnet;1;5;"SELECT * FROM (
    SELECT ship_state, product, SUM(amount) AS prod_revenue,
           ROW_NUMBER() OVER (PARTITION BY ship_state ORDER BY SUM(amount) DESC) AS rank
    FROM sales WHERE amount IS NOT NULL GROUP BY 1, 2
) WHERE rank <= 5 ORDER BY ship_state;";5;258;55;21;9;42;13;30;55;269,88;15,17;4093,16;227,4;1;1;2;0;3;7;10,56;9,5;46;11;1,55;0,37
399;D;-1;Claude_4.5_Sonnet;2;5;"WITH ProductRevenue AS (
    SELECT ship_state, product, SUM(amount) AS revenue
    FROM sales WHERE amount IS NOT NULL GROUP BY ship_state, product
),
RankedProducts AS (
    SELECT ship_state, product, revenue,
           ROW_NUMBER() OVER (PARTITION BY ship_state ORDER BY revenue DESC) AS product_rank
    FROM ProductRevenue
)
SELECT * FROM RankedProducts WHERE product_rank <= 5;";10;385;66;20;11;44;22;31;66;326,98;20,0;6539,54;363,31;2;1;1;1;2;8;12,21;13,0;61;10;1,58;0,38
400;D;-1;Claude_4.5_Sonnet;3;5;"SELECT * FROM (SELECT ship_state, product, SUM(amount) r, ROW_NUMBER() OVER(PARTITION BY ship_state ORDER BY r DESC) rn FROM sales WHERE amount IS NOT NULL GROUP BY 1,2) WHERE rn<=5;";1;182;47;19;10;33;14;29;47;228,33;13,3;3036,72;168,71;1;1;1;0;2;5;8,68;8,0;41;10;1,6;0,39
401;A;-1;Claude_4.5_Sonnet;0;6;"SELECT 
    country,
    month,
    customer_id,
    monthly_amount,
    rank
FROM (
    SELECT 
        country,
        DATE_TRUNC('month', invoice_date) AS month,
        customer_id,
        SUM(quantity * unit_price) AS monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('month', invoice_date)
            ORDER BY SUM(quantity * unit_price) DESC
        ) AS rank
    FROM retail
    WHERE customer_id IS NOT NULL
    GROUP BY country, DATE_TRUNC('month', invoice_date), customer_id
) AS ranked
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";22;598;98;21;13;66;32;34;98;498,57;25,85;12886,15;715,9;1;1;2;0;3;7;17,48;9,5;88;12;1,61;0,39
402;A;-1;Claude_4.5_Sonnet;1;6;"SELECT 
    country,
    month,
    customer_id,
    monthly_amount,
    rank
FROM (
    SELECT 
        country,
        DATE_TRUNC('MONTH', invoice_date) AS month,
        customer_id,
        SUM(quantity * unit_price) AS monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('MONTH', invoice_date)
            ORDER BY SUM(quantity * unit_price) DESC
        ) AS rank
    FROM retail
    WHERE customer_id IS NOT NULL
    GROUP BY country, DATE_TRUNC('MONTH', invoice_date), customer_id
) AS ranked
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";22;598;98;21;13;66;32;34;98;498,57;25,85;12886,15;715,9;1;1;2;0;3;7;17,48;9,5;88;12;1,61;0,39
403;A;-1;Claude_4.5_Sonnet;2;6;"WITH monthly_customer_revenue AS (
    SELECT 
        country,
        DATE_TRUNC('MONTH', invoice_date) AS month,
        customer_id,
        SUM(quantity * unit_price) AS monthly_amount
    FROM retail
    WHERE customer_id IS NOT NULL
    GROUP BY country, DATE_TRUNC('MONTH', invoice_date), customer_id
),
ranked_customers AS (
    SELECT 
        country,
        month,
        customer_id,
        monthly_amount,
        ROW_NUMBER() OVER (
            PARTITION BY country, month
            ORDER BY monthly_amount DESC
        ) AS rank
    FROM monthly_customer_revenue
)
SELECT 
    country,
    month,
    customer_id,
    monthly_amount,
    rank
FROM ranked_customers
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";31;745;105;21;15;68;37;36;105;542,84;25,9;14059,61;781,09;2;1;1;1;2;8;18,77;13,0;100;10;1,62;0,39
404;A;-1;Claude_4.5_Sonnet;3;6;"SELECT country, customer_id, EXTRACT(YEAR FROM invoice_date) AS year, EXTRACT(MONTH FROM invoice_date) AS month,
       SUM(quantity * unit_price) AS monthly_revenue,
       ROW_NUMBER() OVER (PARTITION BY country, year, month ORDER BY SUM(quantity * unit_price) DESC) AS rank
FROM retail
GROUP BY country, customer_id, year, month
HAVING rank <= 5
ORDER BY country, year, month, rank, customer_id;";7;398;83;18;12;54;29;30;83;407,27;21,75;8858,16;492,12;0;1;2;0;2;2;14,65;6,5;76;9;1,63;0,39
405;B;-1;Claude_4.5_Sonnet;0;6;"SELECT genre, year, SUM(na_sales) AS total_na_sales,
       ROW_NUMBER() OVER (PARTITION BY genre ORDER BY SUM(na_sales) DESC) AS rank
FROM games
GROUP BY genre, year
HAVING rank <= 3
ORDER BY genre;";6;199;45;17;7;33;12;24;45;206,32;14,57;3006,43;167,02;0;1;2;0;2;2;8,45;6,5;38;8;1,54;0,37
406;B;-1;Claude_4.5_Sonnet;1;6;"SELECT genre, year, SUM(na_sales) AS total_na_sales,
       ROW_NUMBER() OVER (PARTITION BY genre ORDER BY SUM(na_sales) DESC) AS rank
FROM games
GROUP BY genre, year
HAVING rank <= 3
ORDER BY genre;";6;199;45;17;7;33;12;24;45;206,32;14,57;3006,43;167,02;0;1;2;0;2;2;8,45;6,5;38;8;1,54;0,37
407;B;-1;Claude_4.5_Sonnet;2;6;"WITH yearly_sales AS (
    SELECT 
        genre,
        year,
        SUM(na_sales) AS total_na_sales
    FROM games
    WHERE year IS NOT NULL
    GROUP BY genre, year
),
ranked_years AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (PARTITION BY genre ORDER BY total_na_sales DESC) AS rnk
    FROM yearly_sales
)
SELECT 
    genre,
    year,
    total_na_sales
FROM ranked_years
WHERE rnk <= 3
ORDER BY genre, rnk;";22;423;71;20;11;47;24;31;71;351,75;21,82;7674,5;426,36;2;1;1;1;2;8;13,05;13,0;68;10;1,56;0,37
408;B;-1;Claude_4.5_Sonnet;3;6;"SELECT genre,year,SUM(na_sales) total_na_sales,ROW_NUMBER() OVER(PARTITION BY genre ORDER BY SUM(na_sales) DESC) rnk FROM games WHERE year IS NOT NULL GROUP BY genre,year QUALIFY rnk<=3 ORDER BY genre,rnk;";1;205;50;18;9;33;17;27;50;237,74;17,0;4041,65;224,54;0;1;2;0;2;2;9,01;6,5;47;8;1,53;0,36
409;C;-1;Claude_4.5_Sonnet;0;6;"WITH daily_cat_revenue AS (
    SELECT 
        country,
        DATE_FROM_PARTS(year, month, day) AS order_date,
        category,
        SUM(price) AS total_price
    FROM eshop
    GROUP BY 1, 2, 3
),
ranked_categories AS (
    SELECT 
        *,
        RANK() OVER (PARTITION BY country, order_date ORDER BY total_price DESC) as rank
    FROM daily_cat_revenue
)
SELECT * FROM ranked_categories
WHERE rank <= 3
ORDER BY country, order_date;";18;446;77;17;17;52;25;34;77;391,73;12,5;4896,68;272,04;2;1;1;1;2;8;13,78;13,0;67;10;1,65;0,4
410;C;-1;Claude_4.5_Sonnet;1;6;"SELECT * FROM (
    SELECT 
        country,
        DATE_FROM_PARTS(year, month, day) AS order_date,
        category,
        SUM(price) AS daily_cat_revenue,
        RANK() OVER (PARTITION BY country, DATE_FROM_PARTS(year, month, day) ORDER BY SUM(price) DESC) as rank
    FROM eshop
    GROUP BY country, order_date, category
)
WHERE rank <= 3
ORDER BY country, order_date, rank;";12;383;76;17;12;53;23;29;76;369,21;16,29;6014,99;334,17;1;1;2;0;3;7;13,82;9,5;66;11;1,59;0,38
411;C;-1;Claude_4.5_Sonnet;2;6;"WITH daily_category_sales AS (
    SELECT 
        country,
        DATE_FROM_PARTS(year, month, day) AS order_date,
        category,
        SUM(price) AS total_daily_price
    FROM eshop
    GROUP BY country, order_date, category
),
category_ranking AS (
    SELECT 
        country,
        order_date,
        category,
        total_daily_price,
        RANK() OVER (PARTITION BY country, order_date ORDER BY total_daily_price DESC) AS category_rank
    FROM daily_category_sales
)
SELECT * FROM category_ranking 
WHERE category_rank <= 3
ORDER BY country, order_date;";21;574;83;17;16;52;31;33;83;418,68;16,47;6895,21;383,07;2;1;1;1;2;8;14,76;13,0;77;10;1,62;0,39
412;C;-1;Claude_4.5_Sonnet;3;6;"SELECT country,order_date,category,sum_price,DENSE_RANK() OVER(PARTITION BY country,order_date ORDER BY sum_price DESC) rnk FROM(SELECT country,DATE_FROM_PARTS(year,month,day) order_date,category,SUM(price) sum_price FROM eshop GROUP BY 1,2,3)QUALIFY rnk<=3 ORDER BY country,order_date;";1;286;67;14;16;40;27;30;67;328,76;11,81;3883,5;215,75;1;1;1;0;2;5;11,1;8,0;61;8;1,67;0,41
413;D;-1;Claude_4.5_Sonnet;0;6;"WITH daily_state_ranking AS (
    SELECT 
        order_date,
        ship_state,
        SUM(amount) AS total_amount,
        RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) AS rank
    FROM sales
    GROUP BY order_date, ship_state
)
SELECT * FROM daily_state_ranking 
WHERE rank <= 3
ORDER BY order_date, rank;";12;329;56;17;9;41;15;26;56;263,22;14,17;3729,02;207,17;1;1;2;1;3;7;10,67;11,5;50;11;1,53;0,36
414;D;-1;Claude_4.5_Sonnet;1;6;"SELECT * FROM (
    SELECT order_date, ship_state, SUM(amount) AS daily_revenue,
           RANK() OVER (PARTITION BY order_date ORDER BY SUM(amount) DESC) AS rank
    FROM sales GROUP BY 1, 2
) WHERE rank <= 3 ORDER BY order_date;";5;231;50;17;9;38;12;26;50;235,02;11,33;2663,58;147,98;1;1;2;0;3;7;9,47;9,5;40;11;1,56;0,38
415;D;-1;Claude_4.5_Sonnet;2;6;"WITH DailyStateTotals AS (
    SELECT order_date, ship_state, SUM(amount) AS daily_amount
    FROM sales GROUP BY order_date, ship_state
),
RankedStates AS (
    SELECT order_date, ship_state, daily_amount,
           RANK() OVER (PARTITION BY order_date ORDER BY daily_amount DESC) AS state_rank
    FROM DailyStateTotals
)
SELECT * FROM RankedStates WHERE state_rank <= 3 ORDER BY order_date;";10;394;64;17;11;42;22;28;64;307,67;17,0;5230,4;290,58;2;1;1;1;2;8;11,68;13,0;59;10;1,57;0,37
416;D;-1;Claude_4.5_Sonnet;3;6;"SELECT * FROM (SELECT order_date, ship_state, SUM(amount) a, RANK() OVER(PARTITION BY order_date ORDER BY a DESC) r FROM sales GROUP BY 1,2) WHERE r<=3;";1;152;42;16;10;29;13;26;42;197,42;10,4;2053,15;114,06;1;1;1;0;2;5;7,59;8,0;35;10;1,62;0,4
417;A;-1;Claude_4.5_Sonnet;0;7;"CREATE TABLE cities_pop (
    data VARIANT
);


COPY INTO cities_pop
FROM '@stage/cities_population.json'
FILE_FORMAT = (TYPE = 'JSON');";8;136;21;8;8;12;9;16;21;84,0;4,5;378,0;21,0;0;0;0;0;1;0;3,65;1,0;7;4;1,5;0,43
418;A;-1;Claude_4.5_Sonnet;1;7;"CREATE OR REPLACE TABLE cities_pop (
    data VARIANT
);

COPY INTO cities_pop
FROM @your_stage/cities_population.json
FILE_FORMAT = (TYPE = 'JSON');";7;149;27;11;11;15;12;22;27;120,4;6,0;722,43;40,13;0;0;0;0;1;1;4,67;1,0;7;4;1,5;0,43
419;A;-1;Claude_4.5_Sonnet;2;7;"CREATE OR REPLACE TABLE cities_pop (
    data VARIANT
);

COPY INTO cities_pop
FROM @your_stage/cities_population.json
FILE_FORMAT = (TYPE = 'JSON');";7;149;27;11;11;15;12;22;27;120,4;6,0;722,43;40,13;0;0;0;0;1;1;4,67;1,0;7;4;1,5;0,43
420;A;-1;Claude_4.5_Sonnet;3;7;"CREATE OR REPLACE TABLE cities_pop (data VARIANT);
COPY INTO cities_pop
FROM @your_stage/cities_population.json 
FILE_FORMAT = (TYPE = 'JSON');";4;143;27;11;11;15;12;22;27;120,4;6,0;722,43;40,13;0;0;0;0;1;1;4,66;1,0;7;4;1,5;0,43
421;B;-1;Claude_4.5_Sonnet;0;7;"CREATE OR REPLACE TABLE house_price (data VARIANT);
COPY INTO house_price
FROM @your_stage/house_price.parquet 
FILE_FORMAT = (TYPE = 'PARQUET');";4;145;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,66;1,0;7;4;1,5;0,43
422;B;-1;Claude_4.5_Sonnet;1;7;"CREATE OR REPLACE TABLE house_price (data VARIANT);

COPY INTO house_price
FROM @your_stage/house_price.parquet 
FILE_FORMAT = (TYPE = 'PARQUET');";5;146;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,66;1,0;7;4;1,5;0,43
423;B;-1;Claude_4.5_Sonnet;2;7;"CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
FROM @~/house_price.json
FILE_FORMAT = (TYPE = JSON)
ON_ERROR = 'CONTINUE';";8;156;30;11;11;16;14;22;30;133,78;7,0;936,48;52,03;0;0;0;0;1;1;5,19;1,0;7;4;1,5;0,43
424;B;-1;Claude_4.5_Sonnet;3;7;"CREATE OR REPLACE TABLE house_price(data VARIANT);
COPY INTO house_price FROM @~/house_price.json FILE_FORMAT=(TYPE=JSON) ON_ERROR='CONTINUE';";2;142;30;11;11;16;14;22;30;133,78;7,0;936,48;52,03;0;0;0;0;1;1;5,16;1,0;7;4;1,5;0,43
425;C;-1;Claude_4.5_Sonnet;0;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

COPY INTO forbes
FROM @my_stage/forbes.json
FILE_FORMAT = (TYPE = 'JSON');";7;128;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,63;1,0;7;4;1,5;0,43
426;C;-1;Claude_4.5_Sonnet;1;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

COPY INTO forbes
FROM @~/forbes.json
FILE_FORMAT = (TYPE = 'JSON');";7;121;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,61;1,0;7;4;1,5;0,43
427;C;-1;Claude_4.5_Sonnet;2;7;"CREATE OR REPLACE TABLE forbes (
    data VARIANT
);

COPY INTO forbes
FROM @~/forbes.json
FILE_FORMAT = (TYPE = 'JSON');";7;121;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,61;1,0;7;4;1,5;0,43
428;C;-1;Claude_4.5_Sonnet;3;7;"CREATE OR REPLACE TABLE forbes(data VARIANT);
COPY INTO forbes FROM @~/forbes.json FILE_FORMAT=(TYPE=JSON) ON_ERROR='CONTINUE';";2;127;30;11;11;16;14;22;30;133,78;7,0;936,48;52,03;0;0;0;0;1;1;5,13;1,0;7;4;1,5;0,43
429;D;-1;Claude_4.5_Sonnet;0;7;"CREATE OR REPLACE TABLE weather (
    data VARIANT
);

COPY INTO weather
FROM @~/weather.parquet
FILE_FORMAT = (TYPE = 'PARQUET');";7;130;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,63;1,0;7;4;1,5;0,43
430;D;-1;Claude_4.5_Sonnet;1;7;"CREATE OR REPLACE TABLE weather (data VARIANT);
COPY INTO weather FROM @~/weather.parquet FILE_FORMAT = (TYPE = 'PARQUET');";2;123;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,62;1,0;7;4;1,5;0,43
431;D;-1;Claude_4.5_Sonnet;2;7;"CREATE OR REPLACE TABLE weather (data VARIANT);
COPY INTO weather FROM @~/weather.parquet FILE_FORMAT = (TYPE = 'PARQUET');";2;123;27;11;10;15;12;21;27;118,59;6,6;782,71;43,48;0;0;0;0;1;1;4,62;1,0;7;4;1,5;0,43
432;D;-1;Claude_4.5_Sonnet;3;7;"CREATE TABLE weather (data VARIANT);
COPY INTO weather FROM @~/weather.parquet FILE_FORMAT=(TYPE=PARQUET);";2;106;25;10;8;14;11;18;25;104,25;6,88;716,71;39,82;0;0;0;0;1;0;4,23;1,0;7;4;1,5;0,43
433;A;-1;Claude_4.5_Sonnet;0;8;"SELECT 
    data:city::STRING AS city,
    data:rank::INTEGER AS rank,
    data:country::STRING AS country
FROM cities_pop
WHERE data:country::STRING = 'India'
ORDER BY data:rank::INTEGER;";7;188;32;10;10;13;19;20;32;138,3;9,5;1313,87;72,99;0;0;0;0;0;0;3,89;1,0;55;7;1,8;0,45
434;A;-1;Claude_4.5_Sonnet;1;8;"SELECT 
    data:city::STRING AS city,
    data:rank::INTEGER AS rank,
    data:country::STRING AS country
FROM cities_pop
WHERE data:country::STRING = 'India'
ORDER BY data:rank::INTEGER;";7;188;32;10;10;13;19;20;32;138,3;9,5;1313,87;72,99;0;0;0;0;0;0;3,89;1,0;55;7;1,8;0,45
435;A;-1;Claude_4.5_Sonnet;2;8;"WITH indian_cities AS (
    SELECT 
        data:city::STRING AS city,
        data:rank::INTEGER AS rank,
        data:country::STRING AS country
    FROM cities_pop
    WHERE data:country::STRING = 'India'
)
SELECT 
    city,
    rank,
    country
FROM indian_cities
ORDER BY rank;";14;283;43;12;12;22;21;24;43;197,15;10,5;2070,11;115,01;1;0;0;1;1;3;6,32;6,0;63;10;1,72;0,43
436;A;-1;Claude_4.5_Sonnet;3;8;"SELECT data:city AS city, data:rank AS rank
FROM cities_pop
WHERE data:country = 'India'
ORDER BY data:rank;";4;108;18;10;6;11;7;16;18;72,0;5,83;420,0;23,33;0;0;0;0;0;0;2,85;1,0;37;6;1,71;0,43
437;B;-1;Claude_4.5_Sonnet;0;8;"SELECT AVG(data:price::FLOAT) AS average_price, 
       MEDIAN(data:price::FLOAT) AS median_price
FROM house_price
WHERE data:price IS NOT NULL;";4;144;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,16;4,0;36;7;1,67;0,42
438;B;-1;Claude_4.5_Sonnet;1;8;"SELECT AVG(data:price::FLOAT) AS average_price, 
       MEDIAN(data:price::FLOAT) AS median_price
FROM house_price
WHERE data:price IS NOT NULL;";4;144;26;13;6;16;10;19;26;110,45;10,83;1196,5;66,47;0;0;2;0;1;0;4,16;4,0;36;7;1,67;0,42
439;B;-1;Claude_4.5_Sonnet;2;8;"SELECT 
    ROUND(AVG(price), 2) AS avg_price,
    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY price) AS median_price
FROM (
    SELECT data:price::FLOAT AS price
    FROM house_price,
    LATERAL FLATTEN(INPUT => data)
    WHERE data:price IS NOT NULL
      AND TRY_TO_DOUBLE(data:price) IS NOT NULL
);";10;303;62;19;18;40;22;37;62;322,99;11,61;3750,23;208,35;1;0;1;0;2;4;10,8;5,5;69;12;1,7;0,42
440;B;-1;Claude_4.5_Sonnet;3;8;"SELECT ROUND(AVG(data:price::FLOAT),2) avg_price,PERCENTILE_CONT(0.5) WITHIN GROUP(ORDER BY data:price::FLOAT) median_price FROM house_price WHERE data:price IS NOT NULL;";1;170;38;15;12;22;16;27;38;180,69;10,0;1806,86;100,38;0;0;1;0;2;0;5,65;2,5;42;9;1,64;0,4
441;C;-1;Claude_4.5_Sonnet;0;8;"SELECT 
    data:personName::STRING as name,
    data:finalWorth::NUMBER as current_worth,
    data:countryOfCitizenship::STRING as country
FROM forbes
WHERE country = 'United States'
ORDER BY current_worth DESC;";7;212;29;9;12;12;17;21;29;127,38;6,38;812,03;45,11;0;0;0;0;0;0;3,89;1,0;47;6;1,7;0,43
442;C;-1;Claude_4.5_Sonnet;1;8;"SELECT 
    data:personName::STRING AS name,
    data:finalWorth::NUMBER AS current_worth
FROM forbes
WHERE data:countryOfCitizenship::STRING = 'United States'
ORDER BY current_worth DESC;";6;188;25;9;11;10;15;20;25;108,05;6,14;663,02;36,83;0;0;0;0;0;0;3,29;1,0;43;7;1,68;0,42
443;C;-1;Claude_4.5_Sonnet;2;8;"SELECT 
    data:personName::STRING AS name,
    data:finalWorth::NUMBER AS current_worth,
    data:countryOfCitizenship::STRING AS citizenship
FROM forbes
WHERE citizenship = 'United States'
ORDER BY current_worth DESC;";7;220;29;9;12;12;17;21;29;127,38;6,38;812,03;45,11;0;0;0;0;0;0;3,91;1,0;47;6;1,7;0,43
444;C;-1;Claude_4.5_Sonnet;3;8;"SELECT data:name::STRING name,data:current_worth::INT worth FROM forbes WHERE data:country::STRING='United States' ORDER BY worth DESC;";1;135;23;8;11;8;15;19;23;97,7;5,45;532,92;29,61;0;0;0;0;0;0;2,78;1,0;39;7;1,73;0,44
445;D;-1;Claude_4.5_Sonnet;0;8;"SELECT 
    AVG(data:MaxTemp::FLOAT) AS avg_max_temp,
    MEDIAN(data:MaxTemp::FLOAT) AS median_max_temp,
    AVG(data:MinTemp::FLOAT) AS avg_min_temp,
    MEDIAN(data:MinTemp::FLOAT) AS median_min_temp
FROM weather;";6;216;39;9;9;22;17;18;39;162,63;8,5;1382,33;76,8;0;0;4;0;1;0;5,67;7,0;48;7;1,74;0,44
446;D;-1;Claude_4.5_Sonnet;1;8;"SELECT AVG(data:MaxTemp::FLOAT), MEDIAN(data:MaxTemp::FLOAT),
       AVG(data:MinTemp::FLOAT), MEDIAN(data:MinTemp::FLOAT)
FROM weather;";3;136;31;8;5;18;13;13;31;114,71;10,4;1193,02;66,28;0;0;4;0;1;0;4,39;7,0;40;6;1,7;0,42
447;D;-1;Claude_4.5_Sonnet;2;8;"SELECT AVG(data:MaxTemp::FLOAT) AS avg_max, MEDIAN(data:MaxTemp::FLOAT) AS med_max,
       AVG(data:MinTemp::FLOAT) AS avg_min, MEDIAN(data:MinTemp::FLOAT) AS med_min
FROM weather;";3;180;39;9;9;22;17;18;39;162,63;8,5;1382,33;76,8;0;0;4;0;1;0;5,6;7,0;48;7;1,74;0,44
448;D;-1;Claude_4.5_Sonnet;3;8;"SELECT AVG(data:MaxTemp::F), MEDIAN(data:MaxTemp::F), AVG(data:MinTemp::F), MEDIAN(data:MinTemp::F) FROM weather;";1;113;31;8;5;18;13;13;31;114,71;10,4;1193,02;66,28;0;0;4;0;1;0;4,35;7,0;0;0;0,0;0,0
449;A;-1;Claude_4.5_Sonnet;0;9;"SELECT 
    data:country::STRING AS country,
    COUNT(*) AS city_count
FROM cities_pop
GROUP BY data:country::STRING
ORDER BY city_count DESC;";6;143;25;12;7;14;11;19;25;106,2;9,43;1001,3;55,63;0;0;1;0;1;0;3,77;2,5;31;6;1,67;0,42
450;A;-1;Claude_4.5_Sonnet;1;9;"SELECT 
    data:country::STRING AS country,
    COUNT(*) AS city_count
FROM cities_pop
GROUP BY data:country::STRING
ORDER BY city_count DESC;";6;143;25;12;7;14;11;19;25;106,2;9,43;1001,3;55,63;0;0;1;0;1;0;3,77;2,5;31;6;1,67;0,42
451;A;-1;Claude_4.5_Sonnet;2;9;"WITH city_counts AS (
    SELECT 
        data:country::STRING AS country,
        COUNT(*) AS city_count
    FROM cities_pop
    GROUP BY data:country::STRING
)
SELECT 
    country,
    city_count
FROM city_counts
ORDER BY city_count DESC;";12;240;36;12;9;20;16;21;36;158,12;10,67;1686,65;93,7;1;0;1;1;2;3;5,68;7,5;43;9;1,62;0,4
452;A;-1;Claude_4.5_Sonnet;3;9;"SELECT data:country AS country, COUNT(*) AS city_count
FROM cities_pop
GROUP BY country
ORDER BY city_count;";4;108;20;12;4;14;6;16;20;80,0;9,0;720,0;40,0;0;0;1;0;1;0;3,54;2,5;23;5;1,57;0,39
453;B;-1;Claude_4.5_Sonnet;0;9;"SELECT data:furnishingstatus AS furnishing_status, 
       COUNT(*) AS house_count, 
       AVG(data:price::FLOAT) AS average_price
FROM house_price
GROUP BY furnishing_status;";5;176;26;12;8;17;9;20;26;112,37;6,75;758,5;42,14;0;0;2;0;1;0;4,35;4,0;30;7;1,71;0,43
454;B;-1;Claude_4.5_Sonnet;1;9;"SELECT data:furnishingstatus AS furnishing_status, 
       COUNT(*) AS house_count, 
       AVG(data:price::FLOAT) AS average_price
FROM house_price
GROUP BY furnishing_status;";5;176;26;12;8;17;9;20;26;112,37;6,75;758,5;42,14;0;0;2;0;1;0;4,35;4,0;30;7;1,71;0,43
455;B;-1;Claude_4.5_Sonnet;2;9;"SELECT 
    furnishingstatus,
    COUNT(*) AS num_houses,
    ROUND(AVG(price), 2) AS avg_price
FROM (
    SELECT 
        data:furnishingstatus::STRING AS furnishingstatus,
        data:price::FLOAT AS price
    FROM house_price,
    LATERAL FLATTEN(INPUT => data)
    WHERE data:furnishingstatus IS NOT NULL
      AND data:price IS NOT NULL
)
GROUP BY furnishingstatus
ORDER BY avg_price DESC;";15;395;65;20;17;41;24;37;65;338,61;14,12;4780,44;265,58;1;0;2;0;2;4;11,34;7,0;82;11;1,76;0,44
456;B;-1;Claude_4.5_Sonnet;3;9;"SELECT data:furnishingstatus::STRING furnishingstatus,COUNT(*) cnt,ROUND(AVG(data:price::FLOAT),2) avg_price FROM house_price WHERE data:furnishingstatus IS NOT NULL GROUP BY 1 ORDER BY avg_price DESC;";1;201;39;16;13;23;16;29;39;189,46;9,85;1865,46;103,64;0;0;2;0;2;0;5,99;4,0;47;8;1,7;0,43
457;C;-1;Claude_4.5_Sonnet;0;9;"SELECT 
    data:personName::STRING as name,
    data:finalWorth::NUMBER as current_worth,
    ARRAY_SIZE(data:industries) as industry_count
FROM forbes
ORDER BY current_worth DESC;";6;181;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,6;1,0;41;6;1,67;0,41
458;C;-1;Claude_4.5_Sonnet;1;9;"SELECT 
    data:personName::STRING AS name,
    ARRAY_SIZE(data:industries) AS industry_count,
    data:finalWorth::NUMBER AS current_worth
FROM forbes
ORDER BY current_worth DESC;";6;181;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,6;1,0;41;6;1,67;0,41
459;C;-1;Claude_4.5_Sonnet;2;9;"SELECT 
    data:personName::STRING AS name,
    data:finalWorth::NUMBER AS current_worth,
    ARRAY_SIZE(data:industries) AS industry_count
FROM forbes
ORDER BY current_worth DESC;";6;181;26;9;12;12;14;21;26;114,2;5,25;599,55;33,31;0;0;0;0;1;0;3,6;1,0;41;6;1,67;0,41
460;C;-1;Claude_4.5_Sonnet;3;9;"SELECT data:name::STRING name,data:current_worth::INT worth,ARRAY_SIZE(data:industries) num_industries FROM forbes ORDER BY worth DESC;";1;135;23;8;12;9;14;20;23;99,4;4,67;463,89;25,77;0;0;0;0;1;0;2,91;1,0;37;6;1,71;0,43
461;D;-1;Claude_4.5_Sonnet;0;9;"SELECT 
    data:WindGustDir::STRING AS wind_direction,
    AVG(data:Rainfall::FLOAT) AS avg_rainfall
FROM weather
WHERE wind_direction IS NOT NULL
GROUP BY wind_direction
ORDER BY avg_rainfall DESC;";7;199;30;15;9;17;13;24;30;137,55;10,83;1490,11;82,78;0;0;1;0;1;0;4,79;2,5;38;7;1,61;0,39
462;D;-1;Claude_4.5_Sonnet;1;9;"SELECT data:WindGustDir::STRING AS wind_dir, AVG(data:Rainfall::FLOAT) AS avg_rain
FROM weather GROUP BY 1 ORDER BY avg_rain;";2;125;24;11;9;13;11;20;24;103,73;6,72;697,27;38,74;0;0;1;0;1;0;3,45;2,5;31;7;1,67;0,42
463;D;-1;Claude_4.5_Sonnet;2;9;"WITH WindRain AS (
    SELECT data:WindGustDir::STRING AS wind_dir, data:Rainfall::FLOAT AS rain FROM weather
)
SELECT wind_dir, AVG(rain) AS average_rainfall
FROM WindRain WHERE wind_dir IS NOT NULL GROUP BY wind_dir ORDER BY average_rainfall;";5;244;42;15;11;24;18;26;42;197,42;12,27;2422,86;134,6;1;0;1;1;1;3;6,8;7,5;52;9;1,59;0,38
464;D;-1;Claude_4.5_Sonnet;3;9;"SELECT data:WindGustDir::S dir, AVG(data:Rainfall::F) r FROM weather GROUP BY 1 ORDER BY r;";1;91;22;10;9;11;11;19;22;93,45;6,11;571,11;31,73;0;0;1;0;1;0;2,98;2,5;0;0;0,0;0,0
465;A;-1;Claude_4.5_Sonnet;0;10;"SELECT 
    data:city::STRING AS city,
    data:country::STRING AS country,
    SUM(district.value:area_km2::DECIMAL) AS total_area_km2
FROM cities_pop,
LATERAL FLATTEN(input => data:districts) AS district
GROUP BY data:city::STRING, data:country::STRING
ORDER BY total_area_km2 DESC;";8;284;50;14;16;23;27;30;50;245,34;11,81;2898,13;161,01;0;0;1;0;1;0;6,87;2,5;80;8;1,88;0,47
466;A;-1;Claude_4.5_Sonnet;1;10;"SELECT 
    data:city::STRING AS city,
    data:country::STRING AS country,
    SUM(district.value:area_km2::DECIMAL) AS total_area_km2
FROM cities_pop,
LATERAL FLATTEN(input => data:districts) AS district
GROUP BY data:city::STRING, data:country::STRING
ORDER BY total_area_km2 DESC;";8;284;50;14;16;23;27;30;50;245,34;11,81;2898,13;161,01;0;0;1;0;1;0;6,87;2,5;80;8;1,88;0,47
467;A;-1;Claude_4.5_Sonnet;2;10;"WITH flattened_districts AS (
    SELECT 
        data:city::STRING AS city,
        data:country::STRING AS country,
        district.value:area_km2::DECIMAL AS area_km2
    FROM cities_pop,
    LATERAL FLATTEN(input => data:districts) AS district
),
city_total_area AS (
    SELECT 
        city,
        country,
        SUM(area_km2) AS total_area_km2
    FROM flattened_districts
    GROUP BY city, country
)
SELECT 
    city,
    country,
    total_area_km2
FROM city_total_area
ORDER BY total_area_km2 DESC;";22;514;74;14;20;39;35;34;74;376,47;12,25;4611,79;256,21;2;0;1;1;2;6;11,73;10,5;97;11;1,78;0,44
468;A;-1;Claude_4.5_Sonnet;3;10;"SELECT data:city AS city, SUM(data:districts[].area_km2) AS total_area
FROM cities_pop
GROUP BY city
ORDER BY total_area DESC;";4;126;23;12;7;14;9;19;23;97,7;7,71;753,7;41,87;0;0;1;0;1;0;3,73;2,5;0;0;0,0;0,0
469;B;-1;Claude_4.5_Sonnet;0;10;"SELECT data:furnishingstatus AS furnishing_status, 
       data:price::FLOAT AS price
FROM house_price
WHERE data:price IS NOT NULL
ORDER BY price DESC
LIMIT 3;";6;160;24;12;9;13;11;21;24;105,42;7,33;773,05;42,95;0;0;0;0;0;0;3,67;1,0;38;7;1,68;0,42
470;B;-1;Claude_4.5_Sonnet;1;10;"SELECT data:furnishingstatus AS furnishing_status, 
       data:price::FLOAT AS price
FROM house_price
WHERE data:price IS NOT NULL
ORDER BY price DESC
LIMIT 3;";6;160;24;12;9;13;11;21;24;105,42;7,33;773,05;42,95;0;0;0;0;0;0;3,67;1,0;38;7;1,68;0,42
471;B;-1;Claude_4.5_Sonnet;2;10;"SELECT 
    furnishingstatus,
    price,
    ROW_NUMBER() OVER (PARTITION BY furnishingstatus ORDER BY price DESC) AS house_rank
FROM (
    SELECT 
        data:furnishingstatus::STRING AS furnishingstatus,
        data:price::FLOAT AS price
    FROM house_price,
    LATERAL FLATTEN(INPUT => data)
    WHERE data:furnishingstatus IS NOT NULL
      AND data:price IS NOT NULL
)
QUALIFY house_rank <= 3
ORDER BY furnishingstatus, price DESC;";15;440;67;20;16;40;27;36;67;346,38;16,88;5845,25;324,74;1;1;0;0;2;6;11,92;6,5;88;11;1,74;0,43
472;B;-1;Claude_4.5_Sonnet;3;10;"SELECT data:furnishingstatus::STRING furnishingstatus,data:price::FLOAT price,ROW_NUMBER() OVER(PARTITION BY data:furnishingstatus ORDER BY data:price DESC) rnk FROM house_price WHERE data:furnishingstatus IS NOT NULL AND data:price IS NOT NULL QUALIFY rnk<=3 ORDER BY furnishingstatus,price DESC;";1;297;48;17;12;27;21;29;48;233,18;14,88;3468,6;192,7;0;1;0;0;1;3;7,97;3,5;74;8;1,7;0,42
473;C;-1;Claude_4.5_Sonnet;0;10;"SELECT 
    ind.value::STRING as industry,
    COUNT(*) as billionaire_count
FROM forbes,
LATERAL FLATTEN(input => data:industries) ind
GROUP BY industry
ORDER BY billionaire_count DESC;";7;186;35;15;12;20;15;27;35;166,42;9,38;1560,2;86,68;0;0;1;0;1;0;5,83;2,5;41;8;1,9;0,49
474;C;-1;Claude_4.5_Sonnet;1;10;"SELECT 
    f.value::STRING AS industry,
    COUNT(*) AS billionaire_count
FROM forbes,
LATERAL FLATTEN(input => data:industries) f
GROUP BY industry
ORDER BY billionaire_count DESC;";7;182;35;15;12;20;15;27;35;166,42;9,38;1560,2;86,68;0;0;1;0;1;0;5,82;2,5;41;8;1,9;0,49
475;C;-1;Claude_4.5_Sonnet;2;10;"WITH flattened_industries AS (
    SELECT 
        ind.value::STRING AS industry_name
    FROM forbes,
    LATERAL FLATTEN(input => data:industries) ind
)
SELECT 
    industry_name,
    COUNT(*) AS billionaire_count
FROM flattened_industries
GROUP BY industry_name
ORDER BY billionaire_count DESC;";12;297;44;15;14;25;19;29;44;213,75;10,18;2175,68;120,87;1;0;1;1;2;3;7,49;7,5;51;11;1,79;0,45
476;C;-1;Claude_4.5_Sonnet;3;10;"SELECT f.value::STRING industry,COUNT(*) cnt FROM forbes,LATERAL FLATTEN(INPUT=>data:industries) f GROUP BY 1 ORDER BY cnt DESC;";1;128;33;14;13;18;15;27;33;156,91;8,08;1267,36;70,41;0;0;1;0;1;0;5,24;2,5;40;8;1,95;0,5
477;D;-1;Claude_4.5_Sonnet;0;10;"WITH ranked_temps AS (
    SELECT 
        data:WindGustDir::STRING AS wind_direction,
        data:Temp3pm::FLOAT AS afternoon_temp,
        data:Date::DATE AS date,
        ROW_NUMBER() OVER (PARTITION BY data:WindGustDir::STRING ORDER BY data:Temp3pm::FLOAT DESC) AS rank
    FROM weather
    WHERE wind_direction IS NOT NULL
)
SELECT * FROM ranked_temps 
WHERE rank <= 3
ORDER BY wind_direction, rank;";12;405;64;19;14;38;26;33;64;322,84;17,64;5695,84;316,44;1;1;0;1;2;5;10,45;8,5;83;12;1,71;0,42
478;D;-1;Claude_4.5_Sonnet;1;10;"SELECT * FROM (
    SELECT data:WindGustDir::STRING AS wind_dir, data:Temp3pm::FLOAT AS temp,
           ROW_NUMBER() OVER (PARTITION BY data:WindGustDir::STRING ORDER BY data:Temp3pm::FLOAT DESC) AS rank
    FROM weather WHERE wind_dir IS NOT NULL
) WHERE rank <= 3 ORDER BY wind_dir;";5;285;52;19;10;33;19;29;52;252,62;18,05;4559,7;253,32;1;1;0;0;2;5;8,81;6,5;65;12;1,68;0,42
479;D;-1;Claude_4.5_Sonnet;2;10;"WITH AfternoonTemps AS (
    SELECT data:WindGustDir::STRING AS wind_dir, data:Temp3pm::FLOAT AS temp3pm FROM weather
),
RankedTemps AS (
    SELECT wind_dir, temp3pm,
           ROW_NUMBER() OVER (PARTITION BY wind_dir ORDER BY temp3pm DESC) AS temp_rank
    FROM AfternoonTemps WHERE wind_dir IS NOT NULL
)
SELECT * FROM RankedTemps WHERE temp_rank <= 3;";9;356;60;18;14;37;23;32;60;300,0;14,79;4435,71;246,43;2;1;0;1;2;8;10,51;11,5;65;10;1,64;0,4
480;D;-1;Claude_4.5_Sonnet;3;10;"SELECT * FROM (SELECT data:WindGustDir::S d, data:Temp3pm::F t, ROW_NUMBER() OVER(PARTITION BY d ORDER BY t DESC) r FROM weather WHERE d IS NOT NULL) WHERE r<=3;";1;161;42;17;11;26;16;28;42;201,91;12,36;2496,33;138,68;1;1;0;0;2;5;7,24;6,5;0;0;0,0;0,0
481;A;1;student;-1;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date TIMESTAMP,
    unit_price NUMBER(10,2),
    customer_id INT,
    country STRING
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'csv'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;";26;595;94;13;41;43;51;54;94;540,96;8,09;4373,85;242,99;0;0;0;0;2;3;15,22;1,0;32;6;2,21;0,56
482;A;2;student;-1;1;"USE WAREHOUSE HYENA_WH;
CREATE OR REPLACE SCHEMA zapocet;
USE SCHEMA zapocet;

CREATE OR REPLACE TABLE retail(
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date DATETIME,
    unit_price NUMBER(10,10),
    customer_id INT AUTOINCREMENT PRIMARY KEY,
    country STRING   
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';";30;704;111;13;48;48;63;61;111;658,31;8,53;5616,22;312,01;0;0;0;0;2;4;17,47;1,0;4;3;1,5;0,5
483;A;3;student;-1;1;"CREATE OR REPLACE FILE FORMAT retail_format
 TYPE='CSV'
 FIELD_DELIMITER=';'
 SKIP_HEADER=1
 NULL_IF=('NULL','null')
 EMPTY_FIELD_AS_NULL=TRUE
 TIMESTAMP_FORMAT='DD.MM.YYYY HH24 MI';

CREATE STAGE stork_db.zapocet.retail_stage
 FILE_FORMAT=retail_format;

CREATE OR REPLACE TABLE retail(
 invoice_no INT,
 stock_code STRING,
 description STRING,
 quantity INT,
 invoice_date STRING,
 unit_price FLOAT,
 customer_id INT,
 country STRING
);

COPY INTO retail 
 FROM @retail_stage/online_retail.csv 
 FILE_FORMAT=(FORMAT_NAME=retail_format)
 ON_ERROR=CONTINUE;";26;557;91;13;40;41;50;53;91;521,24;8,12;4235,08;235,28;0;0;0;0;1;2;14,67;1,0;24;5;2,3;0,58
484;A;4;student;-1;1;"CREATE OR REPLACE TABLE retail(
    invoice_no INT AUTOINCREMENT PRIMARY KEY,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date DATETIME,
    unit_price NUMBER(10,2),
    customer_id INT,
    country STRING
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';
  

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;

  SELECT * FROM retail LIMIT 25;";29;656;104;16;45;48;56;61;104;616,8;9,96;6140,55;341,14;0;0;0;0;2;3;16,78;1,0;36;6;2,19;0,56
485;A;5;student;-1;1;"USE WAREHOUSE LIZARD_WH;
USE DATABASE LIZARD_DB;
USE ROLE TRAINING_ROLE;

CREATE OR REPLACE SCHEMA LIZARD_DB.Test_01;
USE SCHEMA LIZARD_DB.Test_01;

CREATE OR REPLACE TABLE retail(
invoice_no INT AUTOINCREMENT PRIMARY KEY,
stock_code STRING,
description STRING,
quantity INT,
invoice_date DATETIME,
unit_price NUMBER(10,2),
customer_id INT,
country STRING
);

CREATE OR REPLACE FILE FORMAT my_format
TYPE = 'CSV'
FIELD_DELIMITER = ';'
SKIP_HEADER = 1
NULL_IF = ('NULL', 'null')
EMPTY_FIELD_AS_NULL = TRUE
TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';


CREATE OR REPLACE STAGE my_stage
FILE_FORMAT = my_format;

COPY INTO retail
FROM @my_stage/online_retail.csv
FILE_FORMAT = (FORMAT_NAME = my_format)
ON_ERROR = CONTINUE;";34;717;123;13;53;52;71;66;123;743,46;8,71;6473,72;359,65;0;0;0;0;2;4;19,01;1,0;4;3;1,5;0,5
486;A;6;student;-1;1;"USE WAREHOUSE JACKAL_WH;
USE DATABASE JACKAL_DB;
CREATE OR REPLACE SCHEMA JACKAL_DB.TEST;
USE SCHEMA JACKAL_DB.TEST;

CREATE OR REPLACE FILE FORMAT my_format
TYPE = 'CSV'
FIELD_DELIMITER = ';'
SKIP_HEADER = 1
NULL_IF = ('NULL','null')
EMPTY_FIELD_AS_NULL = TRUE
TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
FILE_FORMAT = my_format;

CREATE OR REPLACE TABLE retail(
invoice_no int,
stock_code STRING,
description STRING,
quantity int,
invoice_date DATE,
unit_price NUMBER(10,2),
customer_id INT,
country STRING
);
COPY INTO retail
FROM @my_stage/online_retail.csv
FILE_FORMAT = (FORMAT_NAME = my_format)
ON_ERROR = 'CONTINUE';";30;655;116;13;48;51;65;61;116;687,97;8,8;6055,53;336,42;0;0;0;0;2;4;18,13;1,0;4;3;1,5;0,5
487;A;7;student;-1;1;"CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

CREATE OR REPLACE TABLE retail (
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date DATETIME,
    unit_price NUMBER(10,2),
    customer_id INT,
    country STRING
);

COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = 'my_format')
  ON_ERROR = CONTINUE;";26;596;94;13;42;43;51;55;94;543,45;7,89;4289,36;238,3;0;0;0;0;2;3;15,14;1,0;24;5;2,3;0,58
488;A;8;student;-1;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date DATETIME,
    unit_price NUMBER(10,2),
    customer_id INT,
    country STRING
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

  CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;


  COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = ""CONTINUE"";";27;601;94;13;41;43;51;54;94;540,96;8,09;4373,85;242,99;0;0;0;0;2;3;15,15;1,0;32;6;2,21;0,56
489;A;1;student;-1;2;"SELECT customer_id, invoice_date, (quantity * unit_price) AS amount, 
    SUM(amount) OVER (
        PARTITION BY customer_id
        ORDER BY invoice_date
        RANGE BETWEEN INTERVAL '14 DAY' PRECEDING AND CURRENT ROW
    ) AS last14d_sum
FROM retail;";7;255;39;19;9;27;12;28;39;187,49;12,67;2374,83;131,94;0;1;1;0;1;3;7,21;5,0;32;7;1,55;0,38
490;A;2;student;-1;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price AS amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date
        RANGE BETWEEN INTERVAL '14 DAYS' PRECEDING AND CURRENT ROW
    ) AS last14d_sum
FROM retail
ORDER BY customer_id, invoice_date;";11;317;44;19;9;29;15;28;44;211,52;15,83;3349,12;186,06;0;1;1;0;1;3;7,97;5,0;41;7;1,54;0,37
491;A;4;student;-1;2;"SELECT 
    customer_id,
    invoice_date,
    quantity * unit_price AS amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date 
        RANGE BETWEEN INTERVAL '14' PRECEDING AND CURRENT ROW
    ) AS last14d_sum
FROM retail
ORDER BY customer_id, invoice_date;";11;313;44;19;9;29;15;28;44;211,52;15,83;3349,12;186,06;0;1;1;0;1;3;7,97;5,0;41;7;1,54;0,37
492;A;5;student;-1;2;"SELECT
customer_id,
invoice_date,
quantity * unit_price AS amount,
SUM(quantity * unit_price)
OVER (PARTITION BY customer_id 
ORDER BY invoice_date 
ROWS BETWEEN 14 PRECEDING AND CURRENT ROW) AS LAST14D_SUM
FROM retail
ORDER BY customer_id, invoice_date;";10;254;43;19;8;29;14;27;43;204,46;16,62;3399,15;188,84;0;1;1;0;1;3;7,77;5,0;39;7;1,52;0,36
493;A;6;student;-1;2;"SELECT customer_id,invoice_date,unit_price as amount,
    SUM(quantity * unit_price) OVER (
        PARTITION BY customer_id
        ORDER BY invoice_date
        RANGE BETWEEN INTERVAL '14 DAY' PRECEDING AND CURRENT ROW
)
as LAST14D_SUM
FROM retail";8;249;36;18;9;24;12;27;36;171,18;12,0;2054,11;114,12;0;1;1;0;1;3;6,6;5,0;31;7;1,58;0,39
494;A;7;student;-1;2;"SELECT customer_id, invoice_date, quantity * unit_price AS amount,
    SUM(quantity * unit_price) OVER(
        PARTITION BY customer_id
        ORDER BY invoice_date
        ROWS BETWEEN INTERVAL '14 DAY' PRECEDING AND CURRENT ROW
    ) AS last14d_sum
FROM retail
ORDER BY customer_id, invoice_date;";8;300;44;19;9;29;15;28;44;211,52;15,83;3349,12;186,06;0;1;1;0;1;3;7,94;5,0;41;7;1,54;0,37
495;A;8;student;-1;2;"SELECT customer_id, invoice_date, unit_price AS amount,
       SUM(amount * QUANTITY) OVER (PARTITION BY customer_id ORDER BY invoice_date
RANGE BETWEEN INTERVAL '13 DAY' PRECEDING AND CURRENT ROW
) as LAST14D_SUM
FROM retail;";5;226;37;19;9;25;12;28;37;177,87;12,67;2253,05;125,17;0;1;1;0;1;3;6,75;5,0;31;7;1,58;0,39
496;A;1;student;-1;3;"SELECT customer_id, invoice_no, invoice_date,
    LAG(invoice_date) OVER (
        PARTITION BY customer_id
        ORDER BY invoice_date
    ) AS next_date,
    DATEDIFF('day', next_date, invoice_date) AS days_to_next
FROM retail
ORDER BY days_to_next DESC;";8;258;40;12;9;25;15;21;40;175,69;10,0;1756,93;97,61;0;1;0;0;1;2;6,76;3,5;34;7;1,57;0,38
497;A;4;student;-1;3;"WITH NextPurchase AS (
  SELECT 
    customer_id,
    invoice_no,
    invoice_date,
    LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date) as next_date,
    DATEDIFF('day', invoice_date, LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date)) as days_to_next
  FROM retail
  WHERE quantity > 0
)
SELECT 
  customer_id,
  invoice_no,
  invoice_date,
  next_date,
  days_to_next
FROM NextPurchase
WHERE days_to_next IS NOT NULL
ORDER BY days_to_next DESC;";19;493;78;17;13;50;28;30;78;382,74;18,31;7007,04;389,28;1;2;0;1;3;9;13,61;11,0;71;11;1,56;0,37
498;A;5;student;-1;3;"SELECT 
customer_id, 
invoice_no, 
invoice_date, 
LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date) AS next_date, 
DATEDIFF(DAY, invoice_date, LEAD(invoice_date) OVER (PARTITION BY customer_id ORDER BY invoice_date)) AS days_to_next 
FROM retail 
WHERE invoice_date IS NOT NULL 
ORDER BY days_to_next DESC;";9;329;57;16;9;39;18;25;57;264,7;16,0;4235,2;235,29;0;2;0;0;2;4;10,17;6,0;48;8;1,52;0,35
499;A;4;student;-1;4;"SELECT 
  customer_id,
  SUM(quantity * unit_price) as total_amount,
  NTILE(4) OVER (ORDER BY total_amount DESC) as quartile
FROM retail
GROUP BY customer_id
ORDER BY total_amount DESC;";7;186;35;14;8;23;12;22;35;156,08;10,5;1638,84;91,05;0;1;1;0;1;2;5,97;5,0;30;7;1,45;0,33
500;A;5;student;-1;4;"WITH Customer_Revenue AS ( 
SELECT 
customer_id, 
SUM(quantity * unit_price) AS revenue 
FROM retail 
GROUP BY customer_id 
), 
Revenue_Rank AS ( 
SELECT 
customer_id, 
revenue, 
NTILE(4) OVER (ORDER BY revenue DESC) AS revenue_quartile 
FROM Customer_Revenue 
) 
SELECT customer_id, revenue, revenue_quartile
FROM Revenue_Rank ORDER BY revenue DESC;";16;350;59;14;11;37;22;25;59;273,99;14,0;3835,83;213,1;2;1;1;1;2;8;10,14;13,0;55;10;1,5;0,35
501;A;6;student;-1;4;"WITH customer_revenue AS (
    SELECT 
        customer_id,
        SUM(quantity * unit_price) AS revenue
    FROM retail
    GROUP BY customer_id
)
SELECT 
    customer_id,
    revenue,
    NTILE(4) OVER (ORDER BY revenue DESC) AS revenue_quartile
FROM customer_revenue
ORDER BY revenue DESC;";13;293;46;14;10;29;17;24;46;210,91;11,9;2509,81;139,43;1;1;1;1;2;5;7,91;10,0;42;9;1,46;0,33
502;A;1;student;-1;5;"WITH rn AS (
    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY customer_id
            ORDER BY invoice_date ASC
        ) AS row_num
    FROM retail
)
SELECT row_num, customer_id, invoice_no, invoice_date, (quantity * unit_price) AS amount
FROM rn
WHERE row_num = 1
ORDER BY customer_id;";12;305;51;15;12;33;18;27;51;242,5;11,25;2728,12;151,56;1;1;0;1;2;5;8,96;8,5;48;10;1,57;0,38
503;A;4;student;-1;5;"SELECT 
  ROW_NUMBER() OVER (ORDER BY customer_id) AS NUM,
  customer_id,
  invoice_no,
  invoice_date,
  SUM(quantity * unit_price) AS amount
FROM retail
WHERE (customer_id, invoice_date) IN (
  SELECT 
    customer_id, 
    MIN(invoice_date)
  FROM retail 
  GROUP BY customer_id
)
GROUP BY customer_id, invoice_no, invoice_date
ORDER BY customer_id;";16;352;61;17;8;42;19;25;61;283,28;20,19;5718,62;317,7;1;1;2;0;2;5;11,01;9,5;57;8;1,51;0,35
504;A;5;student;-1;5;"SELECT
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY invoice_date) AS num, 
customer_id, 
invoice_no, 
invoice_date, 
quantity * unit_price AS amount 
FROM retail
QUALIFY ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY invoice_date) = 1 
ORDER BY customer_id;";9;271;48;14;10;33;15;24;48;220,08;10,5;2310,82;128,38;0;2;0;0;1;4;8,53;6,0;42;8;1,58;0,38
505;A;6;student;-1;5;"WITH FirstPurchases AS (
    SELECT customer_id,invoice_no,invoice_date,quantity as amount,
        ROW_NUMBER() OVER (
        PARTITION BY customer_id 
        ORDER BY invoice_date ASC) AS rn
    FROM retail
)
SELECT 
    1 AS NUM, 
    customer_id, 
    invoice_no, 
    invoice_date, 
    amount
FROM FirstPurchases
WHERE rn = 1
ORDER BY customer_id;";16;355;55;14;12;33;22;26;55;258,52;12,83;3317,73;184,32;1;1;0;1;2;5;9,3;8,5;52;10;1,65;0,4
506;A;8;student;-1;5;"SELECT row_number() over (partition by customer_id order by customer_id) as num, customer_id, invoice_no, invoice_date,
sum(quantity*unit_price) OVER  (PARTITION BY customer_id ORDER BY customer_id desc ) as amount
from retail;
";4;228;43;14;9;30;13;23;43;194,51;10,11;1966,74;109,26;0;2;1;0;1;4;7,62;7,5;35;7;1,55;0,37
507;A;1;student;-1;6;"WITH rn AS (
    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY country, DATE_TRUNC('month', invoice_date)
            ORDER BY (quantity * unit_price) DESC
        ) AS row_num
    FROM retail
)
SELECT country, DATE_TRUNC('month', invoice_date) AS month, customer_id, (quantity * unit_price) AS revenue, row_num
FROM rn
WHERE row_num <= 5
ORDER BY country, month, row_num, customer_id;";12;402;75;15;15;47;28;30;75;368,02;14,0;5152,24;286,24;1;1;0;1;3;7;12,89;8,5;69;12;1,58;0,38
508;A;4;student;-1;6;"SELECT 
    country,
    DATE_TRUNC('MONTH', invoice_date) as month,
    customer_id,
    SUM(quantity * unit_price) as amount,
    ROW_NUMBER() OVER (PARTITION BY country, DATE_TRUNC('MONTH', invoice_date) ORDER BY SUM(quantity * unit_price) DESC) as rank
FROM retail
GROUP BY country, month, customer_id
QUALIFY rank <= 5
ORDER BY country, month, rank, customer_id;";10;367;73;17;13;48;25;30;73;358,2;16,35;5855,24;325,29;0;1;2;0;2;2;12,66;6,5;65;9;1,6;0,38
509;A;5;student;-1;6;"WITH Monthly_Revenue AS (
SELECT
country,
TO_CHAR(invoice_date, 'YYYY-MM') AS month,
customer_id,
SUM(quantity * unit_price) AS revenue
FROM retail
GROUP BY country, month, customer_id
),
Ranked_Revenue AS (
SELECT
country,
month,
customer_id,
revenue,
RANK() OVER (PARTITION BY country, month ORDER BY revenue DESC) AS rank
FROM Monthly_Revenue
)
SELECT
country,
month,
customer_id,
revenue,
rank
FROM Ranked_Revenue
WHERE rank <= 5
ORDER BY country, month, rank, customer_id;";27;477;95;17;15;61;34;32;95;475,0;19,27;9151,67;508,43;2;1;1;1;2;8;16,52;13,0;92;10;1,62;0,39
510;A;6;student;-1;6;"WITH monthly_revenue AS (
    SELECT
        country,
        TO_CHAR(DATE_TRUNC('MONTH', invoice_date), 'YYYY-MM') AS month,
        customer_id,
        SUM(quantity * unit_price) AS revenue
    FROM retail
    GROUP BY
        country,
        TO_CHAR(DATE_TRUNC('MONTH', invoice_date), 'YYYY-MM'),
        customer_id
),
ranked_customers AS (
    SELECT
        country,
        month,
        customer_id,
        revenue,
        RANK() OVER (
            PARTITION BY country, month
            ORDER BY revenue DESC
        ) AS rank_in_month
    FROM monthly_revenue
)
SELECT
    country,
    month,
    customer_id,
    revenue,
    rank_in_month
FROM ranked_customers
WHERE rank_in_month <= 5
ORDER BY country, month, rank_in_month, customer_id;";33;756;110;17;18;66;44;35;110;564,22;20,78;11723,26;651,29;2;1;1;1;3;10;18,64;13,0;98;10;1,64;0,4
511;A;1;student;-1;7;"CREATE OR REPLACE TABLE cities_pop (data VARIANT);

CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'json'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = (FORMAT_NAME = json_format);

COPY INTO cities_pop
  FROM @json_stage/cities_population.json
  FILE_FORMAT = json_format;";12;311;49;12;18;25;24;30;49;240,44;8,0;1923,5;106,86;0;0;0;0;1;3;8,7;1,0;7;4;1,5;0,43
512;A;2;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = ',';

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = json_format ;

COPY INTO cities_pop
  FROM @json
  FILE_FORMAT =";10;201;29;6;14;12;17;20;29;125,34;3,64;456,58;25,37;0;0;0;0;0;2;4,94;1,0;10;4;1,8;0,5
513;A;4;student;-1;7;"CREATE OR REPLACE TABLE cities_pop(
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = json_format;

COPY INTO cities_pop
  FROM 
  FILE_FORMAT = js;";14;257;40;10;15;20;20;25;40;185,75;6,67;1238,36;68,8;0;0;0;0;1;3;7,2;1,0;7;4;1,5;0,43
514;A;5;student;-1;7;"CREATE OR REPLACE TABLE cities_pop (
data VARIANT
);

CREATE OR REPLACE FILE FORMAT json_format
TYPE = 'JSON'
STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
FILE_FORMAT = json_format;

COPY INTO cities_pop
FROM @json_stage/cities_population.json
FILE_FORMAT = json_format;";14;287;45;12;17;22;23;29;45;218,61;8,12;1774,59;98,59;0;0;0;0;1;3;7,82;1,0;7;4;1,5;0,43
515;A;6;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
TYPE = 'JSON'
STRIP_OUTER_ARRAY = ' '

CREATE OR REPLACE STAGE json_stage
FILE_FORMAT = json_format;

COPY INTO cities_pop 
FROM @json_stage/cities_population.json
FILE_FORMAT = json_format";10;231;33;8;16;13;20;24;33;151,3;5,0;756,52;42,03;0;0;0;0;0;2;5,44;1,0;1;1;0,0;1,0
516;A;7;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'json'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = json_format;

CREATE OR REPLACE TABLE cities_pop(data VARIANT);

COPY INTO cities_pop
  FROM @json_stage/cities_population.json
  FILE_FORMAT = json_format;";12;294;45;12;17;22;23;29;45;218,61;8,12;1774,59;98,59;0;0;0;0;1;3;7,84;1,0;10;4;1,8;0,5
517;A;8;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = json_format;

 CREATE OR REPLACE TABLE cities_pop (data VARIANT);

COPY INTO cities_pop
  FROM @json_stage/cities_population.json
  FILE_FORMAT = json_format;";12;296;45;12;17;22;23;29;45;218,61;8,12;1774,59;98,59;0;0;0;0;1;3;7,84;1,0;10;4;1,8;0,5
518;A;1;student;-1;8;"SELECT data:rank::INT as rank, data:city::STRING as city, data:""2025_population""::STRING as pop2025
  FROM cities_pop
  WHERE data:country::STRING = 'India';";3;157;28;8;12;11;17;20;28;121,01;5,67;685,75;38,1;0;0;0;0;0;0;3,34;1,0;45;7;1,83;0,47
519;A;5;student;-1;8;"SELECT 
data:rank::INT AS RANK,
data:city::STRING AS CITY,
data:""2025_population""::STRING AS POP2025
FROM cities_pop
WHERE data:country::STRING = 'India'
ORDER BY RANK;";7;168;31;10;12;14;17;22;31;138,24;7,08;979,22;54,4;0;0;0;0;0;0;3,97;1,0;49;7;1,78;0,45
520;A;7;student;-1;8;"SELECT 
    data:rank::int AS RANK,
    data:city::string AS CITY,
    data:""2025_population""::string AS POP2025
FROM cities_pop
WHERE data:country::string LIKE 'India'
ORDER BY RANK;";7;183;31;10;12;14;17;22;31;138,24;7,08;979,22;54,4;0;0;0;0;0;0;4,0;1,0;49;7;1,78;0,45
521;A;1;student;-1;9;"SELECT data:country::STRING AS country, COUNT(*) AS city_count
  FROM cities_pop
  GROUP BY country
  ORDER BY city_count DESC;";4;127;23;12;7;14;9;19;23;97,7;7,71;753,7;41,87;0;0;1;0;1;0;3,73;2,5;25;6;1,6;0,4
522;A;5;student;-1;9;"SELECT 
data:country::STRING AS COUNTRY,
COUNT(*) AS CITY_COUNT
FROM cities_pop
GROUP BY COUNTRY
ORDER BY CITY_COUNT DESC;";6;122;23;12;7;14;9;19;23;97,7;7,71;753,7;41,87;0;0;1;0;1;0;3,72;2,5;25;6;1,6;0,4
523;A;7;student;-1;9;"SELECT 
    data:country::string AS COUNTRY,
    COUNT(data:city::string) AS CITY_COUNT
FROM cities_pop
GROUP BY COUNTRY
ORDER BY CITY_COUNT DESC;";6;146;25;11;8;13;12;19;25;106,2;8,25;876,14;48,67;0;0;1;0;1;0;3,65;2,5;32;7;1,63;0,41
524;A;5;student;-1;10;"SELECT 
data:city::STRING AS CITY,
SUM(district.value:area_km2::FLOAT) AS AREA
FROM cities_pop,
LATERAL FLATTEN(input => data:districts) AS district
GROUP BY CITY
ORDER BY AREA DESC;";7;182;38;14;14;20;18;28;38;182,68;9,0;1644,12;91,34;0;0;1;0;1;0;5,82;2,5;52;8;1,89;0,48
525;A;7;student;-1;10;"SELECT 
    data:city::STRING AS CITY,
    SUM(f.value:area_km2::NUMBER(10,2)) AS AREA
FROM cities_pop,
LATERAL FLATTEN (input => TO_ARRAY(data:districts)) f
GROUP BY CITY
ORDER BY AREA DESC;";7;191;45;14;17;24;21;31;45;222,94;8,65;1927,77;107,1;0;0;1;0;2;0;6,72;2,5;57;9;1,81;0,46
526;B;9;student;-1;1;"CREATE OR REPLACE FILE FORMAT csv_format
    TYPE = 'csv'
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1
    NULL_IF = ('NULL', 'null')
    EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE games_stage
    FILE_FORMAT = csv_format;

CREATE OR REPLACE TABLE games (
    id INT,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales NUMBER(12, 2),
    eu_sales NUMBER(12, 2),
    jp_sales NUMBER(12, 2),
    other_sales NUMBER(12, 2),
    global_sales NUMBER(12, 2)
);


COPY INTO games
    FROM @games_stage/video_game_sales.csv
    FILE_FORMAT = csv_format
    ON_ERROR = CONTINUE;

SELECT * FROM games LIMIT 10;";31;665;123;16;41;59;64;57;123;717,45;12,49;8959,32;497,74;0;0;0;0;2;3;18,78;1,0;21;5;2,22;0,57
527;B;10;student;-1;1;"CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

CREATE OR REPLACE TABLE games (
    id INT,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales NUMBER(10, 2),
    eu_sales NUMBER(10, 2),
    jp_sales NUMBER(10, 2),
    other_sales NUMBER(10, 2),
    global_sales NUMBER(10, 2)
);

COPY INTO games
  FROM @my_stage
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;

SELECT * FROM games
LIMIT 5;;";31;632;124;14;40;61;63;54;124;713,61;11,03;7867,51;437,08;0;0;0;0;2;3;19,18;1,0;21;5;2,22;0,57
528;B;11;student;-1;1;"create or replace table games(
    id int,
    name varchar(100),
    platform varchar(50),
    year INT,
    genre varchar(50),
    publisher varchar(50),
    na_sales decimal(10,2),
    eu_sales decimal(10,2),
    jp_sales decimal(10,2),
    other_sales decimal(10,2),
    global_sales decimal(10,2)
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;

select * from games;";30;643;133;13;41;67;66;54;133;765,4;10,46;8008,7;444,93;0;0;0;0;2;3;20,41;1,0;65;6;1,73;0,43
529;B;12;student;-1;1;"USE WAREHOUSE LOBSTER_WH;
CREATE OR REPLACE SCHEMA LOBSTER_db.zapocet;
USE SCHEMA LOBSTER_db.zapocet;

CREATE OR REPLACE TABLE games(
    id INT AUTOINCREMENT PRIMARY KEY,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales NUMBER(10,2),
    eu_sales NUMBER(10,2),
    jp_sales NUMBER(10,2),
    other_sales NUMBER(10,2),
    global_sales NUMBER(10,2)
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;

SELECT * FROM games
LIMIT 10;";35;776;148;16;50;69;79;66;148;894,57;12,64;11307,37;628,19;0;0;0;0;2;4;22,5;1,0;4;3;1,5;0,5
530;B;13;student;-1;1;"CREATE or Replace File Format my_format
    Type = 'CSV'
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1
    NULL_IF = ('NULL', 'NULL')
    EMPTY_FIELD_AS_NULL = TRUE;

Create Or Replace STAGE my_stage
    File_Format = my_format;

Create Or Replace Table games(
    ID int,
    Name string,
    Platform string,
    Year int,
    Genre string,
    Publisher string,
    NA_Sales number(10,2),
    EU_Sales number(10,2),
    JP_Sales number(10,2),
    Other_Sales number(10,2),
    Global_Sales number(10,2)
);

COPY INTO games
    From @my_stage/video_game_sales.csv
    File_Format  = (FORMAT_NAME = my_format)
    ON_ERROR = 'Continue';

SELECT * From games;";30;659;125;15;40;61;64;55;125;722,67;12,0;8672,04;481,78;0;0;0;0;2;3;19,32;1,0;21;5;2,22;0,57
531;B;14;student;-1;1;"USE WAREHOUSE KOALA_WH;
USE DATABASE KOALA_DB;
USE ROLE TRAINING_ROLE;

CREATE OR REPLACE SCHEMA KOALA_DB.TEST01;
USE SCHEMA TEST01;


CREATE OR REPLACE TABLE games(
    id INT AUTOINCREMENT PRIMARY KEY,
    name STRING,
    platform STRING,
    year NUMBER(4,0),
    genre STRING,
    publisher STRING,
    na_sales NUMBER(10,2),
    eu_sales NUMBER(10,2),
    jp_sales NUMBER(10,2),
    other_sales NUMBER(10,2),
    global_sales NUMBER(10,2)
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;

  SELECT * FROM games LIMIT 5;";38;817;159;16;56;73;86;72;159;981,02;12,29;12052,51;669,58;0;0;0;0;2;4;23,78;1,0;4;3;1,5;0,5
532;B;15;student;-1;1;"CREATE OR REPLACE TABLE video_game_sales(
    ID INT AUTOINCREMENT PRIMARY KEY,
    Name STRING,
    Platform STRING,
    Year STRING,
    Genre STRING,
    Publisher STRING,
    NA_Sales NUMBER(10,2),
    EU_Sales NUMBER(10,2),
    JP_Sales NUMBER(10,2),
    Other_Sales NUMBER(10,2),
    Global_Sales NUMBER(10,2)
)

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;";28;655;122;13;44;56;66;57;122;711,61;9,75;6938,22;385,46;0;0;0;0;2;3;18,43;1,0;1;1;0,0;1,0
533;B;16;student;-1;1;"USE WAREHOUSE WOMBAT_SH;
USE DATABASE WOMBAT_DB;
CREATE OR REPLACE SCHEMA WOMBAT_DB.testb;
USE SCHEMA WOMBAT_DB.testb;

CREATE TABLE games(
    id INT,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales DOUBLE,
    eu_sales DOUBLE,
    jp_sales DOUBLE,
    other_sales DOUBLE,
    global_sales DOUBLE
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;";33;695;115;13;46;49;66;59;115;676,5;9,33;6309,13;350,51;0;0;0;0;1;3;17,91;1,0;4;3;1,5;0,5
534;B;9;student;-1;2;"SELECT platform, year,
    SUM(global_sales) OVER (
        PARTITION BY platform, year
        ORDER BY year
    ) AS year_sales,
    SUM(global_sales) OVER (
        PARTITION BY platform
        ORDER BY year
    ) AS last_3y_sales
FROM games
ORDER BY platform, year;";11;270;46;12;6;32;14;18;46;191,82;14,0;2685,43;149,19;0;2;2;0;1;4;8,18;9,0;41;7;1,48;0,34
535;B;10;student;-1;2;"SELECT platform, year, global_sales,
       SUM(global_sales) OVER (
         PARTITION BY platform
         ORDER BY year
         RANGE BETWEEN CURRENT ROW AND 3 FOLLOWING
       ) AS test
FROM GAMES
ORDER BY platform, year;";8;226;37;18;6;26;11;24;37;169,64;16,5;2799,12;155,51;0;1;1;0;1;3;6,87;5,0;31;7;1,5;0,35
536;B;11;student;-1;2;"SELECT 
    platform,
    year,
    SUM(global_sales) as YEAR_SALES,
    SUM(SUM(global_sales)) OVER (PARTITION BY platform ORDER BY year ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) as LAST_3Y_SALES
FROM games
GROUP BY platform, year
ORDER BY platform, year;";8;256;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,17;8,0;40;7;1,5;0,35
537;B;13;student;-1;2;"Select platform, year,
    SUM(global_sales) OVER(
        PARTITION BY platform
        ORDER BY platform
        RANGE between interval '12 MONTH' PRECEDING AND CURRENT ROW
        ) AS Year_Sales,
    SUM(global_sales) OVER(
        PARTITION BY platform
        ORDER BY platform
        RANGE between interval '36 MONTH' preceding and current row
    ) AS Last_3Y_sales
From games
order by platform, year;";13;410;60;18;9;43;17;27;60;285,29;17,0;4849,99;269,44;0;2;2;0;1;6;11,34;9,0;47;7;1,53;0,36
538;B;14;student;-1;2;"SELECT
    platform,
    year,
    SUM(global_sales) AS YEAR_SALES,
    SUM(SUM(global_sales)) OVER (
        PARTITION BY platform 
        ORDER BY year 
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
        ) AS THREE_YEAR_SALES
FROM games
GROUP BY platform, year
ORDER BY platform, year;";12;294;50;19;7;36;14;26;50;235,02;19,0;4465,42;248,08;0;1;3;0;2;3;9,25;8,0;40;7;1,5;0,35
539;B;15;student;-1;2;"with year_sales as (
    SELECT platform, year,
        SUM(global_sales) AS year_sales
    FROM video_game_sales
    GROUP BY platform, year
    ORDER BY platform, year
) SELECT platform, year, year_sales,
    SUM(year_sales) OVER (
    PARTITION BY platform
    ORDER BY year ASC
    ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
) AS last_3y_sales
FROM year_sales
ORDER BY platform, year;";14;386;66;19;9;43;23;28;66;317,29;24,28;7702,99;427,94;1;1;2;1;2;6;11,67;11,5;60;8;1,51;0,35
540;B;9;student;-1;3;"SELECT genre, year,
    SUM(global_sales) OVER (
        PARTITION BY genre
        ORDER BY year
    ) AS revenue,
        LAG(global_sales) OVER (
        PARTITION BY genre
        ORDER BY year
    ) AS prev_evenue,
    SUM(global_sales) - LAG(global_sales) OVER (
        PARTITION BY genre
        ORDER BY year
    ) AS difference
FROM games
ORDER BY genre, year;";15;370;65;14;7;47;18;21;65;285,5;18,0;5139,01;285,5;0;3;2;0;1;6;11,7;11,5;55;8;1,46;0,33
541;B;10;student;-1;3;"SELECT genre, year, global_sales as REVENUE,
    LAG(global_sales) OVER (PARTITION BY genre ORDER BY year) AS PREV_REVENUE,
    global_sales - LAG(global_sales) OVER (PARTITION BY genre ORDER BY year) AS DIFFERENCE
FROM GAMES
ORDER BY genre, year;";5;247;50;13;7;34;16;20;50;216,1;14,86;3210,58;178,37;0;2;0;0;1;4;8,69;6,0;46;8;1,5;0,35
542;B;11;student;-1;3;"SELECT
    genre,
    year,
    SUM(global_sales) AS REVENUE,
    LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) AS PREV_REVENUE,
    LAG(SUM(global_sales)) OVER (PARTITION BY genre ORDER BY year) - SUM(global_sales) AS DIFFERENCE
FROM games
GROUP BY genre,year
ORDER BY genre, year;";9;299;67;15;7;49;18;22;67;298,78;19,29;5762,22;320,12;0;2;4;0;2;4;11,96;12,0;55;8;1,46;0,33
543;B;14;student;-1;3;"SELECT
    genre AS GENRE,
    year AS YEAR,
    SUM(global_sales) AS REVENUE,
    LAG(SUM(global_sales)) OVER (
    PARTITION BY genre 
    ORDER BY year
    ) AS PREV_REVENUE,
    SUM(global_sales) - LAG(SUM(global_sales)) OVER (
    PARTITION BY genre 
    ORDER BY year) AS DIFFERENCE
FROM games
GROUP BY genre, year
ORDER BY genre, year;";14;342;71;15;7;51;20;22;71;316,62;21,43;6784,71;376,93;0;2;4;0;2;4;12,6;12,0;59;8;1,49;0,34
544;B;15;student;-1;3;"with rev as (
    SELECT genre, year,
        SUM(global_sales) AS revenue
    FROM video_game_sales
    GROUP BY genre, year
    ORDER BY genre, year
) SELECT genre, year, revenue,
    LAG(revenue) OVER (
        PARTITION BY genre
        ORDER BY year ASC
    ) AS prev_revenue,
    revenue - LAG(revenue) OVER (
        PARTITION BY genre
        ORDER BY year ASC
    ) AS difference
FROM rev
ORDER BY genre, year;";17;419;78;15;10;50;28;25;78;362,22;21,0;7606,64;422,59;1;2;1;1;2;7;13,32;12,5;73;8;1,5;0,34
545;B;9;student;-1;4;"SELECT year, name, global_sales,
    NTILE(4) OVER (
        PARTITION BY global_sales
        ORDER BY year DESC
    ) AS quartile_sales
FROM games
ORDER BY year DESC;";7;168;30;12;7;19;11;19;30;127,44;9,43;1201,56;66,75;0;1;0;0;1;2;5,06;3,5;25;7;1,5;0,36
546;B;11;student;-1;4;"SELECT
    year,
    name,
    global_sales,
    NTILE(4) OVER (PARTITION BY year ORDER BY global_sales) AS QUARTILE_SALES
FROM games
ORDER BY year DESC, global_sales DESC;";7;172;32;12;7;20;12;19;32;135,93;10,29;1398,17;77,68;0;1;0;0;1;2;5,34;3,5;28;7;1,5;0,36
547;B;12;student;-1;4;"SELECT
    year,
    name,
    global_sales,
    NTILE(4) OVER(
        PARTITION BY global_sales
        order by year DESc
    
    ) AS QUARTILE_SALES
FROM GAMES
ORDER BY YEAR desc,global_sales DESc,QUARTILE_SALES asc;";11;221;36;12;8;21;15;20;36;155,59;11,25;1750,38;97,24;0;1;0;0;1;2;5,88;3,5;31;7;1,5;0,35
548;B;14;student;-1;4;"WITH QuartileSales AS (
    SELECT 
        YEAR,
        NAME,
        GLOBAL_SALES,
        NTILE(4) OVER (PARTITION BY YEAR ORDER BY GLOBAL_SALES DESC) AS QUARTILE_SALES
    FROM games
)
SELECT YEAR, NAME, GLOBAL_SALES, QUARTILE_SALES
FROM QuartileSales
ORDER BY YEAR DESC, QUARTILE_SALES, GLOBAL_SALES DESC;";11;311;50;12;9;29;21;21;50;219,62;14,0;3074,62;170,81;1;1;0;1;2;5;8,26;8,5;47;10;1,53;0,36
549;B;15;student;-1;4;"with rev as (
    SELECT name, year,
        SUM(global_sales) AS revenue
    FROM video_game_sales
    GROUP BY name, year
    ORDER BY name, year
) SELECT name, year, revenue,
    NTILE(4) OVER (
        PARTITION BY year
        ORDER BY revenue DESC
    ) AS quartile_sales
FROM rev
ORDER BY year DESC, quartile_sales";13;321;59;13;10;36;23;23;59;266,89;14,95;3990,01;221,67;1;1;1;1;2;5;9,84;10,0;57;8;1,51;0,35
550;B;10;student;-1;5;"SELECT publisher, year, name, eu_sales,
    RANK() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) as num
FROM games
WHERE num <= 3
ORDER BY publisher, year, num;";5;173;40;14;8;25;15;22;40;178,38;13,12;2341,2;130,07;0;1;0;0;1;2;7,04;3,5;39;7;1,58;0,38
551;B;11;student;-1;5;"SELECT
    publisher,
    year,
    name,
    eu_sales,
    ROW_NUMBER() OVER (PARTITION BY publisher, year ORDER BY eu_sales DESC) AS NUM
FROM games
QUALIFY num <=3
ORDER BY publisher, year;";9;191;38;13;9;23;15;22;38;169,46;10,83;1835,8;101,99;0;1;0;0;1;2;6,67;3,5;36;7;1,59;0,39
552;B;12;student;-1;5;"SELECT
    publisher,
    year,
    name,
    eu_sales,
    RANK() OVER(
        PARTITION BY publisher
        order by year

    ) AS NUM
FROM GAMES
ORDER BY publisher,year,eu_sales DESC;";12;189;34;12;7;22;12;19;34;144,43;10,29;1485,56;82,53;0;1;0;0;1;2;5,86;3,5;32;7;1,55;0,38
553;B;14;student;-1;5;"WITH RankedGames AS (
    SELECT
        PUBLISHER,
        YEAR,
        NAME,
        EU_SALES,
        ROW_NUMBER() OVER (
        PARTITION BY PUBLISHER, YEAR 
        ORDER BY EU_SALES DESC
        ) AS NUM
    FROM games
) SELECT
    PUBLISHER,
    YEAR,
    NAME,
    EU_SALES,
    NUM
FROM RankedGames
WHERE NUM <= 3
ORDER BY PUBLISHER, YEAR, NUM;";20;355;57;14;10;34;23;24;57;261,34;16,1;4207,62;233,76;1;1;0;1;2;5;9,96;8,5;57;10;1,6;0,39
554;B;15;student;-1;5;"with rev as (
    SELECT genre, year,
        SUM(na_sales) AS revenue
    FROM video_game_sales
    GROUP BY genre, year
), ranked as (
    SELECT genre, year, revenue,
        RANK() OVER (
            PARTITION BY genre
            ORDER BY revenue DESC
        ) AS num
    FROM rev
) SELECT genre, year, revenue, num
FROM ranked
WHERE num <= 3
ORDER BY genre, num ASC;";16;373;73;16;12;45;28;28;73;350,94;18,67;6550,82;363,93;2;1;1;1;2;8;12,72;13,0;69;10;1,58;0,38
555;B;9;student;-1;6;"SELECT genre, year,
    SUM(na_sales) OVER (
        PARTITION BY genre
        ORDER BY year
    ) AS revenue,
    RANK() OVER (
        PARTITION BY genre
        ORDER BY year
    ) AS rank
FROM games
-- WHERE rank <= 3;
ORDER BY genre, rank;";12;245;43;13;5;33;10;18;43;179,31;13,0;2330,99;129,5;0;2;1;0;1;4;8,46;7,5;37;7;1,5;0,35
556;B;11;student;-1;6;"SELECT
    genre
    year,
    na_sales AS REVENUE,
    RANK() OVER(PARTITION BY genre ORDER BY na_sales DESC) AS rank
FROM games
QUALIFY rank <=3
ORDER BY genre, rank;";8;168;35;13;8;24;11;21;35;153,73;8,94;1373,97;76,33;0;1;0;0;1;2;6,51;3,5;34;7;1,57;0,38
557;B;14;student;-1;6;"WITH RankedSales AS (
    SELECT 
        genre,
        year,
        SUM(na_sales) AS revenue,
        RANK() OVER (
        PARTITION BY genre 
        ORDER BY SUM(na_sales) DESC
        ) AS rank
    FROM games
    GROUP BY genre, year
)
SELECT 
    genre,
    year,
    revenue,
    rank
FROM RankedSales
WHERE rank <= 3
ORDER BY genre, rank;";20;348;62;16;9;44;18;25;62;287,92;16,0;4606,71;255,93;1;1;2;1;3;7;11,55;11,5;57;11;1,56;0,37
558;B;15;student;-1;6;"CREATE OR REPLACE TABLE house_price (
    DATA VARIANT
);

CREATE OR REPLACE STAGE parquet_stage;

COPY INTO house_price
    FROM @parquet_stage/house_price.parquet
    FILE_FORMAT = (TYPE = 'parquet');";9;202;33;11;12;18;15;23;33;149,28;6,88;1026,28;57,02;0;0;0;0;1;2;5,76;1,0;7;4;1,5;0,43
559;B;9;student;-1;7;"CREATE OR REPLACE STAGE parquet_stage;

CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
    FROM @parquet_stage
    FILE_FORMAT = (TYPE = PARQUET);";9;180;29;9;11;16;13;20;29;125,34;5,32;666,56;37,03;0;0;0;0;1;2;5,24;1,0;3;3;1,0;0,33
560;B;10;student;-1;7;"CREATE OR REPLACE STAGE parquet_stage;

CREATE OR REPLACE TABLE house_price(data VARIANT);

COPY INTO house_price
  FROM @parquet_stage
  FILE_FORMAT = (TYPE = 'PARQUET');

SELECT 
    data:area::int AS area,
    data:price::int AS price
FROM house_price;";12;255;44;12;17;22;22;29;44;213,75;7,76;1659,71;92,21;0;0;0;0;1;2;7,03;1,0;3;3;1,0;0,33
561;B;11;student;-1;7;"create or replace table house_price(data variant);

CREATE STAGE parquet_stage;

COPY INTO house_price
  FROM @parquet_stage
  FILE_FORMAT = (TYPE = 'PARQUET');";7;160;27;9;11;15;12;20;27;116,69;4,91;572,85;31,83;0;0;0;0;1;1;4,69;1,0;7;4;1,5;0,43
562;B;12;student;-1;7;"CREATE OR REPLACE TABLE HOUSE (
  data VARIANT
);

CREATE OR REPLACE STAGE house_stage;

COPY INTO house
FROM @house_stage
FILE_FORMAT = (TYPE = 'PARQUET');

SELECT COUNT(*) FROM HOUSE;

SELECT * FROM HOUSE LIMIT 5;";13;215;44;13;12;28;16;25;44;204,33;8,67;1770,86;98,38;1;0;1;0;1;2;8,03;5,5;7;4;1,5;0,43
563;B;13;student;-1;7;"CREATE OR REPLace table house_price(data VARIANT);
CREATE OR REPLACE STAGE parquet_stage;
COPY into house_price
    From @parquet_stage/house_price.parquet
    File_Format = (TYPE = PARQUET);";5;191;33;11;11;18;15;22;33;147,16;7,5;1103,71;61,32;0;0;0;0;1;2;5,82;1,0;7;4;1,5;0,43
564;B;14;student;-1;7;"CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

CREATE OR REPLACE FILE FORMAT my_format2
  TYPE = 'JSON' 
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE parquet_stage;

CREATE OR REPLACE STAGE parquet_stage
  FILE_FORMAT = (TYPE = 'PARQUET');

CREATE OR REPLACE TABLE house_price
  AS
  SELECT * FROM @parquet_stage
  FILE_FORMAT = (TYPE = 'PARQUET');";17;370;60;12;15;34;26;27;60;285,29;10,4;2967,05;164,84;0;0;0;0;1;5;11,07;1,0;0;0;0,0;0,0
565;B;15;student;-1;7;"CREATE OR REPLACE TABLE house_price (
    DATA VARIANT
);

CREATE OR REPLACE STAGE parquet_stage;

COPY INTO house_price
    FROM @parquet_stage/house_price.parquet
    FILE_FORMAT = (TYPE = 'parquet');";9;202;33;11;12;18;15;23;33;149,28;6,88;1026,28;57,02;0;0;0;0;1;2;5,76;1,0;7;4;1,5;0,43
566;B;9;student;-1;8;"SELECT 
    ROUND(AVG(data:price)) AS avg_price, 
    ROUND(MEDIAN(data:price)) AS median_price
FROM house_price;";4;113;23;9;5;16;7;14;23;87,57;6,3;551,69;30,65;0;0;2;0;2;0;3,95;4,0;24;7;1,53;0,38
567;B;10;student;-1;8;"SELECT 
    round(avg(data:price::int)) AS avg_price,
    round(median(data:price::int)) AS median_price
FROM house_price;";4;122;27;9;7;16;11;16;27;108,0;7,07;763,71;42,43;0;0;2;0;2;0;4,12;4,0;28;8;1,59;0,39
568;B;11;student;-1;8;"SELECT 
    AVG(data:price) AS AVG_PRICE,
    MEDIAN(data:price) AS MEDIAN_PRICE
FROM house_price
WHERE data:price IS NOT NULL;";5;127;22;13;4;16;6;17;22;89,92;9,75;876,76;48,71;0;0;2;0;1;0;3,96;4,0;32;7;1,63;0,41
569;B;12;student;-1;8;"SELECT 
    round(AVG(data:price::int),0) AS AVERAGE,
    round(MEDIAN(data:price::int),0) as median
    
FROM house;";5;117;31;9;7;19;12;16;31;124,0;7,71;956,57;53,14;0;0;2;0;2;0;4,63;4,0;30;8;1,71;0,43
570;B;13;student;-1;8;"SELECT
    AVG(data:price::int) As AVG_price,
    MEDIAN(data:price::int) AS MEDIAN_price
From house_price;";4;107;21;9;6;12;9;15;21;82,04;6,75;553,8;30,77;0;0;2;0;1;0;3,13;4,0;26;7;1,67;0,42
571;B;14;student;-1;8;"SELECT 
  AVG(price) AS AVG_PRICE,
  MEDIAN(price) AS MEDIAN_PRICE
FROM house_price
WHERE price IS NOT NULL;";5;108;22;13;4;16;6;17;22;89,92;9,75;876,76;48,71;0;0;2;0;1;0;4,17;4,0;20;6;1,46;0,35
572;B;15;student;-1;8;"SELECT 
    ROUND(MEDIAN(data:price::int)) AS median_price,
    ROUND(AVG(data:price::int)) AS avg_price
FROM house_price
WHERE data:price::int IS NOT NULL;";5;156;34;13;7;20;14;20;34;146,95;13,0;1910,29;106,13;0;0;2;0;2;0;5,22;4,0;40;8;1,62;0,4
573;B;9;student;-1;9;"SELECT 
    data:furnishingstatus::STRING AS furnishingstatus,
    COUNT(*) AS count,
    ROUND(AVG(data:price::INT)) AS avg_price
FROM house_price
GROUP BY furnishingstatus
ORDER BY avg_price DESC;";7;198;35;13;10;22;13;23;35;158,32;8,45;1337,84;74,32;0;0;2;0;2;0;5,64;4,0;37;8;1,64;0,41
574;B;10;student;-1;9;"SELECT data:furnishingstatus::STRING, COUNT(*), round(avg(data:price::INT)) FROM house_price
GROUP BY data:furnishingstatus::STRING
ORDER BY data:furnishingstatus::STRING DESC;";3;176;33;12;8;18;15;20;33;142,62;11,25;1604,52;89,14;0;0;2;0;2;0;4,63;4,0;43;7;1,68;0,42
575;B;11;student;-1;9;"SELECT
    data:furnishingstatus,
    COUNT(*) AS COUNT,
    ROUND(AVG(data:price)) AS AVG_PRICE
FROM house_price
GROUP BY data:furnishingstatus
ORDER BY data:furnishingstatus ASC;";7;180;29;13;6;21;8;19;29;123,19;8,67;1067,65;59,31;0;0;2;0;2;0;5,0;4,0;39;7;1,65;0,41
576;B;12;student;-1;9;"SELECT 
    data:furnishingstatus::string AS FS,
    COUNT(*) AS POCET,
    Round(AVG(data:price::INT),0) AS cena
FROM HOUSE
GROUP BY FS
ORDER BY cena DESC;";7;156;37;13;12;22;15;25;37;171,82;8,12;1396,06;77,56;0;0;2;0;2;0;5,63;4,0;38;8;1,68;0,42
577;B;13;student;-1;9;"SELECT
    data:furnishingstatus::string AS furnishingstatus,
    COUNT(*) AS count,
    AVG(data:price::int)
From house_price
group by furnishingstatus
order by furnishingstatus;";7;179;29;13;7;19;10;20;29;125,34;9,29;1163,83;64,66;0;0;2;0;1;0;4,76;4,0;34;6;1,65;0,41
578;B;14;student;-1;9;"SELECT 
  furnishingstatus AS FURNISHINGSTATUS,
  COUNT(*) AS COUNT,
  AVG(price) AS AVG_PRICE
FROM house_price
WHERE price IS NOT NULL
GROUP BY furnishingstatus
ORDER BY furnishingstatus;";8;188;32;17;4;24;8;21;32;140,55;17,0;2389,42;132,75;0;0;2;0;1;0;6,09;4,0;30;6;1,53;0,37
579;B;15;student;-1;9;"SELECT 
    data:furnishingstatus::string AS furnished_status,
    COUNT(*) AS COUNT,
    ROUND(AVG(data:price::int)) AS avg_price
FROM house_price
GROUP BY data:furnishingstatus::string
ORDER BY COUNT ASC;";7;206;37;13;10;23;14;23;37;167,37;9,1;1523,08;84,62;0;0;2;0;2;0;5,77;4,0;43;8;1,68;0,42
580;B;9;student;-1;10;"SELECT 
    data:furnishingstatus::STRING AS furnishingstatus,
    ROUND(data:price::INT) AS price,
    data:area::INT AS area,
    RANK() OVER (
        PARTITION BY furnishingstatus
        ORDER BY price DESC
    ) AS rank
FROM house_price 
-- WHERE rank <= 3
ORDER BY furnishingstatus, rank;";11;295;45;12;12;27;18;24;45;206,32;9,0;1856,91;103,16;0;1;0;0;1;2;7,52;3,5;52;7;1,7;0,42
581;B;13;student;-1;10;"Select
    data:furnishingstatus::string AS furnishingstatus,
    data:price::int AS price,
    data:area::int AS area,
    RANK() OVER(
    PARTITION BY furnishingstatus
    ORDER BY price
    
    )
From house_price;";10;218;34;12;10;19;15;22;34;151,62;9,0;1364,59;75,81;0;1;0;0;1;2;5,08;3,5;42;6;1,78;0,45
582;B;15;student;-1;10;"with ranked as (
    SELECT 
        data:price::int AS PRICE, 
        data:furnishingstatus::string AS FURNISHING_STATUS,
        data:area::int AS AREA,
        RANK() OVER(
            PARTITION BY data:furnishingstatus::string
            ORDER BY data:price::int DESC
        ) AS RANK
    FROM house_price
) SELECT FURNISHING_STATUS, PRICE, AREA, RANK
FROM ranked
WHERE RANK <= 3
ORDER BY FURNISHING_STATUS, RANK;";14;420;65;14;14;37;28;28;65;312,48;14,0;4374,69;243,04;1;1;0;1;2;5;10,29;8,5;84;12;1,73;0,43
583;C;17;student;-1;1;"CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

CREATE OR REPLACE TABLE retail (
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date DATETIME,
    unit_price  FLOAT,
    customer_id INT,
    country STRING
);

  COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';

  SELECT * FROM retail";28;616;93;15;39;43;50;54;93;535,2;9,62;5146,2;285,9;0;0;0;0;1;3;15,38;1,0;24;5;2,3;0,58
584;C;18;student;-1;1;"CREATE OR REPLACE TABLE retail (
    invoice_no INT,
    stock_code STRING,
    description STRING,
    quantity INT,
    invoice_date TIMESTAMP,
    unit_price FLOAT,
    customer_id INT,
    country STRING
);


CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';";27;591;89;13;39;40;49;52;89;507,34;8,17;4143,27;230,18;0;0;0;0;1;3;14,53;1,0;28;4;2,45;0,61
585;C;19;student;-1;1;"create or replace table retail(
invoice_no int,
atock_code string,
description string,
quantity int,
invoice_date datetime,
unit_price number(10,2),
customer_id int,
country string
);

CREATE OR REPLACE FILE FORMAT my_format
TYPE = 'csv',
FIELD_DELIMITER = ';',
SKIP_HEADER = 1,
NULL_IF = ('NULL', 'null'),
EMPTY_FIELD_AS_NULL = TRUE,
TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
FILE_FORMAT = my_format;

copy into retail
from @my_stage/online_retail.csv
FILE_FORMAT = (FORMAT_NAME = my_format)
ON_ERROR = 'CONTINUE';

SELECT * FROM retail limit 5;";28;579;106;16;42;53;53;58;106;620,95;10,1;6268,6;348,26;0;0;0;0;2;3;17,31;1,0;32;6;2,21;0,56
586;C;20;student;-1;1;"use warehouse VIPER_WH;
create or replace schema test;
use schema test;

CREATE OR REPLACE file format my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE stage my_stage
  FILE_FORMAT =my_format;

create or replace table  retail (
    invoice_no int , 
    stock_code string , 
     description string , 
     quantity int , 
     invoice_date date , 
      unit_price number(10 ,2) ,
      customer_id int , 
       country string 
)

copy into retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;";30;687;107;13;46;47;60;59;107;629,44;8,48;5336,58;296,48;0;0;0;0;2;4;17,07;1,0;0;0;0,0;0,0
587;C;21;student;-1;1;"CREATE OR REPLACE TABLE retail(
invoice_no INT,
stock_code STRING,
description STRING,
quantity INT,
invoice_date DATE,
unit_price NUMBER(10,2),
customer_id INT,
country STRING
);

CREATE or replace FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER=';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE stage my_stage
  FILE_FORMAT = my_format;

COPY INTO retail
  FROM @my_stage/online_retail.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;";26;555;94;13;41;43;51;54;94;540,96;8,09;4373,85;242,99;0;0;0;0;2;3;15,14;1,0;32;6;2,21;0,56
588;C;22;student;-1;1;"CREATE OR REPLACE TABLE retail(
    invoice_no int,
    stock_code string,
    description string,
    quantity int,
    invoice_date DATETIME,
    unit_price number(10, 2),
    customer_id int,
    country string
);

CREATE OR REPLACE FILE FORMAT my_format
    TYPE = 'CSV'
  FIELD_DELIMITER = ';'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  TIMESTAMP_FORMAT = 'DD.MM.YYYY HH24:MI';

CREATE OR REPLACE STAGE my_stage
    FILE_FORMAT = my_format;

COPY INTO retail
  FROM @my_stage
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';";26;582;90;11;39;41;49;50;90;507,95;6,91;3510,04;195,0;0;0;0;0;2;3;14,55;1,0;32;6;2,21;0,56
589;C;20;student;-1;2;"SELECT *
FROM (SELECT
        country,
        stock_code,
        QUANTITY,
        AVG(QUANTITY) OVER (
            PARTITION BY country
            ORDER BY stock_code
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS QTY_AVG_LAST7D
    FROM retail
) AS subquery
WHERE QTY_AVG_LAST7D > 1;";13;307;43;21;8;31;12;29;43;208,89;15,75;3290,07;182,78;1;1;1;0;2;6;8,3;8,0;35;10;1,55;0,37
590;C;20;student;-1;3;"select stock_code , UNIT_PRICE , 
    lag(QUANTITY) over (
        partition by  country  
        order by stock_code  
    )as res1 ,  QUANTITY - lag( QUANTITY) over (
        partition by country  
        order by stock_code 
    )as PREVIOUS_PRICE 
from retail  
order by stock_code , UNIT_PRI";10;298;45;12;8;31;14;20;45;194,49;10,5;2042,11;113,45;0;2;0;0;1;4;8,04;6,0;42;8;1,46;0,33
591;C;18;student;-1;4;"SELECT country, DATE_TRUNC('MONTH', invoice_date), quantity*unit_price AS revenue,
    NTILE(4) over (
        PARTITION BY country
        order by revenue
    ) AS country_quartile
FROM retail
ORDER BY country, revenue;";7;221;39;13;10;25;14;23;39;176,42;9,1;1605,41;89,19;0;1;0;0;1;2;6,52;3,5;35;7;1,55;0,37
592;C;19;student;-1;4;"select country, invoice_date, (quantity * unit_price) as revenue, country_qrt, 
NTILE(revenue) over (partition by country order by invoice_date) as country_qrt
from retail
order by country_qrt DESC;";4;198;37;13;8;24;13;21;37;162,52;10,56;1716,57;95,37;0;1;0;0;1;2;6,36;3,5;34;7;1,5;0,35
593;C;20;student;-1;4;"WITH monthly_revenue AS (
    SELECT
        country,
        DATE_TRUNC('month', invoice_date) AS month,
        SUM(quantity * unit_price) AS revenue
    FROM
        retail
    GROUP BY
        country,
        DATE_TRUNC('month', invoice_date)
),ranked_revenue AS (
    SELECT country,
        month,
        revenue,
        NTILE(4) OVER (PARTITION BY country ORDER BY revenue) AS country_quartile
    FROM
        monthly_revenue
)
SELECT country, month,revenue, country_quartile
FROM
    ranked_revenue
ORDER BY country,month;";22;534;82;15;14;51;31;29;82;398,35;16,61;6615,53;367,53;2;1;1;1;2;8;13,87;13,0;74;10;1,59;0,38
594;C;18;student;-1;5;"WITH (
SELECT INVOICE_NO, STOCK_CODE, (quantity * unit_price) AS AMOUNT
ORDER BY AMOUNT DESC
FROM retail) AS tabulka4;

SELECT (quantity * unit_price) AS amount,
ROW_NUMBER() OVER (
    PARTITION BY invoice_no
    ORDER BY amount
) AS NUM, invoice_no, stock_code
FROM tabulka4
LIMIT 3;";12;285;56;14;11;36;20;25;56;260,06;12,73;3309,8;183,88;1;1;0;1;2;5;9,53;8,5;0;0;0,0;0,0
595;C;20;student;-1;5;"WITH RankedProducts AS (
    SELECT
        ROW_NUMBER() OVER (
            PARTITION BY invoice_no
            ORDER BY (quantity * unit_price) DESC
        ) AS num,
        invoice_no,
        stock_code,
        (quantity * unit_price) AS amount
    FROM
        retail
)SELECT num, invoice_no,  stock_code,
    ROUND(amount::numeric, 2) AS amount
FROM RankedProducts
WHERE num <= 3
ORDER BY invoice_no,num;";16;411;68;15;15;41;27;30;68;333,67;13,5;4504,53;250,25;1;1;0;1;3;7;11,63;8,5;68;12;1,56;0,37
596;C;18;student;-1;6;"SELECT
ROW_NUMBER() OVER (
    PARTITION BY invoice_no
    ORDER BY unit_price DESC
) AS RANKK, invoice_no, stock_code, unit_price
FROM retail
ORDER BY invoice_no, RANKK, stock_code;";7;182;32;12;6;21;11;18;32;133,44;11,0;1467,81;81,55;0;1;0;0;1;2;5,56;3,5;30;7;1,53;0,37
597;C;19;student;-1;6;"select rank, invoice_no, stock_code, unit_price,
RANK() over (partition by invoice_no order by unit_price) as rank
from retail
order by rank;";4;141;29;12;4;23;6;16;29;116,0;9,0;1044,0;58,0;0;1;0;0;1;2;5,48;3,5;26;7;1,56;0,38
598;C;20;student;-1;6;"WITH RankedProducts AS (
    SELECT INVOICE_NO,  STOCK_CODE,  UNIT_PRICE,
        ROW_NUMBER() OVER (
            PARTITION BY INVOICE_NO
            ORDER BY UNIT_PRICE DESC
        ) AS RANK
    FROM retail
)
SELECT
    RANK,     INVOICE_NO,     STOCK_CODE,  UNIT_PRICE
FROM
    RankedProducts
WHERE RANK <= 5
ORDER BY INVOICE_NO, RANK, STOCK_CODE;";14;350;51;15;8;35;16;23;51;230,7;15,0;3460,52;192,25;1;1;0;1;2;5;9,59;8,5;51;10;1,56;0,37
599;C;17;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = json_format;

CREATE OR REPLACE TABLE cities_pop(data VARIANT);

COPY INTO cities_pop
  FROM @json_stage/json_format
  FILE_FORMAT = json_format;";12;283;43;11;15;21;22;26;43;202,12;8,07;1630,43;90,58;0;0;0;0;1;3;7,54;1,0;10;4;1,8;0,5
600;C;18;student;-1;7;"CREATE TABLE cities_pop (data VARIANT);

CREATE OR REPLACE file format json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = true;

CREATE OR REPLACE stage json_stage
  FILE_FORMAT = json_format;

COPY INTO cities_pop
  FROM @json_stage/cities_population.json
  FILE_FORMAT = (FORMAT_NAME = json_format);

SELECT * FROM cities_pop
LIMIT 10;";15;336;54;15;19;29;25;34;54;274,72;9,87;2711,08;150,62;0;0;0;0;1;2;9,52;1,0;7;4;1,5;0,43
601;C;19;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
TYPE = 'json'
STRIP_OUTER_ARRAY = true;

CREATE OR REPLACE STAGE json_stage
FILE_FORMAT = json_format;

create or replace table cities_pop (data variant);

copy into cities_pop
from @json_stage
file_format = json_format;";12;262;41;10;15;20;21;25;41;190,4;7,0;1332,79;74,04;0;0;0;0;1;3;7,21;1,0;10;4;1,8;0,5
602;C;20;student;-1;7;"CREATE OR REPLACE FILE FORMAT json_format
TYPE = 'json'
STRIP_OUTER_ARRAY = true;

CREATE OR REPLACE STAGE json_stage
FILE_FORMAT = json_format;

create or replace table cities_pop (data variant);

copy into cities_pop
from @json_stage
file_format = json_format;";12;262;41;10;15;20;21;25;41;190,4;7,0;1332,79;74,04;0;0;0;0;1;3;7,21;1,0;10;4;1,8;0,5
603;C;21;student;-1;7;"CREATE OR REPLACE TABLE cities_pop(data VARIANT);

CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE STAGE json_stage
  FILE_FORMAT = json_format;


COPY INTO cities_pop
  FROM @json_stage/cities_population.json
  FILE_FORMAT = (FORMAT_NAME = json_format);";13;311;49;12;18;25;24;30;49;240,44;8,0;1923,5;106,86;0;0;0;0;1;3;8,7;1,0;7;4;1,5;0,43
604;C;22;student;-1;7;"CREATE OR REPLACE TABLE cities_pop(
    data variant
);

CREATE OR REPLACE FILE FORMAT json_format
  TYPE = 'JSON'
  STRIP_OUTER_ARRAY = TRUE;

CREATE OR REPLACE stage json_stage
  FILE_FORMAT = json_format;

COPY INTO cities_pop
  FROM @json_stage
  FILE_FORMAT = json_format;";14;277;41;10;15;20;21;25;41;190,4;7,0;1332,79;74,04;0;0;0;0;1;3;7,24;1,0;7;4;1,5;0,43
605;C;17;student;-1;8;"SELECT 
data:city::STRING as CITY,
data:country::STRING as COUNTRY,
data:population:by_year::STRING as POP2025
FROM cities_pop
WHERE data:city::STRING LIKE '%San%' OR data:city::STRING LIKE'%san%'
ORDER BY POP2025 DESC;";7;219;37;10;12;14;23;22;37;165,0;9,58;1581,24;87,85;0;0;0;0;0;1;4,69;1,0;61;8;1,82;0,46
606;C;18;student;-1;8;"SELECT 
    data:city::STRING AS CITY,
    data:country::STRING AS COUNTRY,
    data:""2025_population""::STRING AS POP2025
FROM cities_pop
WHERE city ILIKE '%san%';";6;163;26;7;11;10;16;18;26;108,42;5,09;551,95;30,66;0;0;0;0;0;0;3,24;1,0;39;6;1,81;0,46
607;C;19;student;-1;8;"select 
data:city::string as city,
data:country::string as country,
data:""2025_population""::float as pop2025
from cities_pop WHERE city ILIKE '%san%';";5;150;26;7;12;10;16;19;26;110,45;4,67;515,42;28,63;0;0;0;0;0;0;3,21;1,0;39;6;1,81;0,46
608;C;20;student;-1;8;"select 
    data:city::string as CITY ,
    data:country::string as COUNTRY,  
    data:2025_poulation::int as POPULATION_2025, 
from cities_pop  
where  data:city::string ILIKE ""%San%"";";6;186;28;7;11;11;17;18;28;116,76;5,41;631,55;35,09;0;0;0;0;0;0;3,48;1,0;0;0;0,0;0,0
609;C;18;student;-1;10;"SELECT 
    data:city::STRING AS CITY,
    AVG(f.value:population::INT) AS AVERAGE
FROM cities_pop,
    lateral flatten (input => TO_ARRAY(data:population:districts)) f
GROUP BY CITY
order by AVERAGE desc;";7;205;40;14;15;21;19;29;40;194,32;8,87;1722,96;95,72;0;0;1;0;2;0;6,15;2,5;54;9;1,89;0,48
610;D;23;student;-1;1;"CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'csv'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

CREATE OR REPLACE TABLE games (
    id int,
    name string,
    platform string,
    year int,
    genre string,
    publisher string,
    na_sales float,
    eu_sales float,
    jp_sales float,
    other_sales float,
    global_sales float
);

COPY INTO games
  FROM @my_stage
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';";28;563;91;11;37;40;51;48;91;508,23;7,58;3852,94;214,05;0;0;0;0;1;3;14,57;1,0;21;5;2,22;0,57
611;D;24;student;-1;1;"CREATE OR replace FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;


CREATE OR REPLACE stage my_stage
FILE_FORMAT = my_format;

create table games(
    id  int,
    name  text,
    platform  text,
    year int,
    genre text,
    publisher text,
    na_sales float,
    eu_sales float,
    jp_sales  float,
    other_sales  float,
    global_sales  float
);

copy into games
from @my_stage/video_game_sales.csv
FILE_FORMAT = my_format
on_error ='CONTINUE'";29;545;88;13;38;37;51;51;88;499,17;8,72;4354,63;241,92;0;0;0;0;1;2;13,63;1,0;21;5;2,22;0,57
612;D;25;student;-1;1;"CREATE OR REPLACE TABLE games
(
id int,
name string,
platform string,
year int,
genre string,
publisher string,
na_sales NUMBER(10,4),
eu_sales NUMBER(10,4),
jp_sales NUMBER(10,4),
other_sales NUMBER(10,4),
global_sales NUMBER(10,4)
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'csv'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';
SELECT * FROM games LIMIT 10;";30;605;127;16;41;62;65;57;127;740,78;12,68;9395,22;521,96;0;0;0;0;2;3;19,41;1,0;57;6;1,93;0,49
613;D;26;student;-1;1;"CREATE OR REPLACE FILE FORMAT my_format 
TYPE = 'CSV'
FIELD_DELIMITER = ','
SKIP_HEADER = 1
NULL_IF = ('NULL', 'null')
EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
FILE_FORMAT = my_format;

CREATE OR REPLACE TABLE games (
    id INT AUTOINCREMENT PRIMARY KEY,
    name STRING,
    platform STRING,
    year STRING,
    genre STRING,
    publisher STRING,
    na_sales NUMBER(10, 2),
    eu_sales NUMBER(10, 2),
    jp_sales NUMBER(10, 2),
    other_sales NUMBER(10, 2),
    global_sales NUMBER(10, 2)
);

COPY INTO games 
FROM @my_stage/video_game_sales.csv
ON_ERROR = 'CONTINUE';";27;597;116;13;43;53;63;56;116;673,65;9,52;6415,37;356,41;0;0;0;0;2;3;17,09;1,0;21;5;2,22;0,57
614;D;27;student;-1;1;"CREATE OR REPLACE TABLE games (
    id INT,
    name STRING,
    platform STRING,
    year INT,
    genre STRING,
    publisher STRING,
    na_sales NUMBER(10,2),
    eu_sales NUMBER(10,2),
    jp_sales NUMBER(10,2),
    other_sales NUMBER(10,2),
    global_sales NUMBER(10,2)
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';";28;619;120;13;41;57;63;54;120;690,59;9,99;6897,44;383,19;0;0;0;0;2;3;18,24;1,0;57;6;1,93;0,49
615;D;28;student;-1;1;"CREATE OR REPLACE TABLE games(
id int,
name text,
platform text,
year number(4,0),
genre text,
publisher text,
na_sales number(12,2),
eu_sales number(12,2),
jp_sales number(12,2),
other_sales number(12,2),
global_sales number(12,2)
);
describe table games;

CREATE OR REPLACE file format my_format
  TYPE = 'csv'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE stage my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
ON_ERROR = 'CONTINUE';

SELECT * FROM GAMES LIMIT 10;";31;625;136;16;45;67;69;61;136;806,58;12,27;9894,05;549,67;0;0;0;0;2;3;20,61;1,0;61;6;1,88;0,48
616;D;29;student;-1;1;"CREATE OR REPLACE TABLE games (
    id INT PRIMARY KEY AUTOINCREMENT,
    name string,
    platform string,
    year int,
    genre string,
    publisher string,
    na_sales number(10,2),
    eu_sales number(10,2),
    jp_sales number(10,2),
    other_sales number(10,2),
    global_sales number(10,2)
);

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE stage my_stage
  FILE_FORMAT = my_format;

COPY INTO games
  FROM @my_stage
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = 'CONTINUE';

SELECT * FROM games;";30;646;124;13;42;59;65;55;124;716,89;10,06;7211,56;400,64;0;0;0;0;2;3;18,97;1,0;61;6;1,94;0,49
617;D;30;student;-1;1;"use warehouse termite_wh;
use database termite_db;
CREATE SCHEMA if not exists zapocet;
use schema zapocet;

CREATE OR REPLACE FILE FORMAT my_format
  TYPE = 'CSV'
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_stage
  FILE_FORMAT = my_format;

  create or replace table games (
 id INT AUTOINCREMENT PRIMARY KEY,
 name string,
 platform string,
 year int,
 genre string,
 publisher string,
 na_sales number(10,2),
eu_sales number(10,2),
jp_sales number(10,2),
other_sales number(10,2),
global_sales number(10,2)
  ); 

  describe table games;

COPY INTO games
  FROM @my_stage/video_game_sales.csv
  FILE_FORMAT = (FORMAT_NAME = my_format)
  ON_ERROR = CONTINUE;

  Select * from games;";37;769;151;18;52;71;80;70;151;925,52;13,85;12814,92;711,94;0;0;0;0;2;3;23,2;1,0;4;3;1,5;0,5
618;D;24;student;-1;2;"select distinct genre,year, avg(na_sales) over (partition by genre, year order by year
) as YEAR_SALES 
from games

order by genre, year";5;136;30;12;5;20;10;17;30;122,62;12,0;1471,49;81,75;0;1;1;0;1;2;5,19;5,0;30;7;1,53;0,37
619;D;25;student;-1;2;"SELECT genre, year,
ROUND(AVG(na_sales) OVER (PARTITION BY genre ORDER BY year),2) AS YEAR_SALES,
ROUND(AVG(na_sales) OVER (PARTITION BY genre ORDER BY year
RANGE BETWEEN INTERVAL '60 MONTH' PRECEDING AND CURRENT ROW),2) AS AVG_LAST_5Y_SALES
FROM games
order by year;";6;267;60;18;10;42;18;28;60;288,44;16,2;4672,75;259,6;0;2;2;0;2;5;10,55;9,0;44;8;1,54;0,36
620;D;26;student;-1;2;"SELECT genre, year, YEAR_SALES,
ROUND(AVG(YEAR_SALES) OVER (
    PARTITION BY genre
    ORDER BY year
    ROWS BETWEEN 5 PRECEDING AND CURRENT ROW
), 2) AS AVG_LAST_5Y_SALES
FROM (SELECT genre, year,
ROUND(SUM(na_sales), 2) AS YEAR_SALES
FROM GAMES
GROUP BY genre, year)
ORDER BY genre, year;";11;292;66;20;9;45;21;29;66;320,63;23,33;7481,29;415,63;1;1;2;0;3;8;11,56;9,5;52;9;1,55;0,37
621;D;27;student;-1;2;"  SELECT genre, year, 
   AVG(na_sales) OVER (
    PARTITION BY year, genre
    ORDER BY year  
    ) AS YEAR_SALES, 
   AVG(na_sales) OVER (
    PARTITION BY year, genre
    ORDER BY year
    RANGE BETWEEN INTERVAL '5 YEAR' PRECEDING AND CURRENT ROW //tento riadok by fungoval, keby si v tabulke nastavim ten year na DATE namiesto INT :D
   ) AS AVG_LAST_5Y_SALES
  FROM games;";11;378;70;19;22;40;30;41;70;375,03;12,95;4858,33;269,91;0;2;2;0;1;5;11,42;9,0;40;7;1,56;0,38
622;D;30;student;-1;2;"with year_na_sales as(
  Select genre, year, SUM(na_sales) as yr_na_sales from games
  group by genre, year
  order by genre, year
  ) SELECT genre, year, yr_na_sales, avg(yr_na_sales) OVER (
  PARTITION BY genre
  order BY year
  rows between 5 PRECEDING AND CURRENT ROW
  ) as last_5_year_sales
  from year_na_sales
  order by genre, year;";11;341;65;20;9;43;22;29;65;315,77;24,44;7718,79;428,82;1;1;2;1;2;6;11,5;11,5;60;8;1,51;0,35
623;D;23;student;-1;3;"SELECT publisher, name, year, LAG(year) OVER (PARTITION BY publisher ORDER BY publisher ASC) prev_year, (prev_year - year)
FROM games
GROUP BY publisher, name, year
ORDER BY publisher ASC;";4;188;42;13;6;26;16;19;42;178,41;17,33;3092,49;171,81;0;1;0;0;1;2;6,98;3,5;39;7;1,52;0,36
624;D;24;student;-1;3;"select PUBLISHER, name, year, lag(year) over (order by publisher,year, name) as prev_year, year - lag(year) over (order by publisher, year, name ) as year_gap
from games
order by publisher, year, name";3;200;51;11;6;33;18;17;51;208,46;16,5;3439,6;191,09;0;2;0;0;1;4;8,56;6,0;55;8;1,46;0,33
625;D;25;student;-1;3;"SELECT publisher, name, year, 
LAG(year) OVER(PARTITION BY publisher ORDER BY year,name) AS PREV_YEAR,
year-LAG(year) OVER(PARTITION BY publisher ORDER BY year) AS YEAR_GAP
FROM games
ORDER BY publisher, year, name;";5;215;52;13;6;35;17;19;52;220,89;18,42;4068,1;226,01;0;2;0;0;1;4;8,91;6,0;50;8;1,48;0,34
626;D;26;student;-1;3;"SELECT publisher, name, year,
LAG(year) OVER (
    PARTITION BY publisher
    ORDER BY year, name
) AS PREV_YEAR,
year - LAG(year) OVER (
    PARTITION BY publisher
    ORDER BY year, name
) AS YEAR_GAP
FROM games
ORDER BY publisher, name, year;";11;245;54;13;6;36;18;19;54;229,39;19,5;4473,07;248,5;0;2;0;0;1;4;9,25;6,0;53;8;1,49;0,34
627;D;27;student;-1;3;"  SELECT publisher, name, year,
    LAG(year) OVER (
        PARTITION BY publisher
        ORDER BY year
    ) AS PREV_YEAR, 
    year - LAG(year) OVER (
        PARTITION BY publisher
        ORDER BY year
    ) AS PREV_YEAR
    FROM games
    ORDER BY publisher, year;";11;271;48;13;5;33;15;18;48;200,16;19,5;3903,05;216,84;0;2;0;0;1;4;8,46;6,0;44;8;1,48;0,34
628;D;28;student;-1;3;"SELECT
    PUBLISHER,
    NAME,
    YEAR,
    LAG(year) over (partition by year order by name) as PREV_YEAR,//fix it
    (YEAR - PREV_YEAR) as YEAR_GAP
FROM GAMES
ORDER BY PUBLISHER, YEAR;";8;188;42;14;8;27;15;22;42;187,3;13,12;2458,26;136,57;0;1;0;0;1;2;7,1;3,5;37;7;1,5;0,35
629;D;29;student;-1;3;"SELECT publisher,
       name,
       year,
       LAG(year) OVER(
       PARTITION BY publisher ORDER BY year
       ) AS PREV_YEAR,
       year - LAG(year) OVER(
       PARTITION BY publisher ORDER BY year
       ) AS YEAR_GAP
FROM games
ORDER BY publisher, name, year;";11;271;50;13;6;34;16;19;50;212,4;17,33;3681,54;204,53;0;2;0;0;1;4;8,74;6,0;47;8;1,48;0,34
630;D;30;student;-1;3;"with prev as (
  SELECT publisher, name, year, LAG(year) OVER (
  PARTITION by publisher
  order by year
  ) as prev_year,
  from games
  order by publisher, year, prev_year, name
  ) select publisher, name, year, year-prev_year as year_gap from prev;";8;251;54;13;8;33;21;21;54;237,19;17,06;4046,97;224,83;1;1;0;1;2;5;9,02;8,5;56;10;1,53;0,36
631;D;24;student;-1;4;"select publisher, name, global_sales, dense_rank() over(order by global_sales desc) as quartile_sales
from games";2;112;21;10;6;14;7;16;21;84,0;5,83;490,0;27,22;0;1;0;0;1;2;3,7;3,5;18;7;1,55;0,39
632;D;25;student;-1;4;"SELECT publisher, name, global_sales,
NTILE(4) OVER(ORDER BY global_sales DESC) AS QUARTILE_SALES
FROM games;";3;109;23;11;7;15;8;18;23;95,91;6,29;602,85;33,49;0;1;0;0;1;2;3,9;3,5;19;7;1,5;0,37
633;D;26;student;-1;4;"SELECT publisher, name, global_sales,
NTILE(4) OVER (
PARTITION BY publisher
ORDER BY global_sales DESC
) AS QUARTILE_SALES
FROM games
ORDER BY global_sales DESC;";7;162;30;12;7;19;11;19;30;127,44;9,43;1201,56;66,75;0;1;0;0;1;2;5,04;3,5;25;7;1,5;0,36
634;D;27;student;-1;4;"SELECT publisher, name, global_sales,
        NTILE(4) OVER (
            PARTITION BY publisher
            ORDER BY global_sales DESC
        ) AS QUARTILE_SALES
    FROM games
    ORDER BY global_sales DESC;";7;210;30;12;7;19;11;19;30;127,44;9,43;1201,56;66,75;0;1;0;0;1;2;5,14;3,5;25;7;1,5;0,36
635;D;30;student;-1;4;"  SELECT publisher, name, global_sales, NTILE(4) OVER (
  PARTITION BY publisher
  order by global_sales DESC
  ) from games
  order by global_sales DESC;";5;154;28;11;6;18;10;17;28;114,45;9,17;1049,12;58,28;0;1;0;0;1;2;4,75;3,5;23;6;1,47;0,35
636;D;24;student;-1;5;"select * from(
select genre, year, name, global_sales, rank() over(partition by genre, year order by genre)
from games
order by genre, year)
";5;141;35;11;5;25;10;16;35;140,0;11,0;1540,0;85,56;1;1;0;0;2;5;6,32;6,5;33;9;1,52;0,36
637;D;25;student;-1;5;"SELECT genre,year, name, global_sales,
ROW_NUMBER() OVER(PARTITION BY year ORDER BY global_sales DESC) AS NUM
FROM games
ORDER BY genre, year, num;";4;147;34;12;7;22;12;19;34;144,43;10,29;1485,56;82,53;0;1;0;0;1;2;5,77;3,5;32;7;1,55;0,38
638;D;26;student;-1;5;"SELECT * FROM (SELECT genre, year, name, global_sales,
ROW_NUMBER() OVER (
    PARTITION BY genre, year
    ORDER BY year ASC, global_sales DESC
) AS NUM
FROM games
order by genre, year, NUM)
WHERE NUM <= 3;";8;207;48;15;9;31;17;24;48;220,08;14,17;3117,77;173,21;1;1;0;0;2;5;8,58;6,5;46;10;1,55;0,37
639;D;27;student;-1;5;"    SELECT genre, year, name, global_sales,
        DENSE_RANK() OVER (
            PARTITION BY genre
            ORDER BY global_sales DESC
        ) AS NUM
    FROM games
    ORDER BY genre, year, NUM;";7;204;34;12;7;22;12;19;34;144,43;10,29;1485,56;82,53;0;1;0;0;1;2;5,89;3,5;32;7;1,55;0,38
640;D;29;student;-1;5;"SELECT genre, year, name, global_sales,
DENSE_RANK() OVER(PARTITION BY genre ORDER BY global_sales DESC) AS Num
FROM games
ORDER BY genre, year, Num;";4;149;34;12;7;22;12;19;34;144,43;10,29;1485,56;82,53;0;1;0;0;1;2;5,78;3,5;32;7;1,55;0,38
641;D;30;student;-1;5;"SELECT genre, year, name, global_sales, RANK() OVER (
  PARTITION BY genre, year
  order by global_sales DESC
  ) as num from games
  order by genre, year, num;";5;160;36;12;7;23;13;19;36;152,93;11,14;1704,03;94,67;0;1;0;0;1;2;6,08;3,5;34;7;1,57;0,38
642;D;23;student;-1;6;"SELECT year, name, global_sales, RANK() OVER (PARTITION BY year ORDER BY global_sales DESC) RANK
FROM games
GROUP BY year, name, global_sales
ORDER BY year, RANK ASC
LIMIT 5;";5;174;39;13;7;26;13;20;39;168,56;12,07;2034,7;113,04;0;1;0;0;1;2;6,63;3,5;36;7;1,59;0,39
643;D;24;student;-1;6;"select year, name, global_sales, rank from (
select year, name, global_sales, rank() over(partition by year order by global_sales desc) as rank
from games
order by year, global_sales desc)
where rank <6";5;202;45;13;6;31;14;19;45;191,16;15,17;2899,21;161,07;1;1;0;0;2;5;8,03;6,5;43;10;1,56;0,37
644;D;25;student;-1;6;"SELECT year, name, global_sales,
RANK() OVER(PARTITION BY year ORDER BY global_sales DESC) AS RANK
FROM games

ORDER BY year;";5;125;28;12;5;20;8;17;28;114,45;9,6;1098,71;61,04;0;1;0;0;1;2;5,01;3,5;24;7;1,53;0,38
645;D;26;student;-1;6;"SELECT * FROM (SELECT year, name, global_sales,
RANK() OVER (
    PARTITION BY year
    ORDER BY year ASC, global_sales DESC
) AS RANK
FROM games
order by year, RANK)
WHERE RANK <= 5;";8;183;42;15;7;31;11;22;42;187,3;11,79;2207,42;122,63;1;1;0;0;2;5;8,06;6,5;39;10;1,52;0,36
646;D;27;student;-1;6;"  SELECT year, name, global_sales,
        DENSE_RANK() OVER (
            PARTITION BY year
            ORDER BY global_sales DESC
        ) AS RANK
    FROM games
    ORDER BY year, RANK;";7;189;30;13;5;22;8;18;30;125,1;10,4;1301,02;72,28;0;1;0;0;1;2;5,54;3,5;27;7;1,53;0,37
647;D;29;student;-1;6;"SELECT year, name, global_sales,
RANK() OVER(PARTITION BY year ORDER BY global_sales DESC) AS RANK
FROM games
ORDER BY year;";4;124;28;12;5;20;8;17;28;114,45;9,6;1098,71;61,04;0;1;0;0;1;2;5,01;3,5;24;7;1,53;0,38
648;D;30;student;-1;6;"with top5 as (
  SELECT year, name, global_sales, RANK() OVER (
  PARTITION BY year
  order by global_sales DESC
  ) as rank from games
  ) select * from top5 where rank <=5 order by year, rank;";6;194;43;15;8;31;12;23;43;194,51;11,25;2188,27;121,57;1;1;0;1;2;5;8,16;8,5;41;10;1,54;0,37
649;D;23;student;-1;7;"CREATE FILE FORMAT parquet_stage;

CREATE TABLE house_price (data VARIANT);

COPY INTO house_price
  FROM @my_stage/house_price.parquet
  FILE_FORMAT = (TYPE = 'PARQUET');";7;171;30;10;12;16;14;22;30;133,78;5,83;780,4;43,36;0;0;0;0;1;0;4,92;1,0;3;3;1,0;0,33
650;D;24;student;-1;7;"CREATE FILE FORMAT parquet_stage;

CREATE TABLE house_price (data VARIANT);

COPY INTO house_price
  FROM @my_stage/house_price.parquet
  FILE_FORMAT = (TYPE = 'PARQUET');";7;171;30;10;12;16;14;22;30;133,78;5,83;780,4;43,36;0;0;0;0;1;0;4,92;1,0;3;3;1,0;0,33
651;D;25;student;-1;7;"CREATE OR REPLACE TABLE house_price
(data VARIANT);

CREATE OR REPLACE STAGE parquet_stage;

COPY INTO house_price
  FROM @parquet_stage/house_price.parquet
  FILE_FORMAT = (TYPE = 'PARQUET');";8;192;33;11;12;18;15;23;33;149,28;6,88;1026,28;57,02;0;0;0;0;1;2;5,74;1,0;7;4;1,5;0,43
652;D;26;student;-1;7;"CREATE OR REPLACE FILE FORMAT my_format2 
TYPE = 'PARQUET';

CREATE OR REPLACE STAGE parquet_stage
FILE_FORMAT = my_format2;

CREATE TABLE house_price (
    data VARIANT
);

COPY INTO house_price
  FROM @parquet_stage/
  FILE_FORMAT = (TYPE = 'PARQUET');";13;254;41;10;14;21;20;24;41;187,98;7,14;1342,74;74,6;0;0;0;0;1;2;7,09;1,0;7;4;1,5;0,43
653;D;27;student;-1;7;"CREATE OR REPLACE TABLE house_price(data VARIANT);

CREATE OR REPLACE STAGE parquet_stage;

COPY INTO house_price
  FROM @parquet_stage/house_price.parquet
  FILE_FORMAT = (TYPE = PARQUET);

    ";9;195;33;11;11;18;15;22;33;147,16;7,5;1103,71;61,32;0;0;0;0;1;2;5,83;1,0;7;4;1,5;0,43
654;D;29;student;-1;7;"CREATE OR REPLACE TABLE house_price (
    data VARIANT
);

CREATE OR REPLACE stage parquet_stage;

COPY INTO house_price
  FROM @parquet_stage
  FILE_FORMAT = (TYPE = parquet);

SELECT * FROM house_price;";11;204;34;11;11;20;14;22;34;151,62;7,0;1061,34;58,96;0;0;0;0;1;2;6,29;1,0;7;4;1,5;0,43
655;D;30;student;-1;7;"CREATE OR REPLACE STAGE parquet_stage;

COPY INTO house_price
FROM @parquet_stage/house_prices.parquet
FILE_FORMAT = (TYPE = 'PARQUET');";5;136;23;10;11;12;11;21;23;101,02;5,0;505,12;28,06;0;0;0;0;1;1;3,96;1,0;3;3;1,0;0,33
656;D;23;student;-1;8;"SELECT COUNT(*) TOTAL, (SELECT COUNT(*) FROM house_price WHERE data:airconditioning::string = 'yes') WITH_AC, ROUND(DIV0(WITH_AC, TOTAL) * 100, 2) PERCENT_WITH_AC
FROM house_price;";2;180;41;10;12;26;15;22;41;182,84;6,25;1142,73;63,48;1;0;2;0;2;3;6,75;7,0;51;10;1,67;0,41
657;D;25;student;-1;8;"SELECT 
COUNT(*) As TOTAL,
(SELECT COUNT(data:airconditioning::string) as AIRCON  FROM house_price WHERE data:airconditioning ILIKE 'yes') AS WITH_AC,
ROUND((WITH_AC/TOTAL)*100,2) as PERCENT_WITH_AC
FROM house_price;";5;216;45;12;12;29;16;24;45;206,32;8,0;1650,59;91,7;1;0;2;0;2;3;7,42;7,0;47;10;1,64;0,4
658;D;26;student;-1;8;"SELECT COUNT(*) AS TOTAL,
(SELECT COUNT(*) FROM house_price WHERE data:airconditioning = 'yes') AS WITH_AC,
ROUND(WITH_AC / TOTAL * 100, 2) AS PERCENT_WITH_AC
FROM house_price;";4;176;39;12;9;27;12;21;39;171,3;8,0;1370,4;76,13;1;0;2;0;2;3;6,78;7,0;37;9;1,64;0,41
659;D;29;student;-1;8;"SELECT COUNT(*) AS TOTAL, (SELECT COUNT(data:airconditioning::string) FROM house_price WHERE data:airconditioning = 'yes') AS WITH_AC, ROUND(WITH_AC / TOTAL * 100, 2) AS PERCENT_WITH_AC
FROM house_price;";2;203;41;12;11;26;15;23;41;185,47;8,18;1517,45;84,3;1;0;2;0;2;3;6,72;7,0;44;9;1,65;0,41
660;D;23;student;-1;9;"SELECT data:bedrooms::int BEDROOMS, COUNT(*) COUNT, ROUND(AVG(data:price::int)) AVG_PRICE,
FROM house_price
GROUP BY BEDROOMS
ORDER BY BEDROOMS ASC;";4;148;33;12;9;20;13;21;33;144,95;8,67;1256,2;69,79;0;0;2;0;2;0;5,14;4,0;37;8;1,64;0,41
661;D;25;student;-1;9;"SELECT
data:bedrooms::int AS BEDROOMS,
COUNT(*) AS COUNT,
ROUND(AVG(data:price::int)) AS AVG_PRICE
FROM house_price 
GROUP BY BEDROOMS;";6;135;31;12;8;20;11;20;31;133,98;8,25;1105,33;61,41;0;0;2;0;2;0;4,95;4,0;33;8;1,68;0,42
662;D;26;student;-1;9;"SELECT
data:bedrooms AS BEDROOMS,
COUNT(*) AS COUNT,
ROUND(AVG(data:price)) AS AVG_PRICE
FROM house_price
GROUP BY BEDROOMS
order by BEDROOMS;";7;142;30;13;6;22;8;19;30;127,44;8,67;1104,46;61,36;0;0;2;0;2;0;5,28;4,0;33;7;1,6;0,39
663;D;27;student;-1;9;"SELECT 
    data:bedrooms AS bedrooms, COUNT(*), ROUND(AVG(data:price), 0)
FROM house_price
GROUP BY bedrooms
ORDER BY bedrooms;";5;128;28;13;6;20;8;19;28;118,94;8,67;1030,83;57,27;0;0;2;0;2;0;4,78;4,0;30;6;1,61;0,4
664;D;29;student;-1;9;"SELECT DISTINCT data:bedrooms AS bedrooms, COUNT(data:bedrooms) AS COUNT, ROUND(AVG(data:price)) AS AVG_PRICE
FROM house_price
GROUP BY bedrooms
ORDER BY bedrooms;";4;163;31;13;6;22;9;19;31;131,69;9,75;1283,94;71,33;0;0;2;0;2;0;5,33;4,0;39;7;1,65;0,41
665;D;23;student;-1;10;"SELECT data:stories::int STORIES, ROUND(AVG(data:price::int)) AVG_PRICE, RANK() OVER (ORDER BY AVG_PRICE DESC) RANK
FROM house_price
GROUP BY STORIES
ORDER BY AVG_PRICE DESC;";4;174;38;12;9;23;15;21;38;166,91;10,0;1669,08;92,73;0;1;1;0;2;2;5,95;5,0;41;8;1,6;0,39
666;D;25;student;-1;10;"SELECT
data:stories::int AS STORIES,
ROUND(AVG(data:price::int)) AS AVG_PRICE,
RANK() OVER(ORDER BY AVG_PRICE DESC) AS RANK
FROM house_price 
GROUP BY STORIES
;";7;160;37;13;9;24;13;22;37;165,0;9,39;1549,16;86,06;0;1;1;0;2;2;5,96;5,0;37;8;1,64;0,41
667;D;26;student;-1;10;"SELECT STORIES, AVG_PRICE,
ROW_NUMBER() OVER (
    ORDER BY AVG_PRICE DESC
) FROM
(SELECT
data:stories AS STORIES,
ROUND(AVG(data:price)) AS AVG_PRICE,
FROM house_price
GROUP BY STORIES
ORDER BY AVG_PRICE DESC);";10;211;43;13;7;30;13;20;43;185,84;12,07;2243,39;124,63;1;1;1;0;3;7;7,54;8,0;42;10;1,52;0,36
668;D;27;student;-1;10;"SELECT data:stories AS stories, ROUND(AVG(data:price), 0) AS AVG_price,
RANK() over (
    order by AVG_price DESC
) AS RANK
FROM house_price GROUP BY stories ORDER BY stories DESC;";5;180;39;13;8;27;12;21;39;171,3;9,75;1670,18;92,79;0;1;1;0;2;2;6,6;5,0;38;7;1,61;0,39
669;D;29;student;-1;10;"SELECT data:stories AS stories, ROUND(AVG(data:price)) as avg_price,
RANK() OVER(ORDER BY data:stories DESC) as rank
FROM house_price
GROUP BY data:stories
ORDER BY avg_price DESC;";5;180;37;13;7;26;11;20;37;159,91;10,21;1633,38;90,74;0;1;1;0;2;2;6,24;5,0;45;8;1,63;0,4
